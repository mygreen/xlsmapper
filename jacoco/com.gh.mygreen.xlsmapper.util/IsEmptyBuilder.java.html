<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ja"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>IsEmptyBuilder.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">XlsMapper</a> &gt; <a href="index.source.html" class="el_package">com.gh.mygreen.xlsmapper.util</a> &gt; <span class="el_source">IsEmptyBuilder.java</span></div><h1>IsEmptyBuilder.java</h1><pre class="source lang-java linenums">package com.gh.mygreen.xlsmapper.util;

import java.lang.reflect.AccessibleObject;
import java.lang.reflect.Field;
import java.lang.reflect.Modifier;
import java.util.Arrays;
import java.util.Collection;
import java.util.Map;
import java.util.concurrent.atomic.AtomicBoolean;


/**
 * 値が全て空かどかチェックするためのクラス。
 * &lt;p&gt;アノテーション{@link com.gh.mygreen.xlsmapper.annotation.XlsIgnorable}を付与したメソッドの実装に利用します。&lt;/p&gt;
 *
 * &lt;p&gt;リフレクションを利用して判定する場合は、位置情報のフィールドpositions、ラベル情報のフィールドlabelsを除外します。&lt;/p&gt;
 * &lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;java&quot;&gt;
 * // リフレクションを使用する場合
 * {@literal @XlsIgnoable}
 * public boolean isEmpty() {
 *     return IsEmptyBuilder.reflectionIsEmpty(this, &quot;positions&quot;, &quot;labels&quot;);
 * }
 * &lt;/code&gt;&lt;/pre&gt;
 *
 * &lt;p&gt;フィールドを1つずつ判定する場合は、{@code append(...)}メソッドを利用します。&lt;/p&gt;
 * メソッド{@link #compare(IsEmptyComparator)}を利用することで、独自の実装も可能で、その際にLambda式を利用することもできます。
 *
 * &lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;java&quot;&gt;
 * // 独自に組み立てる場合
 * {@literal @XlsIgnoable}
 * public boolean isEmpty() {
 *     return new IsEmptyBuilder()
 *         .append(name)
 *         .append(age)
 *         .compare(() {@literal -&gt;} StringUtils.isBlank(address))
 *         .isEmpty();
 * }
 * &lt;/code&gt;&lt;/pre&gt;
 *
 * &lt;p&gt;オプションを指定して処理する場合、{@link IsEmptyConfig}を利用します。
 * &lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;java&quot;&gt;
 * // オプションを指定する場合
 * {@literal @XlsIgnoable}
 * public boolean isEmpty() {
 *     return IsEmptyBuilder.reflectionIsEmpty(this
 *         , IsEmptyConfig.create().withTestArrayElement(false).withTestCollectionElement(false)
 *         , &quot;positions&quot;, &quot;labels&quot;);
 * }
 * &lt;/code&gt;&lt;/pre&gt;
 *
 *
 * @since 0.5
 * @author T.TSUCHIE
 *
 */
public class IsEmptyBuilder {

    /**
     * 現在までの判定結果を保持する。
     * true: 値が空かどうか。
     */
    private final AtomicBoolean result;

    /**
     * 数値の場合、0を空として扱うか。
     */
    private boolean zeroAsEmpty;

    /**
     * 配列の場合、値も検証対象とするかどうか。
     */
    private boolean testArrayElement;

    /**
     * Collectionの場合、値も検証対象とするかどうか。
     */
    private boolean testCollectionElement;

    /**
     * Mapの場合、値も対象とするかどうか。
     */
    private boolean testMapValue;

    /**
     * transientが付与されたフィールドも対象とするかどうか。
     */
    private boolean testTransient;

    /**
     * コンストラクタ。
     */
    public IsEmptyBuilder() {
<span class="fc" id="L93">        this(IsEmptyConfig.create());</span>

<span class="fc" id="L95">    }</span>

    /**
     * {@link IsEmptyConfig}を指定するコンストラクタ。
     * @param config 設定用クラス。
     * @throws IllegalArgumentException config is null.
     */
<span class="fc" id="L102">    public IsEmptyBuilder(final IsEmptyConfig config) {</span>
<span class="fc" id="L103">        ArgUtils.notNull(config, &quot;config&quot;);</span>

<span class="fc" id="L105">        this.result = new AtomicBoolean(true);</span>

<span class="fc" id="L107">        this.zeroAsEmpty = config.isZeroAsEmpty();</span>
<span class="fc" id="L108">        this.testArrayElement = config.isTestArrayElement();</span>
<span class="fc" id="L109">        this.testCollectionElement = config.isTestCollectionElement();</span>
<span class="fc" id="L110">        this.testMapValue = config.isTestMapValue();</span>
<span class="fc" id="L111">        this.testTransient = config.isTestTransient();</span>
<span class="fc" id="L112">    }</span>

    /**
     * リフレクションを使用しフィールドの値を取得し判定する。
     * &lt;p&gt;static修飾子を付与しているフィールドは、除外されます。
     * &lt;p&gt;transient修飾子を付与しているフィールドは、除外されます。
     * @param obj 判定対象のオブジェクト。
     * @param excludedFields 除外対処のフィールド名。
     * @return 引数で指定したobjがnullの場合、trueを返す。
     */
    public static boolean reflectionIsEmpty(final Object obj, final String... excludedFields) {
<span class="fc" id="L123">        return reflectionIsEmpty(obj, IsEmptyConfig.create(), Arrays.asList(excludedFields));</span>
    }

    /**
     * リフレクションを使用しフィールドの値を取得し判定する。
     * @since 1.0
     * @param obj 判定対象のオブジェクト。
     * @param config 判定用の設定クラス。
     * @param excludedFields 除外対処のフィールド名。
     * @return 引数で指定したobjがnullの場合、trueを返す。
     */
    public static boolean reflectionIsEmpty(final Object obj, final IsEmptyConfig config, final String... excludedFields) {
<span class="fc" id="L135">        return reflectionIsEmpty(obj, config, Arrays.asList(excludedFields));</span>
    }

    /**
     * リフレクションを使用しフィールドの値を取得し判定する。
     * @since 1.0
     * @param obj 判定対象のオブジェクト。
     * @param config 判定用の設定クラス。
     * @param excludedFields 除外対処のフィールド名。
     * @return 引数で指定したobjがnullの場合、trueを返す。
     */
    public static boolean reflectionIsEmpty(final Object obj, final IsEmptyConfig config, final Collection&lt;String&gt; excludedFields) {

<span class="fc bfc" id="L148" title="All 2 branches covered.">        if(obj == null) {</span>
<span class="fc" id="L149">            return true;</span>
        }

<span class="fc" id="L152">        final IsEmptyBuilder builder = new IsEmptyBuilder(config);</span>
<span class="fc" id="L153">        final Field[] fields = obj.getClass().getDeclaredFields();</span>
<span class="fc" id="L154">        AccessibleObject.setAccessible(fields, true);</span>

<span class="fc bfc" id="L156" title="All 2 branches covered.">        for(Field field : fields) {</span>

            // static フィールドかどうか
<span class="fc bfc" id="L159" title="All 2 branches covered.">            if(Modifier.isStatic(field.getModifiers())) {</span>
<span class="fc" id="L160">                continue;</span>
            }

            // transientのフィールドかどうか。
<span class="fc bfc" id="L164" title="All 4 branches covered.">            if(!builder.testTransient &amp;&amp; Modifier.isTransient(field.getModifiers())) {</span>
<span class="fc" id="L165">                continue;</span>
            }

            // 除外対象のフィールド名かどうか。
<span class="pc bpc" id="L169" title="1 of 4 branches missed.">            if(excludedFields != null &amp;&amp; excludedFields.contains(field.getName())) {</span>
<span class="fc" id="L170">                continue;</span>
            }

            try {
<span class="fc" id="L174">                final Object value = field.get(obj);</span>
<span class="fc" id="L175">                builder.append(value);</span>

<span class="nc" id="L177">            } catch (IllegalArgumentException | IllegalAccessException e) {</span>
<span class="nc" id="L178">                throw new InternalError(&quot;Unexpected IllegalAccessException&quot;);</span>
<span class="fc" id="L179">            }</span>

        }

<span class="fc" id="L183">        return builder.isEmpty();</span>
    }

    /**
     * 値が空でないことを設定する。
     */
    private void setNotEmpty() {
<span class="fc" id="L190">        this.result.set(false);</span>
<span class="fc" id="L191">    }</span>

    /**
     * String型の値を追加する。
     * @param value nullまたは空文字の場合、空と判断する。
     * @return this.
     */
    public IsEmptyBuilder append(final String value) {
<span class="fc" id="L199">        return append(value, false);</span>
    }

    /**
     * String型の値を追加する。
     * @param value nullまたは空文字の場合、空と判断する。
     * @param trim 引数valueをトリムした後空文字と判定するかどうか。
     * @return this.
     */
    public IsEmptyBuilder append(final String value, final boolean trim) {
<span class="pc bpc" id="L209" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L210">            return this;</span>
        }

<span class="fc bfc" id="L213" title="All 2 branches covered.">        if(trim) {</span>
<span class="pc bpc" id="L214" title="1 of 4 branches missed.">            if(value != null &amp;&amp; !value.trim().isEmpty()) {</span>
<span class="fc" id="L215">                setNotEmpty();</span>
            }
        } else {
<span class="fc bfc" id="L218" title="All 4 branches covered.">            if(value != null &amp;&amp; !value.isEmpty()) {</span>
<span class="fc" id="L219">                setNotEmpty();</span>
            }
        }

<span class="fc" id="L223">        return this;</span>
    }

    /**
     * char型の値を追加する。
     * @param value 空文字の場合、空と判断する。
     * @return this
     */
    public IsEmptyBuilder append(final char value) {
<span class="pc bpc" id="L232" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L233">            return this;</span>
        }

<span class="fc bfc" id="L236" title="All 2 branches covered.">        final String str = (value == '\u0000' ? &quot;&quot; : String.valueOf(value));</span>
<span class="fc" id="L237">        return append(str);</span>
    }

    /**
     * char型の値を追加する。
     * @param value 空文字の場合、空と判断する。
     * @param trim 引数valueをトリムした後空文字と判定するかどうか。
     * @return this
     */
    public IsEmptyBuilder append(final char value, final boolean trim) {
<span class="pc bpc" id="L247" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L248">            return this;</span>
        }

<span class="pc bpc" id="L251" title="1 of 2 branches missed.">        final String str = (value == '\u0000' ? &quot;&quot; : String.valueOf(value));</span>
<span class="fc" id="L252">        return append(str, trim);</span>
    }

    /**
     * boolean型の値を追加する。
     * @param value false場合、空と判断する。
     * @return this.
     */
    public IsEmptyBuilder append(final boolean value) {
<span class="pc bpc" id="L261" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L262">            return this;</span>
        }

<span class="fc bfc" id="L265" title="All 2 branches covered.">        if(value) {</span>
<span class="fc" id="L266">            setNotEmpty();</span>
        }

<span class="fc" id="L269">        return this;</span>
    }

    /**
     * byte型の値を追加する。
     * @param value {@link #isZeroAsEmpty()}がtrueの場合、0の値を空として扱う。
     * @return this
     */
    public IsEmptyBuilder append(final byte value) {
<span class="pc bpc" id="L278" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L279">            return this;</span>
        }

<span class="fc bfc" id="L282" title="All 4 branches covered.">        if(!(isZeroAsEmpty() &amp;&amp; value == 0)) {</span>
<span class="fc" id="L283">            setNotEmpty();</span>
        }

<span class="fc" id="L286">        return this;</span>
    }

    /**
     * short型の値を追加する。
     * @param value {@link #isZeroAsEmpty()}がtrueの場合、0の値を空として扱う。
     * @return this
     */
    public IsEmptyBuilder append(final short value) {
<span class="pc bpc" id="L295" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L296">            return this;</span>
        }

<span class="fc bfc" id="L299" title="All 4 branches covered.">        if(!(isZeroAsEmpty() &amp;&amp; value == 0)) {</span>
<span class="fc" id="L300">            setNotEmpty();</span>
        }

<span class="fc" id="L303">        return this;</span>
    }

    /**
     * int型の値を追加する。
     * @param value {@link #isZeroAsEmpty()}がtrueの場合、0の値を空として扱う。
     * @return this
     */
    public IsEmptyBuilder append(final int value) {
<span class="pc bpc" id="L312" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L313">            return this;</span>
        }

<span class="fc bfc" id="L316" title="All 4 branches covered.">        if(!(isZeroAsEmpty() &amp;&amp; value == 0)) {</span>
<span class="fc" id="L317">            setNotEmpty();</span>
        }

<span class="fc" id="L320">        return this;</span>
    }

    /**
     * long型の値を追加する。
     * @param value {@link #isZeroAsEmpty()}がtrueの場合、0の値を空として扱う。
     * @return this
     */
    public IsEmptyBuilder append(final long value) {
<span class="pc bpc" id="L329" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L330">            return this;</span>
        }

<span class="fc bfc" id="L333" title="All 4 branches covered.">        if(!(isZeroAsEmpty() &amp;&amp; value == 0L)) {</span>
<span class="fc" id="L334">            setNotEmpty();</span>
        }

<span class="fc" id="L337">        return this;</span>
    }

    /**
     * float型の値を追加する。
     * @param value {@link #isZeroAsEmpty()}がtrueの場合、0.0の値を空として扱う。
     * @return this
     */
    public IsEmptyBuilder append(final float value) {
<span class="pc bpc" id="L346" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L347">            return this;</span>
        }

<span class="fc bfc" id="L350" title="All 4 branches covered.">        if(!(isZeroAsEmpty() &amp;&amp; value == 0.0)) {</span>
<span class="fc" id="L351">            setNotEmpty();</span>
        }

<span class="fc" id="L354">        return this;</span>
    }

    /**
     * double型の値を追加する。
     * @param value {@link #isZeroAsEmpty()}がtrueの場合、0の値を空として扱う。
     * @return this
     */
    public IsEmptyBuilder append(final double value) {
<span class="pc bpc" id="L363" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L364">            return this;</span>
        }

<span class="fc bfc" id="L367" title="All 4 branches covered.">        if(!(isZeroAsEmpty() &amp;&amp; value == 0.0)) {</span>
<span class="fc" id="L368">            setNotEmpty();</span>
        }

<span class="fc" id="L371">        return this;</span>
    }

    /**
     * Object型の値を追加する。
     * @param value nullの場合、空と判断する。
     * @return this
     */
    public IsEmptyBuilder append(final Object value) {
<span class="fc bfc" id="L380" title="All 2 branches covered.">        if(isNotEmpty()) {</span>
<span class="fc" id="L381">            return this;</span>
        }

<span class="fc bfc" id="L384" title="All 2 branches covered.">        if(value == null) {</span>
<span class="fc" id="L385">            return this;</span>
        }

<span class="fc" id="L388">        final Class&lt;?&gt; clazz = value.getClass();</span>
<span class="pc bpc" id="L389" title="1 of 2 branches missed.">        if(clazz.isPrimitive()) {</span>
<span class="nc bnc" id="L390" title="All 2 branches missed.">            if(clazz.equals(Boolean.TYPE)) {</span>
<span class="nc" id="L391">                return append((boolean) value);</span>
<span class="nc bnc" id="L392" title="All 2 branches missed.">            } else if(clazz.equals(Byte.TYPE)) {</span>
<span class="nc" id="L393">                return append((byte) value);</span>
<span class="nc bnc" id="L394" title="All 2 branches missed.">            } else if(clazz.equals(Character.TYPE)) {</span>
<span class="nc" id="L395">                return append((char) value);</span>
<span class="nc bnc" id="L396" title="All 2 branches missed.">            } else if(clazz.equals(Short.TYPE)) {</span>
<span class="nc" id="L397">                return append((short) value);</span>
<span class="nc bnc" id="L398" title="All 2 branches missed.">            } else if(clazz.equals(Integer.TYPE)) {</span>
<span class="nc" id="L399">                return append((int) value);</span>
<span class="nc bnc" id="L400" title="All 2 branches missed.">            } else if(clazz.equals(Long.TYPE)) {</span>
<span class="nc" id="L401">                return append((long) value);</span>
<span class="nc bnc" id="L402" title="All 2 branches missed.">            } else if(clazz.equals(Float.TYPE)) {</span>
<span class="nc" id="L403">                return append((float) value);</span>
<span class="nc bnc" id="L404" title="All 2 branches missed.">            } else if(clazz.equals(Double.TYPE)) {</span>
<span class="nc" id="L405">                return append((double) value);</span>
            }

<span class="fc bfc" id="L408" title="All 2 branches covered.">        } else if(clazz.isArray()) {</span>
<span class="fc bfc" id="L409" title="All 2 branches covered.">            if(value instanceof boolean[]) {</span>
<span class="fc" id="L410">                return append((boolean[]) value);</span>
<span class="fc bfc" id="L411" title="All 2 branches covered.">            } else if(value instanceof char[]) {</span>
<span class="fc" id="L412">                return append((char[]) value);</span>
<span class="fc bfc" id="L413" title="All 2 branches covered.">            } else if(value instanceof byte[]) {</span>
<span class="fc" id="L414">                return append((byte[]) value);</span>
<span class="fc bfc" id="L415" title="All 2 branches covered.">            } else if(value instanceof short[]) {</span>
<span class="fc" id="L416">                return append((short[]) value);</span>
<span class="fc bfc" id="L417" title="All 2 branches covered.">            } else if(value instanceof int[]) {</span>
<span class="fc" id="L418">                return append((int[]) value);</span>
<span class="fc bfc" id="L419" title="All 2 branches covered.">            } else if(value instanceof long[]) {</span>
<span class="fc" id="L420">                return append((long[]) value);</span>
<span class="fc bfc" id="L421" title="All 2 branches covered.">            } else if(value instanceof float[]) {</span>
<span class="fc" id="L422">                return append((float[]) value);</span>
<span class="fc bfc" id="L423" title="All 2 branches covered.">            } else if(value instanceof double[]) {</span>
<span class="fc" id="L424">                return append((double[]) value);</span>
            } else {
<span class="fc" id="L426">                return append((Object[]) value);</span>
            }

<span class="fc bfc" id="L429" title="All 2 branches covered.">        } else if(value instanceof String) {</span>
<span class="fc" id="L430">            return append((String) value);</span>

<span class="fc bfc" id="L432" title="All 2 branches covered.">        } else if(value instanceof Boolean) {</span>
<span class="fc" id="L433">            return append((boolean) value);</span>

<span class="fc bfc" id="L435" title="All 2 branches covered.">        } else if(value instanceof Byte) {</span>
<span class="fc" id="L436">            return append((byte) value);</span>

<span class="fc bfc" id="L438" title="All 2 branches covered.">        } else if(value instanceof Character) {</span>
<span class="fc" id="L439">            return append((char) value);</span>

<span class="fc bfc" id="L441" title="All 2 branches covered.">        } else if(value instanceof Short) {</span>
<span class="fc" id="L442">            return append((short) value);</span>

<span class="fc bfc" id="L444" title="All 2 branches covered.">        } else if(value instanceof Integer) {</span>
<span class="fc" id="L445">            return append((int) value);</span>

<span class="fc bfc" id="L447" title="All 2 branches covered.">        } else if(value instanceof Long) {</span>
<span class="fc" id="L448">            return append((long) value);</span>

<span class="fc bfc" id="L450" title="All 2 branches covered.">        } else if(value instanceof Float) {</span>
<span class="fc" id="L451">            return append((float) value);</span>

<span class="fc bfc" id="L453" title="All 2 branches covered.">        } else if(value instanceof Double) {</span>
<span class="fc" id="L454">            return append((double) value);</span>

<span class="fc bfc" id="L456" title="All 2 branches covered.">        } else if(value instanceof Collection) {</span>
<span class="fc" id="L457">            return append((Collection&lt;?&gt;) value);</span>

<span class="fc bfc" id="L459" title="All 2 branches covered.">        } else if(value instanceof Map) {</span>
<span class="fc" id="L460">            return append((Map&lt;?, ?&gt;) value);</span>

        } else {
<span class="fc" id="L463">            setNotEmpty();</span>
        }

<span class="fc" id="L466">        return this;</span>
    }

    /**
     * 配列型の値を追加する。
     * @param value nullの場合、サイズが0の場合、空と判断する。
     * @return this
     */
    public IsEmptyBuilder append(final Object[] value) {
<span class="pc bpc" id="L475" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L476">            return this;</span>
        }

<span class="fc bfc" id="L479" title="All 4 branches covered.">        if(value != null &amp;&amp; isTestArrayElement()) {</span>
<span class="fc bfc" id="L480" title="All 2 branches covered.">            for(Object o : value) {</span>
<span class="pc bpc" id="L481" title="1 of 2 branches missed.">                if(isNotEmpty()) {</span>
<span class="nc" id="L482">                    return this;</span>
                }

<span class="fc" id="L485">                append(o);</span>
            }

<span class="pc bpc" id="L488" title="1 of 4 branches missed.">        } else if(value != null &amp;&amp; value.length != 0) {</span>
<span class="fc" id="L489">            setNotEmpty();</span>
        }

<span class="fc" id="L492">        return this;</span>

    }

    /**
     * booleanの配列型の値を追加する。
     * @param value nullの場合、サイズが0の場合、空と判断する。
     * @return this
     */
    public IsEmptyBuilder append(final boolean[] value) {
<span class="pc bpc" id="L502" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L503">            return this;</span>
        }

<span class="fc bfc" id="L506" title="All 4 branches covered.">        if(value != null &amp;&amp; isTestArrayElement()) {</span>
<span class="fc bfc" id="L507" title="All 2 branches covered.">            for(boolean o : value) {</span>
<span class="pc bpc" id="L508" title="1 of 2 branches missed.">                if(isNotEmpty()) {</span>
<span class="nc" id="L509">                    return this;</span>
                }

<span class="fc" id="L512">                append(o);</span>
            }

<span class="pc bpc" id="L515" title="1 of 4 branches missed.">        } else if(value != null &amp;&amp; value.length != 0) {</span>
<span class="fc" id="L516">            setNotEmpty();</span>
        }

<span class="fc" id="L519">        return this;</span>
    }

    /**
     * charの配列型の値を追加する。
     * @param value nullの場合、サイズが0の場合、空と判断する。
     * @return this
     */
    public IsEmptyBuilder append(final char[] value) {
<span class="pc bpc" id="L528" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L529">            return this;</span>
        }

<span class="fc bfc" id="L532" title="All 4 branches covered.">        if(value != null &amp;&amp; isTestArrayElement()) {</span>
<span class="fc bfc" id="L533" title="All 2 branches covered.">            for(char o : value) {</span>
<span class="pc bpc" id="L534" title="1 of 2 branches missed.">                if(isNotEmpty()) {</span>
<span class="nc" id="L535">                    return this;</span>
                }

<span class="fc" id="L538">                append(o);</span>
            }

<span class="pc bpc" id="L541" title="1 of 4 branches missed.">        } else if(value != null &amp;&amp; value.length != 0) {</span>
<span class="fc" id="L542">            setNotEmpty();</span>
        }

<span class="fc" id="L545">        return this;</span>
    }

    /**
     * byteの配列型の値を追加する。
     * @param value nullの場合、サイズが0の場合、空と判断する。
     * @return this
     */
    public IsEmptyBuilder append(final byte[] value) {
<span class="pc bpc" id="L554" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L555">            return this;</span>
        }

<span class="fc bfc" id="L558" title="All 4 branches covered.">        if(value != null &amp;&amp; isTestArrayElement()) {</span>
<span class="fc bfc" id="L559" title="All 2 branches covered.">            for(byte o : value) {</span>
<span class="pc bpc" id="L560" title="1 of 2 branches missed.">                if(isNotEmpty()) {</span>
<span class="nc" id="L561">                    return this;</span>
                }

<span class="fc" id="L564">                append(o);</span>
            }

<span class="pc bpc" id="L567" title="1 of 4 branches missed.">        } else if(value != null &amp;&amp; value.length != 0) {</span>
<span class="fc" id="L568">            setNotEmpty();</span>
        }

<span class="fc" id="L571">        return this;</span>
    }

    /**
     * shortの配列型の値を追加する。
     * @param value nullの場合、サイズが0の場合、空と判断する。
     * @return this
     */
    public IsEmptyBuilder append(final short[] value) {
<span class="pc bpc" id="L580" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L581">            return this;</span>
        }

<span class="fc bfc" id="L584" title="All 4 branches covered.">        if(value != null &amp;&amp; isTestArrayElement()) {</span>
<span class="fc bfc" id="L585" title="All 2 branches covered.">            for(short o : value) {</span>
<span class="pc bpc" id="L586" title="1 of 2 branches missed.">                if(isNotEmpty()) {</span>
<span class="nc" id="L587">                    return this;</span>
                }

<span class="fc" id="L590">                append(o);</span>
            }

<span class="pc bpc" id="L593" title="1 of 4 branches missed.">        } else if(value != null &amp;&amp; value.length != 0) {</span>
<span class="fc" id="L594">            setNotEmpty();</span>
        }

<span class="fc" id="L597">        return this;</span>
    }

    /**
     * intの配列型の値を追加する。
     * @param value nullの場合、サイズが0の場合、空と判断する。
     * @return this
     */
    public IsEmptyBuilder append(final int[] value) {
<span class="pc bpc" id="L606" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L607">            return this;</span>
        }

<span class="fc bfc" id="L610" title="All 4 branches covered.">        if(value != null &amp;&amp; isTestArrayElement()) {</span>
<span class="fc bfc" id="L611" title="All 2 branches covered.">            for(int o : value) {</span>
<span class="pc bpc" id="L612" title="1 of 2 branches missed.">                if(isNotEmpty()) {</span>
<span class="nc" id="L613">                    return this;</span>
                }

<span class="fc" id="L616">                append(o);</span>
            }

<span class="pc bpc" id="L619" title="1 of 4 branches missed.">        } else if(value != null &amp;&amp; value.length != 0) {</span>
<span class="fc" id="L620">            setNotEmpty();</span>
        }

<span class="fc" id="L623">        return this;</span>
    }

    /**
     * longの配列型の値を追加する。
     * @param value nullの場合、サイズが0の場合、空と判断する。
     * @return this
     */
    public IsEmptyBuilder append(final long[] value) {
<span class="pc bpc" id="L632" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L633">            return this;</span>
        }

<span class="pc bpc" id="L636" title="1 of 4 branches missed.">        if(value != null &amp;&amp; isTestArrayElement()) {</span>
<span class="fc bfc" id="L637" title="All 2 branches covered.">            for(long o : value) {</span>
<span class="pc bpc" id="L638" title="1 of 2 branches missed.">                if(isNotEmpty()) {</span>
<span class="nc" id="L639">                    return this;</span>
                }

<span class="fc" id="L642">                append(o);</span>
            }

<span class="pc bpc" id="L645" title="3 of 4 branches missed.">        } else if(value != null &amp;&amp; value.length != 0) {</span>
<span class="nc" id="L646">            setNotEmpty();</span>
        }

<span class="fc" id="L649">        return this;</span>
    }

    /**
     * floatの配列型の値を追加する。
     * @param value nullの場合、サイズが0の場合、空と判断する。
     * @return this
     */
    public IsEmptyBuilder append(final float[] value) {
<span class="pc bpc" id="L658" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L659">            return this;</span>
        }

<span class="fc bfc" id="L662" title="All 4 branches covered.">        if(value != null &amp;&amp; isTestArrayElement()) {</span>
<span class="fc bfc" id="L663" title="All 2 branches covered.">            for(float o : value) {</span>
<span class="pc bpc" id="L664" title="1 of 2 branches missed.">                if(isNotEmpty()) {</span>
<span class="nc" id="L665">                    return this;</span>
                }

<span class="fc" id="L668">                append(o);</span>
            }

<span class="pc bpc" id="L671" title="1 of 4 branches missed.">        } else if(value != null &amp;&amp; value.length != 0) {</span>
<span class="fc" id="L672">            setNotEmpty();</span>
        }

<span class="fc" id="L675">        return this;</span>
    }

    /**
     * doubleの配列型の値を追加する。
     * @param value nullの場合、サイズが0の場合、空と判断する。
     * @return this
     */
    public IsEmptyBuilder append(final double[] value) {
<span class="pc bpc" id="L684" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L685">            return this;</span>
        }

<span class="fc bfc" id="L688" title="All 4 branches covered.">        if(value != null &amp;&amp; isTestArrayElement()) {</span>
<span class="fc bfc" id="L689" title="All 2 branches covered.">            for(double o : value) {</span>
<span class="pc bpc" id="L690" title="1 of 2 branches missed.">                if(isNotEmpty()) {</span>
<span class="nc" id="L691">                    return this;</span>
                }

<span class="fc" id="L694">                append(o);</span>
            }

<span class="pc bpc" id="L697" title="1 of 4 branches missed.">        } else if(value != null &amp;&amp; value.length != 0) {</span>
<span class="fc" id="L698">            setNotEmpty();</span>
        }

<span class="fc" id="L701">        return this;</span>
    }

    /**
     * Collection型の値を追加する。
     * @param value nullの場合、サイズが0の場合、空と判断する。
     * @return this
     */
    public IsEmptyBuilder append(final Collection&lt;?&gt; value) {
<span class="pc bpc" id="L710" title="1 of 2 branches missed.">        if(isNotEmpty()) {</span>
<span class="nc" id="L711">            return this;</span>
        }

<span class="fc bfc" id="L714" title="All 4 branches covered.">        if(value != null &amp;&amp; isTestCollectionElement()) {</span>
            // コレクションの値も検証する。
<span class="fc bfc" id="L716" title="All 2 branches covered.">            for(Object o : value) {</span>
<span class="fc bfc" id="L717" title="All 2 branches covered.">                if(isNotEmpty()) {</span>
<span class="fc" id="L718">                    return this;</span>
                }

<span class="fc" id="L721">                append(o);</span>
<span class="fc" id="L722">            }</span>

<span class="pc bpc" id="L724" title="1 of 4 branches missed.">        } else if(value != null &amp;&amp; !value.isEmpty()) {</span>
<span class="fc" id="L725">            setNotEmpty();</span>
        }

<span class="fc" id="L728">        return this;</span>

    }

    /**
     * Map型の値を追加する。
     * @param value nullの場合、サイズが0の場合、空と判断する。
     * @return this
     */
    public IsEmptyBuilder append(final Map&lt;?, ?&gt; value) {
<span class="fc bfc" id="L738" title="All 2 branches covered.">        if(isNotEmpty()) {</span>
<span class="fc" id="L739">            return this;</span>
        }

<span class="fc bfc" id="L742" title="All 4 branches covered.">        if(value != null &amp;&amp; isTestMapValue()) {</span>
            // コレクションの値も検証する。
<span class="fc bfc" id="L744" title="All 2 branches covered.">            for(Object o : value.values()) {</span>
<span class="fc bfc" id="L745" title="All 2 branches covered.">                if(isNotEmpty()) {</span>
<span class="fc" id="L746">                    return this;</span>
                }

<span class="fc" id="L749">                append(o);</span>
<span class="fc" id="L750">            }</span>

<span class="pc bpc" id="L752" title="1 of 4 branches missed.">        } else if(value != null &amp;&amp; !value.isEmpty()) {</span>
<span class="fc" id="L753">            setNotEmpty();</span>

        }

<span class="fc" id="L757">        return this;</span>

    }

    /**
     * 独自の実装で値を空かどうか判定する。
     * &lt;p&gt;Java8のLambda式を利用すると簡潔に書ける。
     * &lt;pre class=&quot;highlight&quot;&gt;&lt;code class=&quot;java&quot;&gt;
     * public boolean isEmpty() {
     *      return new IsEmptyBuilder()
     *          .append(age)
     *          .compare(() {@literal -&gt;} StringUtils.isBlank(address))
     *          .isEmpty();
     *  }
     * &lt;/code&gt;&lt;/pre&gt;
     *
     * @param compare {@link IsEmptyComparator}のインスタンス。
     * @return this.
     */
    public &lt;T&gt; IsEmptyBuilder compare(final IsEmptyComparator compare) {
<span class="fc bfc" id="L777" title="All 2 branches covered.">        if(isNotEmpty()) {</span>
<span class="fc" id="L778">            return this;</span>
        }

<span class="fc bfc" id="L781" title="All 2 branches covered.">        if(!compare.isEmpty()) {</span>
<span class="fc" id="L782">            setNotEmpty();</span>
        }

<span class="fc" id="L785">        return this;</span>
    }

    /**
     * 判定結果が空かどうか。
     * &lt;p&gt;{@code append(XXXX)}メソッドで何も追加されない場合、trueを返します。
     * @return true:値が空。
     */
    public boolean isEmpty() {
<span class="fc" id="L794">        return result.get();</span>
    }

    /**
     * 判定結果がが空でないかどうか。
     * @return true:値が空でない。
     */
    public boolean isNotEmpty() {
<span class="fc bfc" id="L802" title="All 2 branches covered.">        return !isEmpty();</span>
    }

    /**
     * 数値の0を空として扱うかどうか。
     * @return true:0を空として扱う。
     */
    private boolean isZeroAsEmpty() {
<span class="fc" id="L810">        return zeroAsEmpty;</span>
    }

    /**
     * Collectionの値も検証するかどうか。
     * @return true:Collectionの値も検証する。
     */
    private boolean isTestArrayElement() {
<span class="fc" id="L818">        return testArrayElement;</span>
    }

    /**
     * Collectionの値も検証するかどうか。
     * @return true:Collectionの値も検証する。
     */
    private boolean isTestCollectionElement() {
<span class="fc" id="L826">        return testCollectionElement;</span>
    }

    /**
     * Mapの値も検証するかどうか。
     * @return true:Mapの値も検証する。
     */
    private boolean isTestMapValue() {
<span class="fc" id="L834">        return testMapValue;</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>