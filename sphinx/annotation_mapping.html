

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ja" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ja" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3. 表・セルのマッピング方法 &mdash; XlsMapper 2.0 ドキュメント</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/mycustom.css" type="text/css" />
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="next" title="4. セルの書式の指定方法" href="annotation_converter.html" />
    <link rel="prev" title="2. 注意事項" href="attention.html" />
 
<!-- my theme custom extrahead beacon -->

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> XlsMapper
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
<p class="caption"><span class="caption-text">関連リンク</span></p>
<ul>
	<li class="toctree-l1"><a class="reference internal" href="../project-info.html">プロジェクト情報</a></li>
	<li class="toctree-l1"><a class="reference internal" href="../apidocs/index.html">JavaDoc</a></li>
	<li class="toctree-l1"><a class="reference internal" href="../project-reports.html">プロジェクトレポート</a></li>
	<li class="toctree-l1"><a class="reference internal" href="https://github.com/mygreen/xlsmapper">GitHub</a></li>
</ul>


            
            
              
            
            
              <p class="caption"><span class="caption-text">目次</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="howtouse.html">1. 基本的な使い方</a><ul>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#id2">1.1. ダウンロード</a></li>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#dependencyenv">1.2. 前提条件</a></li>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#howtousesheetload">1.3. マッピングの基本</a><ul>
<li class="toctree-l3"><a class="reference internal" href="howtouse.html#id5">1.3.1. 読み込み方の基本</a></li>
<li class="toctree-l3"><a class="reference internal" href="howtouse.html#id6">1.3.2. 書き込み方の基本</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#id7">1.4. 読み込み方</a><ul>
<li class="toctree-l3"><a class="reference internal" href="howtouse.html#id8">1.4.1. 単一のシートを読み込む場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="howtouse.html#id9">1.4.2. 複数のシートを読み込む場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#howtousesheetsave">1.5. 書き込み方</a><ul>
<li class="toctree-l3"><a class="reference internal" href="howtouse.html#id11">1.5.1. 単一のシートの書き込む場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="howtouse.html#id12">1.5.2. 複数のシートを書き込む場合</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="attention.html">2. 注意事項</a><ul>
<li class="toctree-l2"><a class="reference internal" href="attention.html#exceljava">2.1. ExcelとJava間で数値をマッピングする際の注意事項</a></li>
<li class="toctree-l2"><a class="reference internal" href="attention.html#id2">2.2. アノテーションの定義位置</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. 表・セルのマッピング方法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#xlssheet">3.1. <code class="docutils literal notranslate"><span class="pre">&#64;XlsSheet</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">3.1.1. シート名を正規表現で指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlssheetname">3.2. <code class="docutils literal notranslate"><span class="pre">&#64;XlsSheetName</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">3.2.1. メソッドにアノテーションを付与する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlscell">3.3. <code class="docutils literal notranslate"><span class="pre">&#64;XlsCell</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#xlslabelledcell">3.4. <code class="docutils literal notranslate"><span class="pre">&#64;XlsLabelledCell</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#range">3.4.1. ラベルセルから離れたセルを指定する方法（属性range）</a></li>
<li class="toctree-l3"><a class="reference internal" href="#skip">3.4.2. ラベルセルから離れたセルを指定する方法（属性skip）</a></li>
<li class="toctree-l3"><a class="reference internal" href="#labelmerged">3.4.3. ラベルセルが結合している場合（属性labelMerged）</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">3.4.4. ラベルセルが重複するセルを指定する方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">3.4.5. ラベルセルを正規表現、正規化して指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlsarraycells">3.5. <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayCells</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id6">3.5.1. 縦方向に隣接したセルをマッピングする場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">3.5.2. 結合したセルをマッピングする場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">3.5.3. 書き込み時に配列・リストのサイズが不足、または余分である場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">3.5.4. 位置情報／見出し情報を取得する際の注意事項</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlslabelledarraycells">3.6. <code class="docutils literal notranslate"><span class="pre">&#64;XlsLabelledArrayCells</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id10">3.6.1. 縦方向に隣接したセルをマッピングする場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">3.6.2. ラベルセルから離れたセルを指定する方法（属性range）</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">3.6.3. ラベルセルから離れたセルを指定する方法（属性skip）</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id13">3.6.4. 重複するラベルを指定する場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">3.6.5. ラベルセルが結合している場合（属性labelMerged）</a></li>
<li class="toctree-l3"><a class="reference internal" href="#elementmerged">3.6.6. 結合したセルをマッピングする場合（属性elementMerged）</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id15">3.6.7. 書き込み時に配列・リストのサイズが不足、または余分である場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">3.6.8. 位置情報／見出し情報を取得する際の注意事項</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id17">3.6.9. ラベルセルを正規表現、正規化して指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlshorizontalrecords">3.7. <code class="docutils literal notranslate"><span class="pre">&#64;XlsHorizontalRecords</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id18">3.7.1. 表の開始位置の指定（表の名称がない場合）</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id19">3.7.2. 表の名称から開始位置が離れた場所にある場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id20">3.7.3. 表の見出しが縦に結合されデータレコードの開始位置が離れた場所にある場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#terminal">3.7.4. 表の終端の指定（属性terminal）</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id21">3.7.5. 空のレコードを読み飛ばす条件の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="#terminatelabel">3.7.6. 表の終端の指定（属性terminateLabel）</a></li>
<li class="toctree-l3"><a class="reference internal" href="#headerlimit">3.7.7. 表の見出しの走査の終了条件の指定(headerLimit)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id22">3.7.8. 表の見出しに空白がある場合(range)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id23">3.7.9. 書き込み時にレコードが不足、余分である場合の操作の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id24">3.7.10. 任意の位置からレコードが開始するかを指定する場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id25">3.7.11. 表の名称を正規表現、正規化して指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlsverticalrecords">3.8. <code class="docutils literal notranslate"><span class="pre">&#64;XlsVerticalRecords</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id26">3.8.1. 表の名称位置の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="#right">3.8.2. 表の名称から開始位置が離れた場所にある場合(right)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bottom">3.8.3. 表の名称から開始位置が離れた場所にある場合(bottom)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id27">3.8.4. 表の見出しが横に結合されデータレコードの開始位置が離れた場所にある場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id28">3.8.5. 書き込み時にレコードが不足、余分である場合の操作の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id29">3.8.6. 任意の位置からレコードが開始するかを指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlscolumn">3.9. <code class="docutils literal notranslate"><span class="pre">&#64;XlsColumn</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id30">3.9.1. データの列が結合されている場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#annotationxlscolumnheadermerged">3.9.2. 見出し行が結合されている場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id32">3.9.3. 見出しを正規表現、正規化して指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlsmapcolumns">3.10. <code class="docutils literal notranslate"><span class="pre">&#64;XlsMapColumns</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id33">3.10.1. 終了条件のセルを指定する場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id34">3.10.2. 型変換する場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id35">3.10.3. 位置情報／見出し情報を取得する際の注意事項</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id36">3.10.4. 見出しを正規表現、正規化して指定する場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id37">3.10.5. 書き込み前に動的にテンプレートファイルを書き換える</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlsarraycolumns">3.11. <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayColumns</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id38">3.11.1. 結合したセルをマッピングする場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id39">3.11.2. 書き込み時に配列・リストのサイズが不足、または余分である場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id40">3.11.3. 位置情報／見出し情報を取得する際の注意事項</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id41">3.11.4. 見出しを正規表現、正規化して指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlsnestedrecords">3.12. <code class="docutils literal notranslate"><span class="pre">&#64;XlsNestedRecords</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id42">3.12.1. 一対多の関係</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id43">3.12.2. 一対一の関係</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlsiteratetables">3.13. <code class="docutils literal notranslate"><span class="pre">&#64;XlsIterateTables</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id44">3.13.1. 基本的な使い方</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id45">3.13.2. 縦方向の表を組み合わせてマッピングする場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id46">3.13.3. 表の名称を正規表現、正規化して指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlsorder">3.14. <code class="docutils literal notranslate"><span class="pre">&#64;XlsOrder</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#xlsignorable">3.15. <code class="docutils literal notranslate"><span class="pre">&#64;XlsIgnorable</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#isemptybuilder">3.15.1. IsEmptyBuilderを使った記述の簡単化</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlsarrayoption">3.16. <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayOption</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overoperation">3.16.1. 書き込み時に配列・リストのサイズが不足している場合(overOperation)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#remainedoperation">3.16.2. 書き込み時に配列・リストのサイズが余っている場合(remainedOperation)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlsrecordoption">3.17. <code class="docutils literal notranslate"><span class="pre">&#64;XlsRecordOption</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id47">3.17.1. 書き込み時に配列・リストのサイズが不足している場合(overOperation)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id48">3.17.2. 書き込み時に配列・リストのサイズが余っている場合(remainedOperation)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlsrecordfinder">3.18. <code class="docutils literal notranslate"><span class="pre">&#64;XlsRecordFinder</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="annotation_converter.html">4. セルの書式の指定方法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="annotation_converter.html#xlsbooleanconverter">4.1. <code class="docutils literal notranslate"><span class="pre">&#64;XlsBooleanConverter</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#id2">4.1.1. 読み込み時の値の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#id3">4.1.2. 書き込み時の値の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#id4">4.1.3. 変換に失敗した際の処理</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_converter.html#xlsnumberconverter">4.2. <code class="docutils literal notranslate"><span class="pre">&#64;XlsNumberConverter</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#id5">4.2.1. 読み込み時の書式の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#id6">4.2.2. 書き込み時の書式の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#id8">4.2.3. 有効桁数の指定</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_converter.html#xlsdatetimeconverter">4.3. <code class="docutils literal notranslate"><span class="pre">&#64;XlsDateTimeConverter</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#id9">4.3.1. 読み込み時の書式の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#id10">4.3.2. 書き込み時の書式の指定</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_converter.html#xlsenumconverter">4.4. <code class="docutils literal notranslate"><span class="pre">&#64;XlsEnumConverter</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#id12">4.4.1. 基本的な使い方</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#id13">4.4.2. 別名でマッピングする場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_converter.html#xlsarrayconverter">4.5. <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayConverter</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#id14">4.5.1. 基本的な使い方</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#id15">4.5.2. 空の要素を無視する場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#id16">4.5.3. 要素の値を変換するクラスを指定する</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_converter.html#xlscelloption">4.6. <code class="docutils literal notranslate"><span class="pre">&#64;XlsCellOption</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="annotation_converter.html#id17">4.7. 独自のクラスタイプの対応方法</a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#cellconverter">4.7.1. CellConverterの実装クラスの作成</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#cellconverterfactory">4.7.2. CellConverterFactoryの実装クラスの作成</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_converter.html#id18">4.7.3. 作成したCellConverterの使用方法</a><ul>
<li class="toctree-l4"><a class="reference internal" href="annotation_converter.html#xlsconverter">4.7.3.1. <code class="docutils literal notranslate"><span class="pre">&#64;XlsConverter</span></code> を使用する方法</a></li>
<li class="toctree-l4"><a class="reference internal" href="annotation_converter.html#cellconverterregistry">4.7.3.2. CellConverterRegistry を使用する方法</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="annotation_valueconverter.html">5. セルの値の変換方法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="annotation_valueconverter.html#xlstrim">5.1. <code class="docutils literal notranslate"><span class="pre">&#64;XlsTrim</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="annotation_valueconverter.html#xlsdefaultvalue">5.2. <code class="docutils literal notranslate"><span class="pre">&#64;XlsDefaultValue</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="annotation_formula.html">6. 数式の指定方法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="annotation_formula.html#xlsformula">6.1. <code class="docutils literal notranslate"><span class="pre">&#64;XlsFormula</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_formula.html#value">6.1.1. 数式を直接指定する場合（属性value）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_formula.html#methodname">6.1.2. 数式を組み立てるメソッドを指定する場合（属性methodName）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_formula.html#primary">6.1.3. 数式を優先する場合（属性primary）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_formula.html#id2">6.1.4. 式言語処理のカスタマイズ</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_formula.html#id3">6.1.5. 数式を設定する際のポイント</a><ul>
<li class="toctree-l4"><a class="reference internal" href="annotation_formula.html#id4">6.1.5.1. 処理順序を一定にすることによる数式中の座標のずれを防ぐ</a></li>
<li class="toctree-l4"><a class="reference internal" href="annotation_formula.html#el">6.1.5.2. EL式中でプロパティを参照する場合</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="annotation_formula.html#id5">6.1.6. 複雑な表を作成する</a><ul>
<li class="toctree-l4"><a class="reference internal" href="annotation_formula.html#javabean">6.1.6.1. JavaBeanの定義</a></li>
<li class="toctree-l4"><a class="reference internal" href="annotation_formula.html#id6">6.1.6.2. データの作成とファイルの出力</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="annotation_lifecycle.html">7. ライフサイクルイベントの管理</a><ul>
<li class="toctree-l2"><a class="reference internal" href="annotation_lifecycle.html#javabean">7.1. JavaBeanクラスに実装する場合</a></li>
<li class="toctree-l2"><a class="reference internal" href="annotation_lifecycle.html#annotationxlslistener">7.2. リスナークラスに実装する場合</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sheetinfo.html">8. シート情報の取得</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sheetinfo.html#id2">8.1. シート上の位置情報の取得</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sheetinfo.html#id3">8.1.1. 書き込み時の位置情報取得の注意点</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sheetinfo.html#id4">8.2. シート上の見出しの取得</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="xmlmapping.html">9. XMLによるマッピング方法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="xmlmapping.html#id1">9.1. アノテーションをXMLで上書きする場合</a></li>
<li class="toctree-l2"><a class="reference internal" href="xmlmapping.html#xml-build">9.2. XMLを動的に組み立てる場合</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="validation.html">10. 値の検証方法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="validation.html#id2">10.1. 検証の基本</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html#id3">10.2. 独自の入力値検証</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html#id4">10.3. フィールド（プロパティ）の入力値検証</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html#id5">10.4. メッセージファイルの定義</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html#id6">10.5. メッセージファイルの読み込み方法の変更</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html#bean-validation">10.6. Bean Validationを使用した入力値検証</a><ul>
<li class="toctree-l3"><a class="reference internal" href="validation.html#id7">10.6.1. Bean Validationのカスタマイズ</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fieldprocessor.html">11. 独自の表・セルのマッピング方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="spring.html">12. SpringFrameworkとの連携</a><ul>
<li class="toctree-l2"><a class="reference internal" href="spring.html#id1">12.1. ライブラリの追加</a></li>
<li class="toctree-l2"><a class="reference internal" href="spring.html#xml">12.2. XMLによるコンテナの設定</a></li>
<li class="toctree-l2"><a class="reference internal" href="spring.html#javaconfig">12.3. JavaConfigによるコンテナの設定</a></li>
<li class="toctree-l2"><a class="reference internal" href="spring.html#springbean">12.4. SpringBeanとしての定義</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">13. システム設定</a></li>
<li class="toctree-l1"><a class="reference internal" href="diff_xlsbeans.html">14. XLSBeansとの違い</a><ul>
<li class="toctree-l2"><a class="reference internal" href="diff_xlsbeans.html#id1">14.1. 改善機能</a></li>
<li class="toctree-l2"><a class="reference internal" href="diff_xlsbeans.html#id2">14.2. 追加機能</a></li>
<li class="toctree-l2"><a class="reference internal" href="diff_xlsbeans.html#id3">14.3. 削除機能</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="migration.html">15. マイグレーション</a><ul>
<li class="toctree-l2"><a class="reference internal" href="migration.html#to-ver-2-0">15.1. To ver.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="migration.html#id2">15.1.1. 前提環境の変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration.html#id3">15.1.2. クラス名などの変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration.html#id4">15.1.3. アノテーションの定義の変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration.html#id5">15.1.4. その他の変更</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="migration.html#to-ver-1-1">15.2. To ver.1.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration.html#to-ver-1-2">15.3. To ver.1.2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release.html">16. リリースノート</a><ul>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-2-0-2018-06-30">16.1. ver.2.0 - 2018-06-30</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-6-2017-01-02">16.2. ver.1.6 - 2017-01-02</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-5-2-2016-10-30">16.3. ver.1.5.2 - 2016-10-30</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-5-1-2016-10-30">16.4. ver.1.5.1 - 2016-10-30</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-5-0-2016-08-30">16.5. ver.1.5.0 - 2016-08-30</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-4-4-2016-07-02">16.6. ver.1.4.4 - 2016-07-02</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-4-3-2016-05-28">16.7. ver.1.4.3 - 2016-05-28</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-4-2-2016-05-07">16.8. ver.1.4.2 - 2016-05-07</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-4-1-2016-04-29">16.9. ver.1.4.1 - 2016-04-29</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-4-2016-03-21">16.10. ver.1.4 - 2016-03-21</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-3-2016-03-13">16.11. ver.1.3 - 2016-03-13</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-2-1-2016-03-12">16.12. ver.1.2.1 - 2016-03-12</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-2-2016-03-12">16.13. ver.1.2 - 2016-03-12</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-1-2016-03-08">16.14. ver.1.1 - 2016-03-08</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-0a-2015-09-23">16.15. ver.1.0a - 2015-09-23</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-0-2015-07-19">16.16. ver.1.0 - 2015-07-19</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-5-2015-06-29">16.17. ver.0.5 - 2015-06-29</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-4-2015-04-05">16.18. ver.0.4 - 2015-04-05</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-3-2015-01-11">16.19. ver.0.3 - 2015-01-11</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-2-3-2015-01-01">16.20. ver.0.2.3 - 2015-01-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-2-2-2014-12-01">16.21. ver.0.2.2 - 2014-12-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-2-1-2014-11-25">16.22. ver.0.2.1 - 2014-11-25</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-2-2014-11-24">16.23. ver.0.2 - 2014-11-24</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-1-2014-10-30">16.24. ver.0.1 - 2014-10-30</a></li>
</ul>
</li>
</ul>

            
          
<!-- my theme custom extramenu beacon -->
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">XlsMapper</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>3. 表・セルのマッピング方法</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/annotation_mapping.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>3. 表・セルのマッピング方法<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>表やセルをマッピングするためには様々なアノテーションが用意されています。</p>
<p>様々な表に対応するため、マッピング方法を指定するためのアノテーションと補助的に詳細なオプションを指定するためのアノテーションがあります。</p>
<p>もし、独自の構造の表をマッピングするならば、「 <a class="reference internal" href="fieldprocessor.html"><span class="doc">独自の表・セルのマッピング方法</span></a> 」を参照してください。</p>
<table border="1" class="colwidths-given docutils" id="id49">
<caption><span class="caption-number">表 - 3.1 </span><span class="caption-text">基本的なマッピング用のアノテーション</span><a class="headerlink" href="#id49" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">アノテーション</th>
<th class="head">概要</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="annotation_mapping_sheet.html#annotationxlssheet"><span class="std std-ref">&#64;XlsSheet</span></a></td>
<td>シートをマッピングするためにクラスに付与し使用します。</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="annotation_mapping_sheetname.html#annotationxlssheetname"><span class="std std-ref">&#64;XlsSheetName</span></a></td>
<td>シート名をマッピングします。</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="annotation_mapping_cell.html#annotationxlscell"><span class="std std-ref">&#64;XlsCell</span></a></td>
<td>セルの座標を直接指定してマッピングします。</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="annotation_mapping_labelledcell.html#annotationxlslabelledcell"><span class="std std-ref">&#64;XlsLabelledCell</span></a></td>
<td>見出し付きのセルをマッピングします。</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="annotation_mapping_arraycells.html#annotationxlsarraycells"><span class="std std-ref">&#64;XlsArrayCells</span></a></td>
<td>連続し隣接するセルを配列またはリストにマッピングします。</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="annotation_mapping_labelledarraycells.html#annotationxlslabelledarraycells"><span class="std std-ref">&#64;XlsLabelledArrayCells</span></a></td>
<td>見出し付きの連続し隣接するセルを配列またはリストにマッピングします。</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a></td>
<td>水平方向に連続する行のレコードを持つ表をマッピングします。</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="annotation_mapping_verticalrecords.html#annotationxlsverticalrecords"><span class="std std-ref">&#64;XlsVerticalRecords</span></a></td>
<td>垂直方向に連続する列のレコードを持つ表をマッピングします。</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="annotation_mapping_column.html#annotationxlscolumn"><span class="std std-ref">&#64;XlsColumn</span></a></td>
<td>レコードのカラムをマッピングします。</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="annotation_mapping_mapcolumns.html#annotationxlsmapcolumns"><span class="std std-ref">&#64;XlsMapColumns</span></a></td>
<td>レコードの可変長のカラムをマッピングします。</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="annotation_mapping_arraycolumns.html#annotationxlsarraycolumns"><span class="std std-ref">&#64;XlsArrayColumns</span></a></td>
<td>レコードの隣接するカラムをマッピングします。</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="annotation_mapping_nestedrecords.html#annotationxlsnestedrecords"><span class="std std-ref">&#64;XlsNestedRecords</span></a></td>
<td>入れ子構造のレコードをマッピングします。</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="annotation_mapping_iteratetables.html#annotationxlsiteratetables"><span class="std std-ref">&#64;XlsIterateTables</span></a></td>
<td>シート内で繰り返される同一構造の表をマッピングします。</td>
</tr>
</tbody>
</table>
<table border="1" class="colwidths-given docutils" id="id50">
<caption><span class="caption-number">表 - 3.2 </span><span class="caption-text">補助的なマッピング用のアノテーション</span><a class="headerlink" href="#id50" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">アノテーション</th>
<th class="head">概要</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="annotation_mapping_order.html#annotationxlsorder"><span class="std std-ref">&#64;XlsOrder</span></a></td>
<td>フィールドの処理順序を指定するために使用します。</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="annotation_mapping_ignorable.html#annotationxlsignorable"><span class="std std-ref">&#64;XlsIgnorable</span></a></td>
<td>レコードを読み飛ばすことが可能か判定するためのメソッドに使用します。</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="annotation_mapping_arrayoption.html#annotationxlsarrayoption"><span class="std std-ref">&#64;XlsArrayOption</span></a></td>
<td>連続し隣接するセルを配列またはリストを書き込む際の制御を行います。</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="annotation_mapping_recordoption.html#annotationxlsrecordoption"><span class="std std-ref">&#64;XlsRecordOption</span></a></td>
<td>レコードを書き込む際の制御を行います。</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="annotation_mapping_recordfinder.html#annotationxlsrecordfinder"><span class="std std-ref">&#64;XlsRecordFinder</span></a></td>
<td>レコードの開始位置をプログラマティックに指定します。</td>
</tr>
</tbody>
</table>
<div class="section" id="xlssheet">
<span id="annotationxlssheet"></span><h2>3.1. <code class="docutils literal notranslate"><span class="pre">&#64;XlsSheet</span></code><a class="headerlink" href="#xlssheet" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>マッピング対象のシートを「シート番号」「シート名」「シート名に対する正規表現」のいずれかで指定します。</p>
<p>クラスに付与します。</p>
<div class="literal-block-wrapper docutils container" id="id51">
<div class="code-block-caption"><span class="caption-number">コード - 3.1.1 </span><span class="caption-text">シート番号で指定する場合</span><a class="headerlink" href="#id51" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">number</span><span class="o">=</span><span class="mi">0</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="literal-block-wrapper docutils container" id="id52">
<div class="code-block-caption"><span class="caption-number">コード - 3.1.2 </span><span class="caption-text">シート名で指定する場合</span><a class="headerlink" href="#id52" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="literal-block-wrapper docutils container" id="id53">
<div class="code-block-caption"><span class="caption-number">コード - 3.1.3 </span><span class="caption-text">シート名を正規表現で指定する場合</span><a class="headerlink" href="#id53" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">regex</span><span class="o">=</span><span class="s">&quot;Users.+&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id2">
<h3>3.1.1. シート名を正規表現で指定する場合<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>正規表現で指定する場合は、 <code class="docutils literal notranslate"><span class="pre">XlsMapper#loadMultiple(...)</span></code> メソッドを用いることで、同じ形式の一致した複数シートの情報を一度に取得することができます。</p>
<p>書き込み時は、複数のシートが一致する可能性があり、1つに特定できない場合があるため注意が必要です。</p>
<ul class="simple">
<li>正規表現に一致するシートが1つしかない場合は、そのまま書き込みます。<cite>[ver0.5+]</cite></li>
<li>正規表現に一致するシートが複数ある場合、アノテーション <a class="reference internal" href="annotation_mapping_sheetname.html#annotationxlssheetname"><span class="std std-ref">&#64;XlsSheetName</span></a> を付与したフィールドの値を元に決定します。
そのため、予めフィールドに設定しておく必要があります。</li>
<li>アノテーション <a class="reference internal" href="annotation_mapping_sheetname.html#annotationxlssheetname"><span class="std std-ref">&#64;XlsSheetName</span></a> を付与しているフィールドを指定し、その値に一致しなくても、正規表現に一致するシートが1つ一致すれば、そのシートに書き込まれます。<cite>[ver0.5+]</cite></li>
</ul>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">regex</span><span class="o">=</span><span class="s">&quot;Sheet_[0-9]+&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// シート名をマッピングするフィールド</span>
    <span class="nd">@XlsSheetName</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">sheetName</span><span class="o">;</span>
    <span class="o">...</span>
<span class="o">}</span>


<span class="c1">// 正規表現による複数のシートを出力する場合。</span>
<span class="c1">// 書き込み時に、シート名を設定して、一意に関連づけます。</span>
<span class="n">SampleSheet</span> <span class="n">sheet1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleSheet</span><span class="o">();</span>
<span class="n">sheet1</span><span class="o">.</span><span class="na">sheetName</span> <span class="o">=</span> <span class="s">&quot;Sheet_1&quot;</span><span class="o">;</span> <span class="c1">// シート名の設定</span>

<span class="n">SampleSheet</span> <span class="n">sheet2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleSheet</span><span class="o">();</span>
<span class="n">sheet2</span><span class="o">.</span><span class="na">sheetName</span> <span class="o">=</span> <span class="s">&quot;Sheet_2&quot;</span><span class="o">;</span> <span class="c1">// シート名の設定</span>

<span class="n">SampleSheet</span> <span class="n">sheet3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleSheet</span><span class="o">();</span>
<span class="n">sheet3</span><span class="o">.</span><span class="na">sheetName</span> <span class="o">=</span> <span class="s">&quot;Sheet_3&quot;</span><span class="o">;</span> <span class="c1">// シート名の設定</span>

<span class="c1">// 複数のシートの書き込み</span>
<span class="n">XlsMapper</span> <span class="n">xlsMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XlsMapper</span><span class="o">();</span>
<span class="n">xlsMapper</span><span class="o">.</span><span class="na">saveMultiple</span><span class="o">(</span><span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="s">&quot;template.xls&quot;</span><span class="o">),</span>
    <span class="k">new</span> <span class="n">FileOutputStream</span><span class="o">(</span><span class="s">&quot;out.xls&quot;</span><span class="o">),</span>
    <span class="k">new</span> <span class="n">Object</span><span class="o">[]{</span><span class="n">sheet1</span><span class="o">,</span> <span class="n">sheet2</span><span class="o">,</span> <span class="n">sheet3</span><span class="o">}</span>
<span class="o">);</span>
</pre></div>
</td></tr></table></div>
<p>動的に書き込むシート数が変わるような場合は、下記のように、テンプレート用のシートをコピーしてから処理を行います。</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// 正規表現による複数のシートを出力する場合。</span>
<span class="c1">// 書き込み時に、シート名を設定して、一意に関連づけます。</span>
<span class="n">SampleSheet</span> <span class="n">sheet1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleSheet</span><span class="o">();</span>
<span class="n">sheet1</span><span class="o">.</span><span class="na">sheetName</span> <span class="o">=</span> <span class="s">&quot;Sheet_1&quot;</span><span class="o">;</span> <span class="c1">// シート名の設定</span>

<span class="n">SampleSheet</span> <span class="n">sheet2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleSheet</span><span class="o">();</span>
<span class="n">sheet2</span><span class="o">.</span><span class="na">sheetName</span> <span class="o">=</span> <span class="s">&quot;Sheet_2&quot;</span><span class="o">;</span> <span class="c1">// シート名の設定</span>

<span class="n">SampleSheet</span> <span class="n">sheet3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleSheet</span><span class="o">();</span>
<span class="n">sheet3</span><span class="o">.</span><span class="na">sheetName</span> <span class="o">=</span> <span class="s">&quot;Sheet_3&quot;</span><span class="o">;</span> <span class="c1">// シート名の設定</span>

<span class="n">SampleSheet</span><span class="o">[]</span> <span class="n">sheets</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleSheet</span><span class="o">[]{</span><span class="n">sheet1</span><span class="o">,</span> <span class="n">sheet2</span><span class="o">,</span> <span class="n">sheet3</span><span class="o">};</span>

<span class="c1">// シートのクローン</span>
<span class="n">Workbook</span> <span class="n">workbook</span> <span class="o">=</span> <span class="n">WorkbookFactory</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="s">&quot;template.xlsx&quot;</span><span class="o">));</span>
<span class="n">Sheet</span> <span class="n">templateSheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="na">getSheet</span><span class="o">(</span><span class="s">&quot;XlsSheet(regexp)&quot;</span><span class="o">);</span>
<span class="k">for</span><span class="o">(</span><span class="n">SampleSheet</span> <span class="n">sheetObj</span> <span class="o">:</span> <span class="n">sheets</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">sheetIndex</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="na">getSheetIndex</span><span class="o">(</span><span class="n">templateSheet</span><span class="o">);</span>
    <span class="n">Sheet</span> <span class="n">cloneSheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="na">cloneSheet</span><span class="o">(</span><span class="n">sheetIndex</span><span class="o">);</span>
    <span class="n">workbook</span><span class="o">.</span><span class="na">setSheetName</span><span class="o">(</span><span class="n">workbook</span><span class="o">.</span><span class="na">getSheetIndex</span><span class="o">(</span><span class="n">cloneSheet</span><span class="o">),</span> <span class="n">sheetObj</span><span class="o">.</span><span class="na">sheetName</span><span class="o">);</span>
<span class="o">}</span>

<span class="c1">// コピー元のシートを削除する</span>
<span class="n">workbook</span><span class="o">.</span><span class="na">removeSheetAt</span><span class="o">(</span><span class="n">workbook</span><span class="o">.</span><span class="na">getSheetIndex</span><span class="o">(</span><span class="n">templateSheet</span><span class="o">));</span>

<span class="c1">// クローンしたシートファイルを、一時ファイルに一旦出力する。</span>
<span class="n">File</span> <span class="n">cloneTemplateFile</span> <span class="o">=</span> <span class="n">File</span><span class="o">.</span><span class="na">createTempFile</span><span class="o">(</span><span class="s">&quot;template&quot;</span><span class="o">,</span> <span class="s">&quot;.xlsx&quot;</span><span class="o">);</span>
<span class="n">workbook</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="k">new</span> <span class="n">FileOutputStream</span><span class="o">(</span><span class="n">cloneTemplateFile</span><span class="o">));</span>

<span class="c1">// 複数のシートの書き込み</span>
<span class="n">XlsMapper</span> <span class="n">xlsMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XlsMapper</span><span class="o">();</span>
<span class="n">xlsMapper</span><span class="o">.</span><span class="na">saveMultiple</span><span class="o">(</span>
        <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="n">cloneTemplateFile</span><span class="o">),</span> <span class="c1">// クローンしたシートを持つファイルを指定する</span>
        <span class="k">new</span> <span class="n">FileOutputStream</span><span class="o">(</span><span class="s">&quot;out.xlsx&quot;</span><span class="o">),</span>
        <span class="n">sheets</span><span class="o">);</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlssheetname">
<span id="annotationxlssheetname"></span><h2>3.2. <code class="docutils literal notranslate"><span class="pre">&#64;XlsSheetName</span></code><a class="headerlink" href="#xlssheetname" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>シート名をString型のプロパティにマッピングします。</p>
<div class="literal-block-wrapper docutils container" id="id54">
<div class="code-block-caption"><span class="caption-number">コード - 3.2.1 </span><span class="caption-text">基本的な使い方</span><a class="headerlink" href="#id54" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsSheetName</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">sheetName</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>書き込み時に、アノテーション <a class="reference internal" href="annotation_mapping_sheet.html#annotationxlssheet"><span class="std std-ref">&#64;XlsSheet(regex=&quot;&lt;シート名&gt;&quot;)</span></a> にて、
シート名を正規表現で指定している場合は、 <code class="docutils literal notranslate"><span class="pre">&#64;XlsSheetName</span></code> を付与しているフィールドで書き込むシートを決定します。</p>
<p class="last">そのため書き込む前に、シート名を指定する必要があります。</p>
</div>
<div class="section" id="id3">
<h3>3.2.1. メソッドにアノテーションを付与する場合<a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>アノテーションをメソッドに付与する場合、書き込み時はgetterメソッドメソッドの付与が必要になります。</p>
<p>さらに、アノテーションは付与しなくてもよいですが、setterメソッドの定義が必要になります。</p>
<p>そのため、 <code class="docutils literal notranslate"><span class="pre">&#64;XlsSheetName</span></code> を指定する際にはフィールドに付与することをお薦めします。</p>
<div class="literal-block-wrapper docutils container" id="id55">
<div class="code-block-caption"><span class="caption-number">コード - 3.2.2 </span><span class="caption-text">メソッドにアノテーションを付与する場合（読み込み時）</span><a class="headerlink" href="#id55" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// 読み込み時は、setterメソッドに付与する。</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SheetObject</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">sheetName</span><span class="o">;</span>

    <span class="c1">// 読み込み時は、setterメソッドにアノテーションの付与が必要。</span>
    <span class="nd">@XlsSheetName</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSheetName</span><span class="o">(</span><span class="n">String</span> <span class="n">sheetName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">sheetName</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="literal-block-wrapper docutils container" id="id56">
<div class="code-block-caption"><span class="caption-number">コード - 3.2.3 </span><span class="caption-text">メソッドにアノテーションを付与する場合（書き込み時）</span><a class="headerlink" href="#id56" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// 書き込み時は、getterメソッドに付与し、かつsetterメソッドの定義が必要。</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">sheetName</span><span class="o">;</span>

    <span class="c1">// 書き込み時は、getterメソッドにアノテーションの付与が必要。</span>
    <span class="nd">@XlsSheetName</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getSheetName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">sheetName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// アノテーションの付与は必要ないが、定義が必要。</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSheetName</span><span class="o">(</span><span class="n">String</span> <span class="n">sheetName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">sheetName</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>
<div class="section" id="xlscell">
<span id="annotationxlscell"></span><h2>3.3. <code class="docutils literal notranslate"><span class="pre">&#64;XlsCell</span></code><a class="headerlink" href="#xlscell" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>セルの列と行を指定してBeanのプロパティにマッピングします。</p>
<p>フィールドまたはメソッドに対して付与します。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">column</span></code> 、 <code class="docutils literal notranslate"><span class="pre">row</span></code> で、インデックスを指定します。<ul>
<li>columnは列番号で、0から始まります。</li>
<li>rowは行番号で、0から始まります。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">address</span></code> で、 'B3' のようにシートのアドレス形式で指定もできます。<ul>
<li>属性addressを指定する場合は、column, rowは指定しないでください。</li>
<li>属性addressの両方を指定した場合、addressの値が優先されます。</li>
</ul>
</li>
</ul>
<div class="figure align-center" id="id57">
<img alt="_images/Cell.png" src="_images/Cell.png" />
<p class="caption"><span class="caption-number">図 - 3.3.1 </span><span class="caption-text">Cell</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// インデックス形式で指定する場合</span>
    <span class="nd">@XlsCell</span><span class="o">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="o">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">title</span><span class="o">;</span>

    <span class="c1">// アドレス形式で指定する場合</span>
    <span class="nd">@XlsCell</span><span class="o">(</span><span class="n">address</span><span class="o">=</span><span class="s">&quot;B3&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="xlslabelledcell">
<span id="annotationxlslabelledcell"></span><h2>3.4. <code class="docutils literal notranslate"><span class="pre">&#64;XlsLabelledCell</span></code><a class="headerlink" href="#xlslabelledcell" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>セルの見出し用のラベルセルを指定し、その左右もしくは下側のセルの値をマッピングします。</p>
<p>フィールドまたはメソッドに対して付与します。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">label</span></code> で、見出しとなるセルの値を指定します。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">type</span></code> で、見出しセルから見て値が設定されている位置を指定します。<ul>
<li>列挙型 <code class="docutils literal notranslate"><span class="pre">LabelledCellType</span></code> で、左右もしくは下側のセルを指定できます。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">optional</span></code> で、見出しとなるセルが見つからない場合に無視するかどうかを指定しできます。</li>
</ul>
<div class="figure align-center" id="id58">
<img alt="_images/LabelledCell.png" src="_images/LabelledCell.png" />
<p class="caption"><span class="caption-number">図 - 3.4.1 </span><span class="caption-text">LabelledCell</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsLabelledCell</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル1&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">title</span><span class="o">;</span>

    <span class="c1">// ラベルセルが見つからなくても処理を続行する</span>
    <span class="nd">@XlsLabelledCell</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル2&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Bottom</span><span class="o">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">summary</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="range">
<h3>3.4.1. ラベルセルから離れたセルを指定する方法（属性range）<a class="headerlink" href="#range" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>属性 <code class="docutils literal notranslate"><span class="pre">range</span></code> を指定すると、属性typeの方向に向かって指定した <strong>セル数分を検索</strong> し、最初に発見した空白以外のセルの値を取得します。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">range</span></code> と <code class="docutils literal notranslate"><span class="pre">skip</span></code> を同時に指定した場合、まず、skip分セルを読み飛ばし、そこからrangeの範囲で空白以外のセルを検索します。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">range</span></code> は、 <strong>読み込み時のみ有効</strong> です。書き込み時に指定しても無視されます。</li>
</ul>
<div class="figure align-center" id="id59">
<img alt="_images/LabelledCell_range.png" src="_images/LabelledCell_range.png" />
<p class="caption"><span class="caption-number">図 - 3.4.2 </span><span class="caption-text">LabelledCell(range)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsLabelledCell</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">range</span><span class="o">=</span><span class="mi">4</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">title</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="skip">
<h3>3.4.2. ラベルセルから離れたセルを指定する方法（属性skip）<a class="headerlink" href="#skip" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>属性 <code class="docutils literal notranslate"><span class="pre">skip</span></code> を指定すると、属性typeの方向に向かって指定した <strong>セル数分離れた</strong> セルの値をマッピングすることができます。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">range</span></code> と <code class="docutils literal notranslate"><span class="pre">skip</span></code> を同時に指定した場合、まず、skip分セルを読み飛ばし、そこからrangeの範囲で空白以外のセルを検索します。</li>
</ul>
<div class="figure align-center" id="id60">
<img alt="_images/LabelledCell_skip.png" src="_images/LabelledCell_skip.png" />
<p class="caption"><span class="caption-number">図 - 3.4.3 </span><span class="caption-text">LabelledCell(skip)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsLabelledCell</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル1&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">title1</span><span class="o">;</span>

    <span class="nd">@XlsLabelledCell</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル2&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Bottom</span><span class="o">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">3</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">title2</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="labelmerged">
<h3>3.4.3. ラベルセルが結合している場合（属性labelMerged）<a class="headerlink" href="#labelmerged" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">labelMerged</span></code> で、見出しのラベルセルが結合を考慮するか指定します。  <cite>[ver.2.0+]</cite><ul>
<li>trueのときは、結合されているセルを1つのラベルセルとしてマッピングします。</li>
<li>falseの場合は、結合されていても解除した状態と同じマッピング結果となります。</li>
<li>初期値はtrueであるため、特に意識はする必要はありません。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">labelMerged</span></code> の値がfalseのとき、ラベルセルが結合されていると、値が設定されているデータセルまでの距離が変わるため、属性 <code class="docutils literal notranslate"><span class="pre">skip</span></code> を併用します。</li>
</ul>
<div class="figure align-center" id="id61">
<img alt="_images/LabelledCell_labelMerged.png" src="_images/LabelledCell_labelMerged.png" />
<p class="caption"><span class="caption-number">図 - 3.4.4 </span><span class="caption-text">LabelledCell(labelMerged)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// labelMerged=trueは初期値なので、省略可</span>
    <span class="nd">@XlsLabelledCell</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル1&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">title1</span><span class="o">;</span>

    <span class="c1">// labelMerged=falseで、ラベルが結合しているときは、skip属性を併用します。</span>
    <span class="nd">@XlsLabelledCell</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル2&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">labelMerged</span><span class="o">=</span><span class="kc">false</span><span class="o">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">title2</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id4">
<h3>3.4.4. ラベルセルが重複するセルを指定する方法<a class="headerlink" href="#id4" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>同じラベルのセルが複数ある場合は、区別するための見出しを属性 <code class="docutils literal notranslate"><span class="pre">headerLabel</span></code> で指定します。</p>
<p>属性headerLabelで指定したセルから、label属性で指定したセルを下方向に検索し、最初に見つかった一致するセルをラベルセルとして使用します。</p>
<div class="figure align-center" id="id62">
<img alt="_images/LabelledCell_headerLabel.png" src="_images/LabelledCell_headerLabel.png" />
<p class="caption"><span class="caption-number">図 - 3.4.5 </span><span class="caption-text">LabelledCell(headerLabel)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsLabelledCell</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;クラス名&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span>
            <span class="n">headerLabel</span><span class="o">=</span><span class="s">&quot;アクション&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">actionClassName</span><span class="o">;</span>

    <span class="nd">@XlsLabelledCell</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;クラス名&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span>
            <span class="n">headerLabel</span><span class="o">=</span><span class="s">&quot;アクションフォーム&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">formClassName</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id5">
<h3>3.4.5. ラベルセルを正規表現、正規化して指定する場合<a class="headerlink" href="#id5" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>シートの構造は同じだが、ラベルのセルが微妙に異なる場合、ラベルセルを正規表現による指定が可能です。
また、空白や改行を除去してラベルセルを比較するように設定することも可能です。 <cite>[ver1.1+]</cite></p>
<ul class="simple">
<li>正規表現で指定する場合、アノテーションの属性の値を <code class="docutils literal notranslate"><span class="pre">/正規表現/</span></code> のように、スラッシュで囲み指定します。<ul>
<li>スラッシュで囲まない場合、通常の文字列として処理されます。</li>
<li>正規表現の指定機能を有効にするには、<a class="reference internal" href="configuration.html"><span class="doc">システム設定のプロパティ</span></a> <code class="docutils literal notranslate"><span class="pre">regexLabelText</span></code> の値を trueに設定します。</li>
</ul>
</li>
<li>ラベセルの値に改行が空白が入っている場合、それらを除去し、正規化してアノテーションの属性値と比較することが可能です。<ul>
<li>正規化とは、空白、改行、タブを除去することを指します。</li>
<li>ラベルを正規化する機能を有効にするには、<a class="reference internal" href="configuration.html"><span class="doc">システム設定のプロパティ</span></a> <code class="docutils literal notranslate"><span class="pre">normalizeLabelText</span></code> の値を trueに設定します。</li>
</ul>
</li>
</ul>
<p>これらの指定が可能な属性は、<code class="docutils literal notranslate"><span class="pre">label</span></code> , <code class="docutils literal notranslate"><span class="pre">headerLabel</span></code> です。</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// システム設定</span>
<span class="n">XlsMapper</span> <span class="n">xlsMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XlsMapper</span><span class="o">();</span>
<span class="n">xlsMapper</span><span class="o">.</span><span class="na">getConfiguration</span><span class="o">()</span>
        <span class="o">.</span><span class="na">setRegexLabelText</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>        <span class="c1">// ラベルを正規表現で指定可能にする機能を有効にする。</span>
        <span class="o">.</span><span class="na">setNormalizeLabelText</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>   <span class="c1">// ラベルを正規化して比較する機能を有効にする。</span>

<span class="c1">// シート用クラス</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// 正規表現による指定</span>
    <span class="nd">@XlsLabelledCell</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;/名前.+/&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">className</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlsarraycells">
<span id="annotationxlsarraycells"></span><h2>3.5. <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayCells</span></code><a class="headerlink" href="#xlsarraycells" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>連続し隣接するセルをCollection(List, Set)または配列にマッピングします。  <cite>[ver.2.0+]</cite></p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">column</span></code> 、 <code class="docutils literal notranslate"><span class="pre">row</span></code> で、セルの位置をインデックスで指定します。<ul>
<li>columnは列番号で、0から始まります。</li>
<li>rowは行番号で、0から始まります。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">address</span></code> で、 'B3' のようにシートのアドレス形式で指定もできます。<ul>
<li>属性addressを指定する場合は、column, rowは指定しないでください。</li>
<li>属性addressの両方を指定した場合、addressの値が優先されます。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">direction</span></code> で、連続する隣接するセルの方向を指定します。<ul>
<li>列挙型 <code class="docutils literal notranslate"><span class="pre">ArrayDirection</span></code> で、横方向（右方向）もしくは、直方向（下方向）を指定できます。</li>
<li>初期値は、横方向（右方向）です。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">size</span></code> で、連続するセルの個数を指定します。</li>
<li>Collection(List, Set)型または配列のフィールドに付与します。<ul>
<li>List型などの場合、Genericsのタイプとして、マッピング先のクラスを指定します。</li>
<li>指定しない場合は、アノテーションの属性 <code class="docutils literal notranslate"><span class="pre">elementClass</span></code> でクラス型を指定します。</li>
</ul>
</li>
</ul>
<div class="figure align-center" id="id63">
<img alt="_images/ArrayCells.png" src="_images/ArrayCells.png" />
<p class="caption"><span class="caption-number">図 - 3.5.1 </span><span class="caption-text">ArrayCells</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// インデックス形式、横方向で指定する場合</span>
    <span class="c1">// 属性directionを省略した場合は、ArrayDirection.Horizonを指定したと同じ意味。</span>
    <span class="nd">@XlsArrayCells</span><span class="o">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="o">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nameKanas1</span><span class="o">;</span>

    <span class="c1">// アドレス形式、配列にマッピング</span>
    <span class="nd">@XlsArrayCells</span><span class="o">(</span><span class="n">address</span><span class="o">=</span><span class="s">&quot;A1&quot;</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="o">,</span> <span class="n">direction</span><span class="o">=</span><span class="n">ArrayDirection</span><span class="o">.</span><span class="na">Horizon</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span><span class="o">[]</span> <span class="n">nameKanas2</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id6">
<h3>3.5.1. 縦方向に隣接したセルをマッピングする場合<a class="headerlink" href="#id6" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>縦方向にマッピングするため、属性 <code class="docutils literal notranslate"><span class="pre">direction</span></code> を、<code class="docutils literal notranslate"><span class="pre">ArrayDirection.Vertical</span></code> に設定します。</li>
</ul>
<div class="figure align-center" id="id64">
<img alt="_images/ArrayCells_direction.png" src="_images/ArrayCells_direction.png" />
<p class="caption"><span class="caption-number">図 - 3.5.2 </span><span class="caption-text">ArrayCells(direction)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// 縦方向の隣接するセル</span>
    <span class="c1">// 属性direction=ArrayDirection.Verticalを指定すると、縦方向にマッピングします。</span>
    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">address</span><span class="o">=</span><span class="s">&quot;B3&quot;</span><span class="o">,</span> <span class="n">direction</span><span class="o">=</span><span class="n">ArrayDirection</span><span class="o">.</span><span class="na">Vertical</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">names</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id7">
<h3>3.5.2. 結合したセルをマッピングする場合<a class="headerlink" href="#id7" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">elementMerged</span></code> で、セルの結合を考慮するか指定します。<ul>
<li>trueのときは、結合されているセルを1つのセルとしてマッピングします。</li>
<li>falseの場合は、結合されていても解除した状態と同じマッピング結果となります。<ul>
<li>ただし、falseのときは、書き込む際には結合が解除されます。</li>
</ul>
</li>
<li>初期値はtrueであるため、特に意識はする必要はありません。</li>
</ul>
</li>
<li>セルが結合されている場合は、結合後の個数を指定します。</li>
</ul>
<div class="figure align-center" id="id65">
<img alt="_images/ArrayCells_elementMerged.png" src="_images/ArrayCells_elementMerged.png" />
<p class="caption"><span class="caption-number">図 - 3.5.3 </span><span class="caption-text">ArrayCells(elementMerged)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// elementMerged=trueは初期値なので、省略可</span>
    <span class="nd">@XlsArrayCells</span><span class="o">(</span><span class="n">address</span><span class="o">=</span><span class="s">&quot;B3&quot;</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="o">,</span> <span class="n">elementMerged</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">words</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id8">
<h3>3.5.3. 書き込み時に配列・リストのサイズが不足、または余分である場合<a class="headerlink" href="#id8" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>アノテーション <a class="reference internal" href="annotation_mapping_arrayoption.html#annotationxlsarrayoption"><span class="std std-ref">&#64;XlsArrayOption</span></a> を指定することで、書き込み時のセルの制御を指定することができます。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">overOperation</span></code> で、書き込み時にJavaオブジェクトの配列・リストのサイズに対して、属性 <code class="docutils literal notranslate"><span class="pre">size</span></code> の値が小さく、足りない場合の操作を指定します。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">remainedOperation</span></code> で、書き込み時にJavaオブジェクトの配列・リストのサイズに対して、属性 <code class="docutils literal notranslate"><span class="pre">size</span></code> の値が大きく、余っている場合の操作を指定します。</li>
</ul>
<div class="figure align-center" id="id66">
<img alt="_images/ArrayColumns_ArrayOption.png" src="_images/ArrayColumns_ArrayOption.png" />
<p class="caption"><span class="caption-number">図 - 3.5.4 </span><span class="caption-text">ArrayCells(ArrayOption)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsArrayCells</span><span class="o">(</span><span class="n">address</span><span class="o">=</span><span class="s">&quot;B3&quot;</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="o">)</span>
    <span class="nd">@XlsArrayOption</span><span class="o">(</span><span class="n">overOperation</span><span class="o">=</span><span class="n">OverOperation</span><span class="o">.</span><span class="na">Error</span><span class="o">,</span> <span class="n">remainedOperation</span><span class="o">=</span><span class="n">RemainedOperation</span><span class="o">.</span><span class="na">Clear</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nameKana</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id9">
<h3>3.5.4. 位置情報／見出し情報を取得する際の注意事項<a class="headerlink" href="#id9" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>マッピング対象のセルのアドレスを取得する際に、フィールド <code class="docutils literal notranslate"><span class="pre">Map&lt;String,</span> <span class="pre">Point&gt;</span> <span class="pre">positions</span></code> を定義しておけば、自動的にアドレスがマッピングされます。</p>
<p>通常は、キーにはプロパティ名が記述（フィールドの場合はフィールド名）が入ります。</p>
<p>アノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayCells</span></code> でマッピングしたセルのキーは、 <code class="docutils literal notranslate"><span class="pre">&lt;プロパティ名&gt;[&lt;インデックス&gt;]</span></code> の形式になります。
インデックスは、0から始まります。</p>
<p>マッピング対象の見出しを取得する、フィールド <code class="docutils literal notranslate"><span class="pre">Map&lt;String,</span> <span class="pre">String&gt;</span> <span class="pre">labels</span></code> は、見出しはないため取得することはできません。</p>
<div class="figure align-center" id="id67">
<img alt="_images/ArrayCells_positions.png" src="_images/ArrayCells_positions.png" />
<p class="caption"><span class="caption-number">図 - 3.5.5 </span><span class="caption-text">XlsArrayCells(positions/labels)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="c1">// 位置情報</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Point</span><span class="o">&gt;</span> <span class="n">positions</span><span class="o">;</span>

    <span class="c1">// 見出し情報</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">labels</span><span class="o">;</span>

    <span class="nd">@XlsArrayCells</span><span class="o">(</span><span class="n">address</span><span class="o">=</span><span class="s">&quot;B3&quot;</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nameKana</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// 位置情報・見出し情報へのアクセス</span>
<span class="n">SampleRecord</span> <span class="n">record</span> <span class="o">=</span> <span class="cm">/* レコードのインスタンスの取得 */</span><span class="o">;</span>

<span class="n">Point</span> <span class="n">position</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">positions</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;nameKana[2]&quot;</span><span class="o">);</span>

<span class="c1">// 見出しは存在しないので、nullが返される</span>
<span class="n">String</span> <span class="n">label</span> <span class="o">=</span> <span class="n">recrod</span><span class="o">.</span><span class="na">labeles</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;nameKana[2]&quot;</span><span class="o">);</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlslabelledarraycells">
<span id="annotationxlslabelledarraycells"></span><h2>3.6. <code class="docutils literal notranslate"><span class="pre">&#64;XlsLabelledArrayCells</span></code><a class="headerlink" href="#xlslabelledarraycells" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>セルの見出し用のラベルセルを指定し、左右もしくは下側に連続し隣接するセルをCollection(List, Set)または配列にマッピングします。 <cite>[ver.2.0+]</cite></p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayCells</span></code> と <code class="docutils literal notranslate"><span class="pre">&#64;XlsLabelledCell</span></code> を融合したアノテーションとなります。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">label</span></code> で、見出しとなるセルの値を指定します。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">type</span></code> で、見出しセルから見て値が設定されている位置を指定します。<ul>
<li>列挙型 <code class="docutils literal notranslate"><span class="pre">LabelledCellType</span></code> で、左右もしくは下側のセルを指定できます。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">direction</span></code> で、連続する隣接するセルの方向を指定します。<ul>
<li>列挙型 <code class="docutils literal notranslate"><span class="pre">ArrayDirection</span></code> で、横方向（右方向）もしくは、直方向（下方向）を指定できます。</li>
<li>初期値は、横方向（右方向）です。</li>
<li>ただし、セルの位置を左側( <code class="docutils literal notranslate"><span class="pre">type=LabelledCellType.Left</span></code> ) とした場合、セルの方向は横方向( <code class="docutils literal notranslate"><span class="pre">direction=ArrayDirection.Horizon</span></code> ) は、設定できないため注意してください。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">size</span></code> で、連続するセルの個数を指定します。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">optional</span></code> で、見出しとなるセルが見つからない場合に無視するかどうかを指定しできます。</li>
<li>Collection(List, Set)型または配列のフィールドに付与します。<ul>
<li>List型などの場合、Genericsのタイプとして、マッピング先のクラスを指定します。</li>
<li>指定しない場合は、アノテーションの属性 <code class="docutils literal notranslate"><span class="pre">elementClass</span></code> でクラス型を指定します。</li>
</ul>
</li>
</ul>
<div class="figure align-center" id="id68">
<img alt="_images/LabelledArrayCells.png" src="_images/LabelledArrayCells.png" />
<p class="caption"><span class="caption-number">図 - 3.6.1 </span><span class="caption-text">LabelledArrayCells</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// ラベルの右側 + 横方向の隣接するセル</span>
    <span class="c1">// 属性directionを省略した場合は、ArrayDirection.Horizonを指定したと同じ意味。</span>
    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル1&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nameKanas1</span><span class="o">;</span>

    <span class="c1">// ラベルの下側 + 横方向の隣接するセル</span>
    <span class="c1">// 属性optional=trueと設定すると、ラベルセルが見つからなくても処理を続行する</span>
    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル2&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Bottom</span><span class="o">,</span>
             <span class="n">direction</span><span class="o">=</span><span class="n">ArrayDirection</span><span class="o">.</span><span class="na">Horizon</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="o">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span><span class="o">[]</span> <span class="n">nameKanas2</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id10">
<h3>3.6.1. 縦方向に隣接したセルをマッピングする場合<a class="headerlink" href="#id10" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>縦方向にマッピングするため、属性 <code class="docutils literal notranslate"><span class="pre">direction</span></code> を、<code class="docutils literal notranslate"><span class="pre">ArrayDirection.Vertical</span></code> に設定します。</li>
</ul>
<div class="figure align-center" id="id69">
<img alt="_images/LabelledArrayCells_direction.png" src="_images/LabelledArrayCells_direction.png" />
<p class="caption"><span class="caption-number">図 - 3.6.2 </span><span class="caption-text">LabelledArrayCells(direction)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// ラベルの右側 + 縦方向の隣接するセル</span>
    <span class="c1">// 属性direction=ArrayDirection.Verticalを指定すると、縦方向にマッピングします。</span>
    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル3&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span>
             <span class="n">direction</span><span class="o">=</span><span class="n">ArrayDirection</span><span class="o">.</span><span class="na">Vertical</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nameKanas3</span><span class="o">;</span>

    <span class="c1">// ラベルの下側 + 縦方向の隣接するセル</span>
    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル4&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span>
             <span class="n">direction</span><span class="o">=</span><span class="n">ArrayDirection</span><span class="o">.</span><span class="na">Vertical</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span><span class="o">[]</span> <span class="n">nameKanas4</span> <span class="n">nameKanas4</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id11">
<h3>3.6.2. ラベルセルから離れたセルを指定する方法（属性range）<a class="headerlink" href="#id11" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>属性 <code class="docutils literal notranslate"><span class="pre">range</span></code> を指定すると、属性typeの方向に向かって指定した <strong>セル数分を検索</strong> し、最初に発見した空白以外のセルを開始位置としてマッピングします。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">range</span></code> と <code class="docutils literal notranslate"><span class="pre">skip</span></code> を同時に指定した場合、まず、skip分セルを読み飛ばし、そこからrangeの範囲で空白以外のセルを検索します。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">range</span></code> は、 <strong>読み込み時のみ有効</strong> です。書き込み時に指定しても無視されます。</li>
<li>ラベルセルから離れたセルを指定する場合に使用します。</li>
<li>ただし、データセルが偶然空白のときは、マッピング対象のセルがずれるため、この属性を使用する場合は注意が必要です。</li>
</ul>
<div class="figure align-center" id="id70">
<img alt="_images/LabelledArrayCells_range.png" src="_images/LabelledArrayCells_range.png" />
<p class="caption"><span class="caption-number">図 - 3.6.3 </span><span class="caption-text">LabelledArrayCells(range)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル1&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">range</span><span class="o">=</span><span class="mi">4</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">words1</span><span class="o">;</span>

    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル2&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Bottom</span><span class="o">,</span> <span class="n">range</span><span class="o">=</span><span class="mi">5</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">words2</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id12">
<h3>3.6.3. ラベルセルから離れたセルを指定する方法（属性skip）<a class="headerlink" href="#id12" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>属性 <code class="docutils literal notranslate"><span class="pre">skip</span></code> を指定すると、属性typeの方向に向かって、ラベルセルから指定した <strong>セル数分離れた</strong> セルを開始位置としてマッピングします。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">range</span></code> と <code class="docutils literal notranslate"><span class="pre">skip</span></code> を同時に指定した場合、まず、skip分セルを読み飛ばし、そこからrangeの範囲で空白以外のセルを検索します。</li>
</ul>
<div class="figure align-center" id="id71">
<img alt="_images/LabelledArrayCells_skip.png" src="_images/LabelledArrayCells_skip.png" />
<p class="caption"><span class="caption-number">図 - 3.6.4 </span><span class="caption-text">LabelledArrayCells(skip)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル1&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="o">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">words1</span><span class="o">;</span>

     <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル2&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Bottom</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="o">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">3</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">words2</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id13">
<h3>3.6.4. 重複するラベルを指定する場合<a class="headerlink" href="#id13" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>同じラベルのセルが複数ある場合は、区別するため見出しを属性 <code class="docutils literal notranslate"><span class="pre">headerLabel</span></code> で指定します。</p>
<p>属性headerLabelで指定したセルから、label属性で指定したセルを下方向に検索し、最初に見つかった一致するセルをラベルセルとして使用します。</p>
<div class="figure align-center" id="id72">
<img alt="_images/LabelledArrayCells_headerLabel.png" src="_images/LabelledArrayCells_headerLabel.png" />
<p class="caption"><span class="caption-number">図 - 3.6.5 </span><span class="caption-text">LabelledArrayCells(headerLabel)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ふりがな&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span>
            <span class="n">headerLabel</span><span class="o">=</span><span class="s">&quot;氏名&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nameRuby</span><span class="o">;</span>

    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ふりがな&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span>
            <span class="n">headerLabel</span><span class="o">=</span><span class="s">&quot;住所&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">addressRuby</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id14">
<h3>3.6.5. ラベルセルが結合している場合（属性labelMerged）<a class="headerlink" href="#id14" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">labelMerged</span></code> で、見出しのラベルセルが結合を考慮するか指定します。<ul>
<li>trueのときは、結合されているセルを1つのラベルセルとしてマッピングします。</li>
<li>falseの場合は、結合されていても解除した状態と同じマッピング結果となります。</li>
<li>初期値はtrueであるため、特に意識はする必要はありません。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">labelMerged</span></code> の値がfalseのとき、ラベルセルが結合されていると、値が設定されているデータセルまでの距離が変わるため、属性 <code class="docutils literal notranslate"><span class="pre">skip</span></code> を併用します。</li>
</ul>
<div class="figure align-center" id="id73">
<img alt="_images/LabelledArrayCells_labelMerged.png" src="_images/LabelledArrayCells_labelMerged.png" />
<p class="caption"><span class="caption-number">図 - 3.6.6 </span><span class="caption-text">LabelledArrayCells(labelMerged)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// labelMerged=trueは初期値なので、省略可</span>
    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル1&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">name1</span><span class="o">;</span>

    <span class="c1">// labelMerged=falseで、ラベルが結合しているときは、skip属性を併用します。</span>
    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル2&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="o">,</span>
             <span class="n">labelMerged</span><span class="o">=</span><span class="kc">false</span><span class="o">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">name2</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="elementmerged">
<h3>3.6.6. 結合したセルをマッピングする場合（属性elementMerged）<a class="headerlink" href="#elementmerged" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">elementMerged</span></code> で、セルの結合を考慮するか指定します。<ul>
<li>trueのときは、結合されているセルを1つのセルとしてマッピングします。</li>
<li>falseの場合は、結合されていても解除した状態と同じマッピング結果となります。<ul>
<li>ただし、falseのときは、書き込む際には結合が解除されます。</li>
</ul>
</li>
<li>初期値はtrueであるため、特に意識はする必要はありません。</li>
</ul>
</li>
<li>セルが結合されている場合は、結合後の個数を指定します。</li>
</ul>
<div class="figure align-center" id="id74">
<img alt="_images/LabelledArrayCells_elementMerged.png" src="_images/LabelledArrayCells_elementMerged.png" />
<p class="caption"><span class="caption-number">図 - 3.6.7 </span><span class="caption-text">LabelledArrayCells(elementMerged)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// elementMerged=trueは初期値なので、省略可</span>
    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ラベル1&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="o">,</span>
            <span class="n">elementMerged</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">words</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id15">
<h3>3.6.7. 書き込み時に配列・リストのサイズが不足、または余分である場合<a class="headerlink" href="#id15" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>アノテーション <a class="reference internal" href="annotation_mapping_arrayoption.html#annotationxlsarrayoption"><span class="std std-ref">&#64;XlsArrayOption</span></a> を指定することで、書き込み時のセルの制御を指定することができます。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">overOperation</span></code> で、書き込み時にJavaオブジェクトの配列・リストのサイズに対して、属性 <code class="docutils literal notranslate"><span class="pre">size</span></code> の値が小さく、足りない場合の操作を指定します。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">remainedOperation</span></code> で、書き込み時にJavaオブジェクトの配列・リストのサイズに対して、属性 <code class="docutils literal notranslate"><span class="pre">size</span></code> の値が大きく、余っている場合の操作を指定します。</li>
</ul>
<div class="figure align-center" id="id75">
<img alt="_images/LabelledArrayCells_ArrayOption.png" src="_images/LabelledArrayCells_ArrayOption.png" />
<p class="caption"><span class="caption-number">図 - 3.6.8 </span><span class="caption-text">LabelledArrayCells(ArrayOption)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ふりがな&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="o">)</span>
    <span class="nd">@XlsArrayOption</span><span class="o">(</span><span class="n">overOperation</span><span class="o">=</span><span class="n">OverOperation</span><span class="o">.</span><span class="na">Error</span><span class="o">,</span> <span class="n">remainedOperation</span><span class="o">=</span><span class="n">RemainedOperation</span><span class="o">.</span><span class="na">Clear</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nameKana</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id16">
<h3>3.6.8. 位置情報／見出し情報を取得する際の注意事項<a class="headerlink" href="#id16" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>マッピング対象のセルのアドレスを取得する際に、フィールド <code class="docutils literal notranslate"><span class="pre">Map&lt;String,</span> <span class="pre">Point&gt;</span> <span class="pre">positions</span></code> を定義しておけば、自動的にアドレスがマッピングされます。</p>
<p>通常は、キーにはプロパティ名が記述（フィールドの場合はフィールド名）が入ります。</p>
<p>アノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsLabelledArrayCells</span></code> でマッピングしたセルのキーは、 <code class="docutils literal notranslate"><span class="pre">&lt;プロパティ名&gt;[&lt;インデックス&gt;]</span></code> の形式になります。
インデックスは、0から始まります。</p>
<p>同様に、マッピング対象の見出しを取得する、フィールド <code class="docutils literal notranslate"><span class="pre">Map&lt;String,</span> <span class="pre">String&gt;</span> <span class="pre">labels</span></code> へのアクセスも、キーは、 <code class="docutils literal notranslate"><span class="pre">&lt;プロパティ名&gt;[&lt;インデックス&gt;]</span></code> の形式になります。
ただし、見出し情報の場合は、全ての要素が同じ値になるため、従来通りの <code class="docutils literal notranslate"><span class="pre">&lt;プロパティ名&gt;</span></code> でも取得できます。</p>
<div class="figure align-center" id="id76">
<img alt="_images/LabelledArrayCells_positions.png" src="_images/LabelledArrayCells_positions.png" />
<p class="caption"><span class="caption-number">図 - 3.6.9 </span><span class="caption-text">LabelledArrayCells(positions/labels)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="c1">// 位置情報</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Point</span><span class="o">&gt;</span> <span class="n">positions</span><span class="o">;</span>

    <span class="c1">// 見出し情報</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">labels</span><span class="o">;</span>

    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;ふりがな&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nameKana</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// 位置情報・見出し情報へのアクセス</span>
<span class="n">SampleRecord</span> <span class="n">record</span> <span class="o">=</span> <span class="cm">/* レコードのインスタンスの取得 */</span><span class="o">;</span>

<span class="n">Point</span> <span class="n">position</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">positions</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;nameKana[2]&quot;</span><span class="o">);</span>

<span class="n">String</span> <span class="n">label</span> <span class="o">=</span> <span class="n">recrod</span><span class="o">.</span><span class="na">labeles</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;nameKana[2]&quot;</span><span class="o">);</span>

<span class="c1">// 見出し情報の場合、従来通りのインデックスなしでも取得できる</span>
<span class="n">String</span> <span class="n">label</span> <span class="o">=</span> <span class="n">recrod</span><span class="o">.</span><span class="na">labeles</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;nameKana&quot;</span><span class="o">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id17">
<h3>3.6.9. ラベルセルを正規表現、正規化して指定する場合<a class="headerlink" href="#id17" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>シートの構造は同じだが、ラベルのセルが微妙に異なる場合、ラベルセルを正規表現による指定が可能です。
また、空白や改行を除去してラベルセルを比較するように設定することも可能です。 <cite>[ver1.1+]</cite></p>
<ul class="simple">
<li>正規表現で指定する場合、アノテーションの属性の値を <code class="docutils literal notranslate"><span class="pre">/正規表現/</span></code> のように、スラッシュで囲み指定します。<ul>
<li>スラッシュで囲まない場合、通常の文字列として処理されます。</li>
<li>正規表現の指定機能を有効にするには、<a class="reference internal" href="configuration.html"><span class="doc">システム設定のプロパティ</span></a> <code class="docutils literal notranslate"><span class="pre">regexLabelText</span></code> の値を trueに設定します。</li>
</ul>
</li>
<li>ラベセルの値に改行が空白が入っている場合、それらを除去し、正規化してアノテーションの属性値と比較することが可能です。<ul>
<li>正規化とは、空白、改行、タブを除去することを指します。</li>
<li>ラベルを正規化する機能を有効にするには、<a class="reference internal" href="configuration.html"><span class="doc">システム設定のプロパティ</span></a> <code class="docutils literal notranslate"><span class="pre">normalizeLabelText</span></code> の値を trueに設定します。</li>
</ul>
</li>
</ul>
<p>これらの指定が可能な属性は、<code class="docutils literal notranslate"><span class="pre">label</span></code> , <code class="docutils literal notranslate"><span class="pre">headerLabel</span></code> です。</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// システム設定</span>
<span class="n">XlsMapper</span> <span class="n">xlsMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XlsMapper</span><span class="o">();</span>
<span class="n">xlsMapper</span><span class="o">.</span><span class="na">getConfiguration</span><span class="o">()</span>
        <span class="o">.</span><span class="na">setRegexLabelText</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>        <span class="c1">// ラベルを正規表現で指定可能にする機能を有効にする。</span>
        <span class="o">.</span><span class="na">setNormalizeLabelText</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>   <span class="c1">// ラベルを正規化して比較する機能を有効にする。</span>

<span class="c1">// シート用クラス</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// 正規表現による指定</span>
    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;/名前.+/&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">names</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlshorizontalrecords">
<span id="annotationxlshorizontalrecords"></span><h2>3.7. <code class="docutils literal notranslate"><span class="pre">&#64;XlsHorizontalRecords</span></code><a class="headerlink" href="#xlshorizontalrecords" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>水平方向に連続する行をCollection(List、Set)または配列にマッピングします。</p>
<p>標準では表には最上部に表の名称と列名を記述した行が必要になります。</p>
<div class="figure align-center" id="id77">
<img alt="_images/HorizontalRecord.png" src="_images/HorizontalRecord.png" />
<p class="caption"><span class="caption-number">図 - 3.7.1 </span><span class="caption-text">HorizontalRecords</span></p>
</div>
<p>シート用クラスに、アノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsHorizontalRecords</span></code> 使って定義し、属性tableLabelで表の名称を指定します。</p>
<p>Colelction(List, Set)型または配列のフィールドに付与します。
List型などの場合、Genericsのタイプとして、マッピング先のBeanクラスを指定します。
指定しない場合は、アノテーションの属性 <code class="docutils literal notranslate"><span class="pre">recordClass</span></code> でクラス型を指定します。</p>
<p>レコード用クラスは、列の定義をアノテーション <a class="reference internal" href="annotation_mapping_column.html#annotationxlscolumn"><span class="std std-ref">&#64;XlsColumn</span></a> や <a class="reference internal" href="annotation_mapping_mapcolumns.html#annotationxlsmapcolumns"><span class="std std-ref">&#64;XlsMapColumns</span></a> で指定します。
また、ツリー構造のように入れ子になったレコードをマッピングする場合は、 <a class="reference internal" href="annotation_mapping_nestedrecords.html#annotationxlsnestedrecords"><span class="std std-ref">&#64;XlsNestedRecords</span></a> を使用します。</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// シート用クラス</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// 通常は、Genericsでクラス型を指定します。</span>
    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;ユーザ一覧&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>

    <span class="c1">// Generics型を使用しない場合は、属性 recordClass で指定します。</span>
    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;ユーザ一覧&quot;</span><span class="o">,</span> <span class="n">recordClass</span><span class="o">=</span><span class="n">UserRecord</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span> <span class="n">record2</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// レコード用クラス</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<ul class="last simple">
<li>ver1.0から、Collection型(List型、Set型)にも対応しています。</li>
<li>インタフェースの型を指定する場合、次の実装クラスのインスタンスが設定されます。<ul>
<li>List型の場合、 <code class="docutils literal notranslate"><span class="pre">java.util.ArrayList</span></code> クラス。</li>
<li>Set型の場合、 <code class="docutils literal notranslate"><span class="pre">java.util.LinkedHashSet</span></code> クラス。</li>
<li>Collection型の場合、 <code class="docutils literal notranslate"><span class="pre">java.util.ArrayList</span></code> クラス。</li>
</ul>
</li>
<li>実装クラスを指定した場合、そのインスタンスが設定されます。</li>
</ul>
</div>
<div class="section" id="id18">
<h3>3.7.1. 表の開始位置の指定（表の名称がない場合）<a class="headerlink" href="#id18" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>表の名称がない場合、表の開始位置をインデックスやアドレスで指定します。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">headerColumn</span></code> 、 <code class="docutils literal notranslate"><span class="pre">headerRow</span></code> で表の開始位置をインデックスで指定します。<ul>
<li>headerColumnは列番号で、0から始まります。</li>
<li>headerRowは行番号で、0から始まります。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">headerAddress</span></code> で、 'B3'のようにシートのアドレス形式で指定もできます。<ul>
<li>属性headerAddressを指定する場合は、headerColumn, headerRowは指定しないでください。</li>
<li>属性headerAddressの両方を指定した場合、headerAddressの値が優先されます。</li>
</ul>
</li>
</ul>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// インデックス形式で表の開始位置を指定する(値は0から開始します)</span>
    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">headerColumn</span><span class="o">=</span><span class="mi">0</span><span class="o">,</span> <span class="n">headerRow</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">records1</span><span class="o">;</span>

    <span class="c1">// アドレス形式で表の開始位置を指定する場合</span>
    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">headerAddress</span><span class="o">=</span><span class="s">&quot;A2&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">records2</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id19">
<h3>3.7.2. 表の名称から開始位置が離れた場所にある場合<a class="headerlink" href="#id19" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>表の名称が定義してあるセルの直後に表がなく離れている場合、属性 <code class="docutils literal notranslate"><span class="pre">bottom</span></code> で表の開始位置がどれだけ離れているか指定します。</p>
<div class="figure align-center" id="id78">
<img alt="_images/HorizontalRecord_bottom.png" src="_images/HorizontalRecord_bottom.png" />
<p class="caption"><span class="caption-number">図 - 3.7.2 </span><span class="caption-text">HorizontalRecords(bottom)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;ユーザ一覧&quot;</span><span class="o">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">3</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id20">
<h3>3.7.3. 表の見出しが縦に結合されデータレコードの開始位置が離れた場所にある場合<a class="headerlink" href="#id20" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>表の見出しセルが縦に結合され、データレコードの開始位置が離れている場合、属性 <code class="docutils literal notranslate"><span class="pre">headerBottom</span></code> でデータレコードの開始位置がどれだけ離れているか指定します。 <cite>[ver1.1+]</cite></p>
<p>下記の例の場合、見出しの「テスト結果」は横に結合されているため <a class="reference internal" href="annotation_mapping_column.html#annotationxlscolumnheadermerged"><span class="std std-ref">&#64;XlsColumn(headerMerged=N)</span></a> と組み合わせて利用します。</p>
<div class="figure align-center" id="id79">
<img alt="_images/HorizontalRecord_headerBottom.png" src="_images/HorizontalRecord_headerBottom.png" />
<p class="caption"><span class="caption-number">図 - 3.7.3 </span><span class="caption-text">HorizontalRecords(headerBottom)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// シート用クラス</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// 見出しが縦に結合され、データのレコードの開始位置が離れている場合</span>
    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;クラス情報&quot;</span><span class="o">,</span> <span class="n">headerBottom</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">SampleRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// レコード用クラス</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;No.&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">no</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="c1">// セル「算数」のマッピング</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;テスト結果&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">sansu</span><span class="o">;</span>

    <span class="c1">// セル「国語」のマッピング</span>
    <span class="c1">// 結合されている見出しから離れている数を指定する</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;テスト結果&quot;</span><span class="o">,</span> <span class="n">headerMerged</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">kokugo</span><span class="o">;</span>

    <span class="c1">// セル「合計」のマッピング</span>
    <span class="c1">// 結合されている見出しから離れている数を指定する</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;テスト結果&quot;</span><span class="o">,</span> <span class="n">headerMerged</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">sum</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="terminal">
<h3>3.7.4. 表の終端の指定（属性terminal）<a class="headerlink" href="#terminal" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>デフォルトでは行に1つもデータが存在しない場合、その表の終端となります。
行の一番左側の列の罫線によってテーブルの終端を検出する方法もあります。
この場合は <code class="docutils literal notranslate"><span class="pre">&#64;XlsHorizontalRecords</span></code> の属性 <code class="docutils literal notranslate"><span class="pre">terminal</span></code> に <code class="docutils literal notranslate"><span class="pre">RecordTerminal.Border</span></code> を指定してください。</p>
<div class="figure align-center" id="id80">
<img alt="_images/HorizontalRecord_terminal.png" src="_images/HorizontalRecord_terminal.png" />
<p class="caption"><span class="caption-number">図 - 3.7.4 </span><span class="caption-text">HorizontalRecords(terminal)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;ユーザ一覧&quot;</span><span class="o">,</span> <span class="n">terminal</span><span class="o">=</span><span class="n">RecordTerminal</span><span class="o">.</span><span class="na">Border</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">書き込む際にはテンプレート用の表中のセルは空と記述しているため、属性 <code class="docutils literal notranslate"><span class="pre">terminal=RecordTermial.Empty</span></code> を指定していると処理が終了してしまいます。
そのため、強制的に <code class="docutils literal notranslate"><span class="pre">terminal=RecordTerminal.Border</span></code> に補正して処理するようにしています。<cite>[ver0.5+]</cite></p>
</div>
</div>
<div class="section" id="id21">
<h3>3.7.5. 空のレコードを読み飛ばす条件の指定<a class="headerlink" href="#id21" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>レコード用のクラスには、レコードを宇読み飛ばすかどうか判定するためのメソッド用意し、アノテーション <a class="reference internal" href="annotation_mapping_ignorable.html#annotationxlsignorable"><span class="std std-ref">&#64;XlsIgnorable</span></a> を付与します。</p>
<p>また、この属性は読み込み時のみに有効です。書き込み時は、空のレコードでもそのまま出力されます。</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// ルートのオブジェクト</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;シート名&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;ユーザ一覧&quot;</span><span class="o">,</span> <span class="n">terminal</span><span class="o">=</span><span class="n">RecordTerminal</span><span class="o">.</span><span class="na">Border</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">users</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// レコードのオブジェクト</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="c1">// レコードが空と判定するためのメソッド</span>
    <span class="nd">@XlsIgnorable</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>

        <span class="k">if</span><span class="o">(</span><span class="n">name</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span><span class="n">name</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="terminatelabel">
<h3>3.7.6. 表の終端の指定（属性terminateLabel）<a class="headerlink" href="#terminatelabel" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>表が他の表と連続しており属性terminalでBorder、Emptyのいずれを指定しても終端を検出できない場合があります。
このような場合は、属性 <code class="docutils literal notranslate"><span class="pre">terminateLabel</span></code> で終端を示すセルの文字列を指定します。</p>
<div class="figure align-center" id="id81">
<img alt="_images/HorizontalRecord_terminateLabel.png" src="_images/HorizontalRecord_terminateLabel.png" />
<p class="caption"><span class="caption-number">図 - 3.7.5 </span><span class="caption-text">HorizontalRecords(terminateLabel)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;クラス情報&quot;</span><span class="o">,</span> <span class="n">terminal</span><span class="o">=</span><span class="n">RecordTerminal</span><span class="o">.</span><span class="na">Border</span><span class="o">,</span>
            <span class="n">terminateLabel</span><span class="o">=</span><span class="s">&quot;平均&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">userRecords</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="headerlimit">
<h3>3.7.7. 表の見出しの走査の終了条件の指定(headerLimit)<a class="headerlink" href="#headerlimit" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>属性 <code class="docutils literal notranslate"><span class="pre">headerLimit</span></code> を指定すると、テーブルのカラムが指定数見つかったタイミングでExcelシートの走査を終了します。
主に無駄な走査を抑制したい場合に指定します。</p>
<p>例えば、<a class="reference internal" href="annotation_mapping_iteratetables.html#annotationxlsiteratetables"><span class="std std-ref">&#64;XlsIterateTables</span></a> において、
テーブルが隣接しており終端を検出できないときに、カラム数を明示的に指定してテーブルを区切りたい場合に使用します。</p>
<p>以下の例は、列の見出しセルを3つ分検出したところでそのテーブルの終端と見なします。</p>
<div class="figure align-center" id="id82">
<img alt="_images/HorizontalRecord_headerLimit.png" src="_images/HorizontalRecord_headerLimit.png" />
<p class="caption"><span class="caption-number">図 - 3.7.6 </span><span class="caption-text">HorizontalRecords(headerLimit)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;クラス情報&quot;</span><span class="o">,</span> <span class="n">terminal</span><span class="o">=</span><span class="n">RecordTerminal</span><span class="o">.</span><span class="na">Border</span><span class="o">,</span>
            <span class="n">headerLimit</span><span class="o">=</span><span class="mi">3</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>なお、セルが見つからなかった場合はエラーとなりますが、属性 <code class="docutils literal notranslate"><span class="pre">optional</span></code> にtrueを指定しておくと、無視して処理を続行します。</p>
</div>
<div class="section" id="id22">
<h3>3.7.8. 表の見出しに空白がある場合(range)<a class="headerlink" href="#id22" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>表の走査は、まず指定したタイトルなどの表の開始位置を元に、見出し用セルを取得し、その後、データのレコードを取得します。</p>
<p>見出し用セルを取得する際には、右方向に向かって検索をしますが、 <cite>通常は空白セルが見つかった時点で走査を終了</cite> します。</p>
<p>空白セルの次にも見出し用セルがあるような場合、属性 <code class="docutils literal notranslate"><span class="pre">range</span></code> を指定することで、指定した値分の空白セルを許容し、
さらに先のセルの検索を試みます。</p>
<p>また、属性 <code class="docutils literal notranslate"><span class="pre">headerAddress</span></code> や <code class="docutils literal notranslate"><span class="pre">tableLabel</span></code> で指定した位置から表が開始しないような場合も、
属性 <code class="docutils literal notranslate"><span class="pre">range</span></code> を指定することで、さらに先のセルの検索を試みます。</p>
<div class="figure align-center" id="id83">
<img alt="_images/HorizontalRecord_range.png" src="_images/HorizontalRecord_range.png" />
<p class="caption"><span class="caption-number">図 - 3.7.7 </span><span class="caption-text">HorizontalRecords(range)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;ユーザ一覧&quot;</span><span class="o">,</span> <span class="n">terminal</span><span class="o">=</span><span class="n">RecordTerminal</span><span class="o">.</span><span class="na">Border</span><span class="o">,</span>
            <span class="n">range</span><span class="o">=</span><span class="mi">3</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id23">
<h3>3.7.9. 書き込み時にレコードが不足、余分である場合の操作の指定<a class="headerlink" href="#id23" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>アノテーション <a class="reference internal" href="annotation_mapping_recordoption.html#annotationxlsrecordoption"><span class="std std-ref">&#64;XlsRecordOption</span></a> を指定することで、書き込み時のレコードの制御を指定することができます。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">overOperation</span></code> で、書き込み時にJavaオブジェクトのレコード数に対して、シートのレコード数が足りないときの操作を指定します。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">remainedOperation</span></code> で、書き込み時にJavaオブジェクトのレコード数に対して、シートのレコード数が余っているときの操作を指定します。</li>
</ul>
<div class="figure align-center" id="id84">
<img alt="_images/HorizontalRecord_RecordOption.png" src="_images/HorizontalRecord_RecordOption.png" />
<p class="caption"><span class="caption-number">図 - 3.7.8 </span><span class="caption-text">HorizontalRecords(RecordOption)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;ユーザ一覧&quot;</span><span class="o">)</span>
    <span class="nd">@XlsRecordOption</span><span class="o">(</span><span class="n">overOperation</span><span class="o">=</span><span class="n">OverOperation</span><span class="o">.</span><span class="na">Insert</span><span class="o">,</span> <span class="n">remainedOperation</span><span class="o">=</span><span class="n">RemainedOperation</span><span class="o">.</span><span class="na">Clear</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id24">
<h3>3.7.10. 任意の位置からレコードが開始するかを指定する場合<a class="headerlink" href="#id24" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>データレコードの途中で中見出しがあり、分割されているような表の場合、アノテーション <a class="reference internal" href="annotation_mapping_recordfinder.html#annotationxlsrecordfinder"><span class="std std-ref">&#64;XlsRecordFinder</span></a> で、レコードの開始位置を決める処理を指定することができます。 <cite>[ver2.0+]</cite></p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">value</span></code> で、レコードの開始位置を検索する実装クラスを指定します。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">args</span></code> で、レコードの開始位置を検索する実装クラスに渡す引数を指定します。</li>
</ul>
<div class="figure align-center" id="id85">
<img alt="_images/HorizontalRecord_RecordFinder.png" src="_images/HorizontalRecord_RecordFinder.png" />
<p class="caption"><span class="caption-number">図 - 3.7.9 </span><span class="caption-text">HorizontalRecords(RecordFinder)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// マッピングの定義</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsOrder</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;成績一覧&quot;</span><span class="o">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">terminal</span><span class="o">=</span><span class="n">RecordTerminal</span><span class="o">.</span><span class="na">Border</span><span class="o">,</span> <span class="n">terminateLabel</span><span class="o">=</span><span class="s">&quot;/クラス.+/&quot;</span><span class="o">)</span>
    <span class="nd">@XlsRecordFinder</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="n">ClassNameRecordFinder</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">=</span><span class="s">&quot;クラスA&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Record</span><span class="o">&gt;</span> <span class="n">classA</span><span class="o">;</span>

    <span class="nd">@XlsOrder</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;成績一覧&quot;</span><span class="o">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">terminal</span><span class="o">=</span><span class="n">RecordTerminal</span><span class="o">.</span><span class="na">Border</span><span class="o">,</span> <span class="n">terminateLabel</span><span class="o">=</span><span class="s">&quot;/クラス.+/&quot;</span><span class="o">)</span>
    <span class="nd">@XlsRecordFinder</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="n">ClassNameRecordFinder</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">=</span><span class="s">&quot;クラスB&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Record</span><span class="o">&gt;</span> <span class="n">classB</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// クラス用の見出しのレコードを探すクラス</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClassNameRecordFinder</span> <span class="kd">implements</span> <span class="n">RecordFinder</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">CellPosition</span> <span class="nf">find</span><span class="o">(</span><span class="n">ProcessCase</span> <span class="n">processCase</span><span class="o">,</span> <span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">,</span> <span class="n">Sheet</span> <span class="n">sheet</span><span class="o">,</span>
            <span class="n">CellPosition</span> <span class="n">initAddress</span><span class="o">,</span> <span class="n">Object</span> <span class="n">beanObj</span><span class="o">,</span> <span class="n">Configuration</span> <span class="n">config</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">// 実装は省略</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id25">
<h3>3.7.11. 表の名称を正規表現、正規化して指定する場合<a class="headerlink" href="#id25" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>シートの構造は同じだが、ラベルのセルが微妙に異なる場合、ラベルセルを正規表現による指定が可能です。
また、空白や改行を除去してラベルセルを比較するように設定することも可能です。 <cite>[ver1.1+]</cite></p>
<ul class="simple">
<li>正規表現で指定する場合、アノテーションの属性の値を <code class="docutils literal notranslate"><span class="pre">/正規表現/</span></code> のように、スラッシュで囲み指定します。<ul>
<li>スラッシュで囲まない場合、通常の文字列として処理されます。</li>
<li>正規表現の指定機能を有効にするには、<a class="reference internal" href="configuration.html"><span class="doc">システム設定のプロパティ</span></a> <code class="docutils literal notranslate"><span class="pre">regexLabelText</span></code> の値を trueに設定します。</li>
</ul>
</li>
<li>ラベセルの値に改行が空白が入っている場合、それらを除去し正規化してアノテーションの属性値と比較することが可能です。<ul>
<li>正規化とは、空白、改行、タブを除去することを指します。</li>
<li>ラベルを正規化する機能を有効にするには、<a class="reference internal" href="configuration.html"><span class="doc">システム設定のプロパティ</span></a> <code class="docutils literal notranslate"><span class="pre">normalizeLabelText</span></code> の値を trueに設定します。</li>
</ul>
</li>
</ul>
<p>これらの指定が可能な属性は、<code class="docutils literal notranslate"><span class="pre">tableLabel</span></code> , <code class="docutils literal notranslate"><span class="pre">terminateLabel</span></code> です。
さらに、レコードの列の見出し <a class="reference internal" href="annotation_mapping_column.html#annotationxlscolumn"><span class="std std-ref">&#64;XlsColumn</span></a> も、この機能が有効になります。</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// システム設定</span>
<span class="n">XlsMapper</span> <span class="n">xlsMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XlsMapper</span><span class="o">();</span>
<span class="n">xlsMapper</span><span class="o">.</span><span class="na">getConfiguration</span><span class="o">()</span>
        <span class="o">.</span><span class="na">setRegexLabelText</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>        <span class="c1">// ラベルを正規表現で指定可能にする機能を有効にする。</span>
        <span class="o">.</span><span class="na">setNormalizeLabelText</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>   <span class="c1">// ラベルを正規化して比較する機能を有効にする。</span>

<span class="c1">// シート用クラス</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// 正規表現による指定</span>
    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;/ユーザ一覧.+/&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlsverticalrecords">
<span id="annotationxlsverticalrecords"></span><h2>3.8. <code class="docutils literal notranslate"><span class="pre">&#64;XlsVerticalRecords</span></code><a class="headerlink" href="#xlsverticalrecords" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>垂直方向に連続する列をListまたは配列にマッピングします。
要するに <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> を垂直方向にしたものです。</p>
<p>メソッドに定義する場合、<a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> と同じくList型の引数を1つだけ取るsetterメソッドに対して付与します。</p>
<p>ここでは、アノテーション <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> と異なる部分を説明します。
共通の使い方は、アノテーション <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> の説明を参照してください。</p>
<div class="figure align-center" id="id86">
<img alt="_images/VerticalRecord.png" src="_images/VerticalRecord.png" />
<p class="caption"><span class="caption-number">図 - 3.8.1 </span><span class="caption-text">VerticalRecords</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// シート用クラス</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Weather&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsVerticalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;天気情報&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">WeatherRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// レコード用クラス</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WeatherRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;時間&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">time</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;降水&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">precipitation</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id26">
<h3>3.8.1. 表の名称位置の指定<a class="headerlink" href="#id26" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>実際に表を作る場合、垂直方向ですが表の名称は上方に設定することが一般的です。
そのような場合、属性 <code class="docutils literal notranslate"><span class="pre">tableLabelAbove</span></code> の値を <code class="docutils literal notranslate"><span class="pre">true</span></code> に設定すると表のタイトルが上方に位置するとして処理します。 <cite>[ver1.0+]</cite></p>
<div class="figure align-center" id="id87">
<img alt="_images/VerticalRecord_tableLabelAbove.png" src="_images/VerticalRecord_tableLabelAbove.png" />
<p class="caption"><span class="caption-number">図 - 3.8.2 </span><span class="caption-text">VerticalRecords（tableLabelAbove）</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsVerticalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;天気情報&quot;</span><span class="o">,</span> <span class="n">tableLabelAbove</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">WeatherRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="right">
<h3>3.8.2. 表の名称から開始位置が離れた場所にある場合(right)<a class="headerlink" href="#right" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>表の名称が定義してあるセルの直後に表がなく離れている場合、属性 <code class="docutils literal notranslate"><span class="pre">right</span></code> で表の開始位置が <strong>右方向</strong> にどれだけ離れているか指定します。 <cite>[ver1.0]+</cite></p>
<p>アノテーション <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> の属性 <code class="docutils literal notranslate"><span class="pre">bottom</span></code> と同じような意味になります。</p>
<div class="figure align-center" id="id88">
<img alt="_images/VerticalRecord_right.png" src="_images/VerticalRecord_right.png" />
<p class="caption"><span class="caption-number">図 - 3.8.3 </span><span class="caption-text">VerticalRecords（right）</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsVerticalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;天気情報&quot;</span><span class="o">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">3</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">WeatherRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="bottom">
<h3>3.8.3. 表の名称から開始位置が離れた場所にある場合(bottom)<a class="headerlink" href="#bottom" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>属性 <code class="docutils literal notranslate"><span class="pre">tableLabelAbove</span></code> の値が <code class="docutils literal notranslate"><span class="pre">true</span></code> のときのみ有効になります。
表の名称がセルの直後に表がなく離れている場合、属性 <code class="docutils literal notranslate"><span class="pre">bottom</span></code> で表の開始位置が <strong>下方向</strong> にどれだけ離れているか指定します。 <cite>[ver2.0]+</cite></p>
<p>アノテーション <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> の属性 <code class="docutils literal notranslate"><span class="pre">bottom</span></code> と同じような意味になります。</p>
<div class="figure align-center" id="id89">
<img alt="_images/VerticalRecord_bottom.png" src="_images/VerticalRecord_bottom.png" />
<p class="caption"><span class="caption-number">図 - 3.8.4 </span><span class="caption-text">VerticalRecords（bottom）</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsVerticalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;天気情報&quot;</span><span class="o">,</span> <span class="n">tableLabelAbove</span><span class="o">=</span><span class="kc">true</span><span class="o">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">3</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">WeatherRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id27">
<h3>3.8.4. 表の見出しが横に結合されデータレコードの開始位置が離れた場所にある場合<a class="headerlink" href="#id27" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>表の見出しセルが横に結合され、データレコードの開始位置が離れている場合、属性 <code class="docutils literal notranslate"><span class="pre">headerRight</span></code> でデータレコードの開始位置がどれだけ離れているか指定します。 <cite>[ver1.1+]</cite></p>
<p>アノテーション <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> の属性 <code class="docutils literal notranslate"><span class="pre">headerBottom</span></code> と同じような意味になります。</p>
<p>下記の例の場合、見出しの「テスト結果」は横に結合されているため <a class="reference internal" href="annotation_mapping_column.html#annotationxlscolumnheadermerged"><span class="std std-ref">&#64;XlsColumn(headerMerged=N)</span></a> と組み合わせて利用します。</p>
<div class="figure align-center" id="id90">
<img alt="_images/VerticalRecord_headerRight.png" src="_images/VerticalRecord_headerRight.png" />
<p class="caption"><span class="caption-number">図 - 3.8.5 </span><span class="caption-text">VerticalRecords(headerRight)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// シート用クラス</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Weather&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// 見出しが横に結合され、データのレコードの開始位置が離れている場合</span>
    <span class="nd">@XlsVerticalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;天気情報&quot;</span><span class="o">,</span> <span class="n">headerRight</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">WeatherRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// レコード用クラス</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WeatherRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;時間&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">time</span><span class="o">;</span>

    <span class="c1">// セル「降水」のマッピング</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;測定結果&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">precipitation</span><span class="o">;</span>

    <span class="c1">// セル「気温」のマッピング</span>
    <span class="c1">// 結合されている見出しから離れている数を指定する</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;測定結果&quot;</span><span class="o">,</span> <span class="n">headerMerged</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">temperature</span><span class="o">;</span>

    <span class="c1">// セル「天気」のマッピング</span>
    <span class="c1">// 結合されている見出しから離れている数を指定する</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;測定結果&quot;</span><span class="o">,</span> <span class="n">headerMerged</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">wather</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id28">
<h3>3.8.5. 書き込み時にレコードが不足、余分である場合の操作の指定<a class="headerlink" href="#id28" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>アノテーション <a class="reference internal" href="annotation_mapping_recordoption.html#annotationxlsrecordoption"><span class="std std-ref">&#64;XlsRecordOption</span></a> を指定することで、書き込み時のレコードの制御を指定することができます。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">overOperation</span></code> で、書き込み時にJavaオブジェクトのレコード数に対して、シートのレコード数が足りないときの操作を指定します。<ul>
<li>ただし、 <code class="docutils literal notranslate"><span class="pre">&#64;XlsVerticalRecords</span></code> の場合、列の挿入を行う <code class="docutils literal notranslate"><span class="pre">OverOperation#Insert</span></code> は使用できません。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">remainedOperation</span></code> で、書き込み時にJavaオブジェクトのレコード数に対して、シートのレコード数が余っているときの操作を指定します。<ul>
<li>ただし、 <code class="docutils literal notranslate"><span class="pre">&#64;XlsVerticalRecords</span></code> の場合、列の削除を行う <code class="docutils literal notranslate"><span class="pre">RemainedOperation#Delete</span></code> は使用できません。</li>
</ul>
</li>
</ul>
<div class="figure align-center" id="id91">
<img alt="_images/VerticalRecord_RecordOption.png" src="_images/VerticalRecord_RecordOption.png" />
<p class="caption"><span class="caption-number">図 - 3.8.6 </span><span class="caption-text">VerticalRecords(RecordOption)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsVerticalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;天気情報&quot;</span><span class="o">)</span>
    <span class="nd">@XlsRecordOption</span><span class="o">(</span><span class="n">overOperation</span><span class="o">=</span><span class="n">OverOperation</span><span class="o">.</span><span class="na">Copy</span><span class="o">,</span> <span class="n">remainedOperation</span><span class="o">=</span><span class="n">RemainedOperation</span><span class="o">.</span><span class="na">Clear</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">WeatherRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id29">
<h3>3.8.6. 任意の位置からレコードが開始するかを指定する場合<a class="headerlink" href="#id29" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>データレコードの途中で中見出しがあり、分割されているような表の場合、アノテーション <a class="reference internal" href="annotation_mapping_recordfinder.html#annotationxlsrecordfinder"><span class="std std-ref">&#64;XlsRecordFinder</span></a> で、レコードの開始位置を決める処理を指定することができます。 <cite>[ver2.0+]</cite></p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">value</span></code> で、レコードの開始位置を検索する実装クラスを指定します。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">args</span></code> で、レコードの開始位置を検索する実装クラスに渡す引数を指定します。</li>
</ul>
<div class="figure align-center" id="id92">
<img alt="_images/VerticalRecord_RecordFinder.png" src="_images/VerticalRecord_RecordFinder.png" />
<p class="caption"><span class="caption-number">図 - 3.8.7 </span><span class="caption-text">VerticalRecords(RecordFinder)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// マッピングの定義</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Weather&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsOrder</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="nd">@XlsVerticalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;天気情報&quot;</span><span class="o">,</span> <span class="n">tableLabelAbove</span><span class="o">=</span><span class="kc">true</span><span class="o">,</span> <span class="n">terminal</span><span class="o">=</span><span class="n">RecordTerminal</span><span class="o">.</span><span class="na">Border</span><span class="o">,</span> <span class="n">terminateLabel</span><span class="o">=</span><span class="s">&quot;/{0-9}月{0-9}[1-2]日/&quot;</span><span class="o">)</span>
    <span class="nd">@XlsRecordFinder</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="n">DateRecordFinder</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">=</span><span class="s">&quot;2月1日&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">WeatherRecord</span><span class="o">&gt;</span> <span class="n">date1</span><span class="o">;</span>

    <span class="nd">@XlsOrder</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
    <span class="nd">@XlsVerticalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;天気情報&quot;</span><span class="o">,</span> <span class="n">tableLabelAbove</span><span class="o">=</span><span class="kc">true</span><span class="o">,</span> <span class="n">terminal</span><span class="o">=</span><span class="n">RecordTerminal</span><span class="o">.</span><span class="na">Border</span><span class="o">,</span> <span class="n">terminateLabel</span><span class="o">=</span><span class="s">&quot;/{0-9}月{0-9}[1-2]日/&quot;</span><span class="o">)</span>
    <span class="nd">@XlsRecordFinder</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="n">DateRecordFinder</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">=</span><span class="s">&quot;2月1日&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">WeatherRecord</span><span class="o">&gt;</span> <span class="n">date2</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// 日にち用の見出しのレコードを探すクラス</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DateRecordFinder</span> <span class="kd">implements</span> <span class="n">RecordFinder</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">CellPosition</span> <span class="nf">find</span><span class="o">(</span><span class="n">ProcessCase</span> <span class="n">processCase</span><span class="o">,</span> <span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">,</span> <span class="n">Sheet</span> <span class="n">sheet</span><span class="o">,</span>
            <span class="n">CellPosition</span> <span class="n">initAddress</span><span class="o">,</span> <span class="n">Object</span> <span class="n">beanObj</span><span class="o">,</span> <span class="n">Configuration</span> <span class="n">config</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">// 実装は省略</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlscolumn">
<span id="annotationxlscolumn"></span><h2>3.9. <code class="docutils literal notranslate"><span class="pre">&#64;XlsColumn</span></code><a class="headerlink" href="#xlscolumn" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>アノテーション <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> または <a class="reference internal" href="annotation_mapping_verticalrecords.html#annotationxlsverticalrecords"><span class="std std-ref">&#64;XlsVerticalRecords</span></a> において、
1つのカラムをマッピングします。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">columnName</span></code> で、見出しとなるセルのラベルを指定します。</li>
<li>セルが見つからない場合はエラーとなりますが、属性 <code class="docutils literal notranslate"><span class="pre">optional</span></code> を <code class="docutils literal notranslate"><span class="pre">true</span></code> とすることで無視して処理を続行します。</li>
</ul>
<div class="figure align-center" id="id93">
<img alt="_images/Column.png" src="_images/Column.png" />
<p class="caption"><span class="caption-number">図 - 3.9.1 </span><span class="caption-text">Column</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)}</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="c1">// 存在しない列の場合は読み飛ばす</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;備考&quot;</span><span class="o">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id30">
<h3>3.9.1. データの列が結合されている場合<a class="headerlink" href="#id30" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>同じ値がグループごとに結合されているカラムの場合は属性 <code class="docutils literal notranslate"><span class="pre">merged</span></code> をtrueに設定します。
こうしておくと、前の列の値が引き継がれて設定されます。</p>
<div class="figure align-center" id="id94">
<img alt="_images/Column_merged.png" src="_images/Column_merged.png" />
<p class="caption"><span class="caption-number">図 - 3.9.2 </span><span class="caption-text">Column(merged)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="c1">// 結合されてる可能性がある列</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;クラス&quot;</span><span class="o">,</span> <span class="n">merged</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">className</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">書き込みに時では、属性mergedの値が true であっても、上部または左側のセルと値が同じでも結合は基本的に行いません。
ただし、システム設定 <code class="docutils literal notranslate"><span class="pre">Configuration</span></code> の項目「mergeCellOnSave」の値をtrueにすると結合されます。</p>
</div>
</div>
<div class="section" id="annotationxlscolumnheadermerged">
<span id="id31"></span><h3>3.9.2. 見出し行が結合されている場合<a class="headerlink" href="#annotationxlscolumnheadermerged" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>見出し行が結合され、1つの見出しに対して複数の列が存在する場合は属性 <code class="docutils literal notranslate"><span class="pre">headerMerged</span></code> を使用します。</p>
<p>属性headerMergedの値には列見出しから何セル分離れているかを指定します。</p>
<p>属性columnNameで指定する見出しのセル名は、結合されているセルと同じ値を指定します。</p>
<div class="figure align-center" id="id95">
<img alt="_images/Column_headerMerged.png" src="_images/Column_headerMerged.png" />
<p class="caption"><span class="caption-number">図 - 3.9.3 </span><span class="caption-text">Column(headerMerged)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;連絡先&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">mailAddress</span><span class="o">;</span>

    <span class="c1">// 結合されている見出しから離れている数を指定する</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;連絡先&quot;</span><span class="o">,</span> <span class="n">headerMerged</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">tel</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id32">
<h3>3.9.3. 見出しを正規表現、正規化して指定する場合<a class="headerlink" href="#id32" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>シートの構造は同じだが、ラベルのセルが微妙に異なる場合、ラベルセルを正規表現による指定が可能です。
また、空白や改行を除去してラベルセルを比較するように設定することも可能です。 <cite>[ver1.1+]</cite></p>
<ul class="simple">
<li>正規表現で指定する場合、アノテーションの属性の値を <code class="docutils literal notranslate"><span class="pre">/正規表現/</span></code> のように、スラッシュで囲み指定します。<ul>
<li>スラッシュで囲まない場合、通常の文字列として処理されます。</li>
<li>正規表現の指定機能を有効にするには、<a class="reference internal" href="configuration.html"><span class="doc">システム設定のプロパティ</span></a> <code class="docutils literal notranslate"><span class="pre">regexLabelText</span></code> の値を trueに設定します。</li>
</ul>
</li>
<li>ラベセルの値に改行が空白が入っている場合、それらを除去し、正規化してアノテーションの属性値と比較することが可能です。<ul>
<li>正規化とは、空白、改行、タブを除去することを指します。</li>
<li>ラベルを正規化する機能を有効にするには、システム設定のプロパティ <code class="docutils literal notranslate"><span class="pre">normalizeLabelText</span></code> の値を trueに設定します。</li>
</ul>
</li>
</ul>
<p>これらの指定が可能な属性は、<code class="docutils literal notranslate"><span class="pre">columnName</span></code> です。</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// システム設定</span>
<span class="n">XlsMapper</span> <span class="n">xlsMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XlsMapper</span><span class="o">();</span>
<span class="n">xlsMapper</span><span class="o">.</span><span class="na">getConfiguration</span><span class="o">()</span>
        <span class="o">.</span><span class="na">setRegexLabelText</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>        <span class="c1">// ラベルを正規表現で指定可能にする機能を有効にする。</span>
        <span class="o">.</span><span class="na">setNormalizeLabelText</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>   <span class="c1">// ラベルを正規化して比較する機能を有効にする。</span>

<span class="c1">// レコード用クラス</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="c1">// 正規表現による指定</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;/名前.+/&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlsmapcolumns">
<span id="annotationxlsmapcolumns"></span><h2>3.10. <code class="docutils literal notranslate"><span class="pre">&#64;XlsMapColumns</span></code><a class="headerlink" href="#xlsmapcolumns" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>アノテーション <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> もしくは <a class="reference internal" href="annotation_mapping_verticalrecords.html#annotationxlsverticalrecords"><span class="std std-ref">&#64;XlsVerticalRecords</span></a> において、
指定されたレコード用クラスのカラム数が可変の場合に、それらのカラムを <code class="docutils literal notranslate"><span class="pre">java.util.Map</span></code> として設定します。</p>
<ul class="simple">
<li>BeanにはMapを引数に取るフィールドまたはメソッドを用意し、このアノテーションを記述します。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">previousColumnName</span></code> で、指定された次のカラム以降、カラム名をキーとしたMapが生成され、Beanにセットされます。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">optional</span></code> で、見出しとなるセルが見つからない場合に無視するかどうかを指定しできます。 <cite>[ver2.0+]</cite></li>
</ul>
<div class="figure align-center" id="id96">
<img alt="_images/MapColumns.png" src="_images/MapColumns.png" />
<p class="caption"><span class="caption-number">図 - 3.10.1 </span><span class="caption-text">MapColumns</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@XlsMapColumns</span><span class="o">(</span><span class="n">previousColumnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">attendedMap</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id33">
<h3>3.10.1. 終了条件のセルを指定する場合<a class="headerlink" href="#id33" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>属性 <code class="docutils literal notranslate"><span class="pre">nextColumnName</span></code> で、指定した前のカラムまでが処理対象となり、マッピングの終了条件を指定することができます。 <cite>[ver1.2+]</cite></p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">optional</span></code> で、見出しとなるセルが見つからない場合に無視するかどうかを指定しできます。 <cite>[ver2.0+]</cite></li>
</ul>
<div class="figure align-center" id="id97">
<img alt="_images/MapColumns_nextColumnName.png" src="_images/MapColumns_nextColumnName.png" />
<p class="caption"><span class="caption-number">図 - 3.10.2 </span><span class="caption-text">MapColumns(nextColumnName)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@XlsMapColumns</span><span class="o">(</span><span class="n">previousColumnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">,</span> <span class="n">nextColumnName</span><span class="o">=</span><span class="s">&quot;備考&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">attendedMap</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;備考&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">comment</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id34">
<h3>3.10.2. 型変換する場合<a class="headerlink" href="#id34" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>アノテーション <a class="reference internal" href="annotation_converter_custom.html#annotationxlsconverter"><span class="std std-ref">&#64;XlsConverter</span></a> などで型変換を適用するときは、Mapの値が変換対象となります。
マップのキーは必ずString型を指定してください。</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="c1">// 型変換用のアノテーションを指定した場合、Mapの値に適用されます。</span>
    <span class="nd">@XlsMapColumns</span><span class="o">(</span><span class="n">previousColumnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="nd">@XlsBooleanConverter</span><span class="o">(</span><span class="n">loadForTrue</span><span class="o">={</span><span class="s">&quot;出席&quot;</span><span class="o">},</span> <span class="n">loadForFalse</span><span class="o">={</span><span class="s">&quot;欠席&quot;</span><span class="o">},</span>
            <span class="n">saveAsTrue</span><span class="o">=</span><span class="s">&quot;出席&quot;</span><span class="o">,</span> <span class="n">saveAsFalse</span><span class="s">&quot;欠席&quot;</span>
            <span class="n">failToFalse</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">attendedMap</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id35">
<h3>3.10.3. 位置情報／見出し情報を取得する際の注意事項<a class="headerlink" href="#id35" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>マッピング対象のセルのアドレスを取得する際に、フィールド <code class="docutils literal notranslate"><span class="pre">Map&lt;String,</span> <span class="pre">Point&gt;</span> <span class="pre">positions</span></code> を定義しておけば、自動的にアドレスがマッピングされます。</p>
<p>通常は、キーにはプロパティ名が記述（フィールドの場合はフィールド名）が入ります。</p>
<p>アノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsMapColumns</span></code> でマッピングしたセルのキーは、 <code class="docutils literal notranslate"><span class="pre">&lt;プロパティ名&gt;[&lt;セルの見出し&gt;]</span></code> の形式になります。</p>
<p>同様に、マッピング対象の見出しを取得する、フィールド <code class="docutils literal notranslate"><span class="pre">Map&lt;String,</span> <span class="pre">String&gt;</span> <span class="pre">labels</span></code> へのアクセスも、
キーは、 <code class="docutils literal notranslate"><span class="pre">&lt;プロパティ名&gt;[&lt;セルの見出し&gt;]</span></code> の形式になります。</p>
<div class="figure align-center" id="id98">
<img alt="_images/MapColumns_positions.png" src="_images/MapColumns_positions.png" />
<p class="caption"><span class="caption-number">図 - 3.10.3 </span><span class="caption-text">MapColumns(positions/labels)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="c1">// 位置情報</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Point</span><span class="o">&gt;</span> <span class="n">positions</span><span class="o">;</span>

    <span class="c1">// 見出し情報</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">labels</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@XlsMapColumns</span><span class="o">(</span><span class="n">previousColumnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">attendedMap</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// 位置情報・見出し情報へのアクセス</span>
<span class="n">SampleRecord</span> <span class="n">record</span> <span class="o">=</span> <span class="cm">/* レコードのインスタンスの取得 */</span><span class="o">;</span>

<span class="n">Point</span> <span class="n">position</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">positions</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;attendedMap[4月2日]&quot;</span><span class="o">);</span>

<span class="n">String</span> <span class="n">label</span> <span class="o">=</span> <span class="n">recrod</span><span class="o">.</span><span class="na">labeles</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;attendedMap[4月2日]&quot;</span><span class="o">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id36">
<h3>3.10.4. 見出しを正規表現、正規化して指定する場合<a class="headerlink" href="#id36" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>シートの構造は同じだが、ラベルのセルが微妙に異なる場合、ラベルセルを正規表現による指定が可能です。
また、空白や改行を除去してラベルセルを比較するように設定することも可能です。 <cite>[ver1.1+]</cite></p>
<ul class="simple">
<li>正規表現で指定する場合、アノテーションの属性の値を <code class="docutils literal notranslate"><span class="pre">/正規表現/</span></code> のように、スラッシュで囲み指定します。<ul>
<li>スラッシュで囲まない場合、通常の文字列として処理されます。</li>
<li>正規表現の指定機能を有効にするには、<a class="reference internal" href="configuration.html"><span class="doc">システム設定のプロパティ</span></a> <code class="docutils literal notranslate"><span class="pre">regexLabelText</span></code> の値を trueに設定します。</li>
</ul>
</li>
<li>ラベセルの値に改行が空白が入っている場合、それらを除去し、正規化してアノテーションの属性値と比較することが可能です。<ul>
<li>正規化とは、空白、改行、タブを除去することを指します。</li>
<li>ラベルを正規化する機能を有効にするには、<a class="reference internal" href="configuration.html"><span class="doc">システム設定のプロパティ</span></a> <code class="docutils literal notranslate"><span class="pre">normalizeLabelText</span></code> の値を trueに設定します。</li>
</ul>
</li>
</ul>
<p>これらの指定が可能な属性は、<code class="docutils literal notranslate"><span class="pre">previousColumnName</span></code> 、<code class="docutils literal notranslate"><span class="pre">nextColumnName</span></code> です。</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// システム設定</span>
<span class="n">XlsMapper</span> <span class="n">xlsMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XlsMapper</span><span class="o">();</span>
<span class="n">xlsMapper</span><span class="o">.</span><span class="na">getConfiguration</span><span class="o">()</span>
        <span class="o">.</span><span class="na">setRegexLabelText</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>        <span class="c1">// ラベルを正規表現で指定可能にする機能を有効にする。</span>
        <span class="o">.</span><span class="na">setNormalizeLabelText</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>   <span class="c1">// ラベルを正規化して比較する機能を有効にする。</span>

<span class="c1">// レコード用クラス</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="c1">// 正規表現による指定</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;/名前.+/&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="c1">// 正規表現による指定</span>
    <span class="nd">@XlsMapColumns</span><span class="o">(</span><span class="n">previousColumnName</span><span class="o">=</span><span class="s">&quot;/名前.+/&quot;</span><span class="o">,</span> <span class="n">nextColumnName</span><span class="o">=</span><span class="s">&quot;/備考.+/&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">attendedMap</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;/備考.+/&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">comment</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id37">
<h3>3.10.5. 書き込み前に動的にテンプレートファイルを書き換える<a class="headerlink" href="#id37" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>書き込み処理の場合、マップのキーがデータごとに異なり、テンプレートのフォーマットと合わない場合があります。</p>
<p>そのような場合、テンプレートファイルを書き込むデータに合わせて書き換えます。
その際には、 <a class="reference internal" href="annotation_lifecycle.html"><span class="doc">ライフサイクル・コールバック用のアノテーション</span></a> <code class="docutils literal notranslate"><span class="pre">&#64;XlsPreSave</span></code> で、実装を行うことができます。</p>
<p>実装処理は、Apache POIのAPIを使って行います。。</p>
<div class="figure align-center" id="id99">
<img alt="_images/MapColumns_preSave.png" src="_images/MapColumns_preSave.png" />
<p class="caption"><span class="caption-number">図 - 3.10.4 </span><span class="caption-text">MapColumns(preSave)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// シート用クラス</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;List&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;ユーザ一覧&quot;</span><span class="o">)</span>
    <span class="nd">@XlsRecordOption</span><span class="o">(</span><span class="n">overOperation</span><span class="o">=</span><span class="n">OverOperation</span><span class="o">.</span><span class="na">Insert</span><span class="o">)</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">SampleRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>

    <span class="c1">// XlsMapColumnsのマッピング用のセルを作成する</span>
    <span class="nd">@XlsPreSave</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onPreSave</span><span class="o">(</span><span class="kd">final</span> <span class="n">Sheet</span> <span class="n">sheet</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Configuration</span> <span class="n">config</span><span class="o">)</span> <span class="o">{</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="kd">final</span> <span class="n">Workbook</span> <span class="n">workbook</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="na">getWorkbook</span><span class="o">();</span>

            <span class="c1">// 基準となる日付のセル[日付]を取得する</span>
            <span class="n">Cell</span> <span class="n">baseHeaderCell</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="n">sheet</span><span class="o">,</span> <span class="s">&quot;[日付]&quot;</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">config</span><span class="o">);</span>

            <span class="c1">// 書き換えるための見出しの値の取得</span>
            <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">dateHeaders</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">records</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">attendedMap</span><span class="o">.</span><span class="na">keySet</span><span class="o">());</span>

            <span class="c1">// 1つ目の見出しの書き換え</span>
            <span class="n">baseHeaderCell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">dateHeaders</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">));</span>

            <span class="c1">// ２つ目以降の見出し列の追加</span>
            <span class="n">Row</span> <span class="n">headerRow</span> <span class="o">=</span> <span class="n">baseHeaderCell</span><span class="o">.</span><span class="na">getRow</span><span class="o">();</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">dateHeaders</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">Cell</span> <span class="n">headerCell</span> <span class="o">=</span> <span class="n">headerRow</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="n">baseHeaderCell</span><span class="o">.</span><span class="na">getColumnIndex</span><span class="o">()</span> <span class="o">+</span> <span class="n">i</span><span class="o">);</span>

                <span class="n">CellStyle</span> <span class="n">style</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="na">createCellStyle</span><span class="o">();</span>
                <span class="n">style</span><span class="o">.</span><span class="na">cloneStyleFrom</span><span class="o">(</span><span class="n">baseHeaderCell</span><span class="o">.</span><span class="na">getCellStyle</span><span class="o">());</span>
                <span class="n">headerCell</span><span class="o">.</span><span class="na">setCellStyle</span><span class="o">(</span><span class="n">style</span><span class="o">);</span>
                <span class="n">headerCell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">dateHeaders</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>

            <span class="o">}</span>

            <span class="c1">// 2つめ以降のデータ行の列の追加</span>
            <span class="n">Row</span> <span class="n">valueRow</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="na">getRow</span><span class="o">(</span><span class="n">baseHeaderCell</span><span class="o">.</span><span class="na">getRowIndex</span><span class="o">()</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
            <span class="n">Cell</span> <span class="n">baseValueCell</span> <span class="o">=</span> <span class="n">valueRow</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="n">baseHeaderCell</span><span class="o">.</span><span class="na">getColumnIndex</span><span class="o">());</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">dateHeaders</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">Cell</span> <span class="n">valueCell</span> <span class="o">=</span> <span class="n">valueRow</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="n">baseValueCell</span><span class="o">.</span><span class="na">getColumnIndex</span><span class="o">()</span> <span class="o">+</span> <span class="n">i</span><span class="o">);</span>

                <span class="n">CellStyle</span> <span class="n">style</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="na">createCellStyle</span><span class="o">();</span>
                <span class="n">style</span><span class="o">.</span><span class="na">cloneStyleFrom</span><span class="o">(</span><span class="n">baseValueCell</span><span class="o">.</span><span class="na">getCellStyle</span><span class="o">());</span>
                <span class="n">valueCell</span><span class="o">.</span><span class="na">setCellStyle</span><span class="o">(</span><span class="n">style</span><span class="o">);</span>

            <span class="o">}</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>

    <span class="o">}</span>

<span class="o">}</span>

<span class="c1">// レコード用クラス</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="c1">// 可変長のセルのマッピング</span>
    <span class="nd">@XlsMapColumns</span><span class="o">(</span><span class="n">previousColumnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">attendedMap</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlsarraycolumns">
<span id="annotationxlsarraycolumns"></span><h2>3.11. <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayColumns</span></code><a class="headerlink" href="#xlsarraycolumns" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>アノテーション <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> もしくは <a class="reference internal" href="annotation_mapping_verticalrecords.html#annotationxlsverticalrecords"><span class="std std-ref">&#64;XlsVerticalRecords</span></a> において、
指隣接する連続したカラムカラムを、Collection(List, Set)または配列にマッピングします。 <cite>[ver.2.0+]</cite></p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">columnName</span></code> で、見出しとなるセルのラベルを指定します。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">size</span></code> で、連続するセルの個数を指定します。<ul>
<li>見出しとなるカラムは、結合している必要があります。</li>
</ul>
</li>
<li>見出しとなるセルが見つからない場合はエラーとなりますが、属性 <code class="docutils literal notranslate"><span class="pre">optional</span></code> を <code class="docutils literal notranslate"><span class="pre">true</span></code> とすることで無視して処理を続行します。</li>
<li>Collection(List, Set)型または配列のフィールドに付与します。<ul>
<li>List型などの場合、Genericsのタイプとして、マッピング先のクラスを指定します。</li>
<li>指定しない場合は、アノテーションの属性 <code class="docutils literal notranslate"><span class="pre">elementClass</span></code> でクラス型を指定します。</li>
</ul>
</li>
</ul>
<div class="figure align-center" id="id100">
<img alt="_images/ArrayColumns.png" src="_images/ArrayColumns.png" />
<p class="caption"><span class="caption-number">図 - 3.11.1 </span><span class="caption-text">ArrayColumns</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@XlsArrayColumns</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ふりがな&quot;</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nameRuby</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id38">
<h3>3.11.1. 結合したセルをマッピングする場合<a class="headerlink" href="#id38" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">elementMerged</span></code> で、セルの結合を考慮するか指定します。<ul>
<li>trueのときは、結合されているセルを1つのセルとしてマッピングします。</li>
<li>falseの場合は、結合されていても解除した状態と同じマッピング結果となります。<ul>
<li>ただし、falseのときは、書き込む際には結合が解除されます。</li>
</ul>
</li>
<li>初期値はtrueであるため、特に意識はする必要はありません。</li>
</ul>
</li>
<li>セルが結合されている場合は、結合後の個数を指定します。</li>
</ul>
<div class="figure align-center" id="id101">
<img alt="_images/ArrayColumns_elementMerged.png" src="_images/ArrayColumns_elementMerged.png" />
<p class="caption"><span class="caption-number">図 - 3.11.2 </span><span class="caption-text">ArrayColumns(elementMerged)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="c1">// elementMerged=trueは初期値なので、省略可</span>
    <span class="nd">@XlsArrayColumns</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;連絡先&quot;</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">contactInfos</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id39">
<h3>3.11.2. 書き込み時に配列・リストのサイズが不足、または余分である場合<a class="headerlink" href="#id39" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>アノテーション <a class="reference internal" href="annotation_mapping_arrayoption.html#annotationxlsarrayoption"><span class="std std-ref">&#64;XlsArrayOption</span></a> を指定することで、書き込み時のセルの制御を指定することができます。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">overOperation</span></code> で、書き込み時にJavaオブジェクトの配列・リストのサイズに対して、属性 <code class="docutils literal notranslate"><span class="pre">size</span></code> の値が小さく、足りない場合の操作を指定します。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">remainedOperation</span></code> で、書き込み時にJavaオブジェクトの配列・リストのサイズに対して、属性 <code class="docutils literal notranslate"><span class="pre">size</span></code> の値が大きく、余っている場合の操作を指定します。</li>
</ul>
<div class="figure align-center" id="id102">
<img alt="_images/ArrayColumns_ArrayOption.png" src="_images/ArrayColumns_ArrayOption.png" />
<p class="caption"><span class="caption-number">図 - 3.11.3 </span><span class="caption-text">ArrayColumns(ArrayOption)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@XlsArrayColumns</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ふりがな&quot;</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="o">)</span>
    <span class="nd">@XlsArrayOption</span><span class="o">(</span><span class="n">overOperation</span><span class="o">=</span><span class="n">OverOperation</span><span class="o">.</span><span class="na">Error</span><span class="o">,</span> <span class="n">remainedOperation</span><span class="o">=</span><span class="n">RemainedOperation</span><span class="o">.</span><span class="na">Clear</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nameRuby</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id40">
<h3>3.11.3. 位置情報／見出し情報を取得する際の注意事項<a class="headerlink" href="#id40" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>マッピング対象のセルのアドレスを取得する際に、フィールド <code class="docutils literal notranslate"><span class="pre">Map&lt;String,</span> <span class="pre">Point&gt;</span> <span class="pre">positions</span></code> を定義しておけば、自動的にアドレスがマッピングされます。</p>
<p>通常は、キーにはプロパティ名が記述（フィールドの場合はフィールド名）が入ります。</p>
<p>アノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayColumns</span></code> でマッピングしたセルのキーは、インデックス付きの <code class="docutils literal notranslate"><span class="pre">&lt;プロパティ名&gt;[&lt;インデックス&gt;]</span></code> 形式になります。
インデックスは、0から始まります。</p>
<p>同様に、マッピング対象の見出しを取得する、フィールド <code class="docutils literal notranslate"><span class="pre">Map&lt;String,</span> <span class="pre">String&gt;</span> <span class="pre">labels</span></code> へのアクセスも、キーは、 <code class="docutils literal notranslate"><span class="pre">&lt;プロパティ名&gt;[&lt;インデックス&gt;]</span></code> の形式になります。
ただし、見出し情報の場合は、全ての要素が同じ値になるため、従来通りの <code class="docutils literal notranslate"><span class="pre">&lt;プロパティ名&gt;</span></code> でも取得できます。</p>
<div class="figure align-center" id="id103">
<img alt="_images/ArrayColumns_positions.png" src="_images/ArrayColumns_positions.png" />
<p class="caption"><span class="caption-number">図 - 3.11.4 </span><span class="caption-text">ArrayColumns(positions/labels)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="c1">// 位置情報</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Point</span><span class="o">&gt;</span> <span class="n">positions</span><span class="o">;</span>

    <span class="c1">// 見出し情報</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">labels</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@XlsArrayColumns</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ふりがな&quot;</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nameRuby</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// 位置情報・見出し情報へのアクセス</span>
<span class="n">SampleRecord</span> <span class="n">record</span> <span class="o">=</span> <span class="cm">/* レコードのインスタンスの取得 */</span><span class="o">;</span>

<span class="n">Point</span> <span class="n">position</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">positions</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;nameRuby[2]&quot;</span><span class="o">);</span>

<span class="n">String</span> <span class="n">label</span> <span class="o">=</span> <span class="n">recrod</span><span class="o">.</span><span class="na">labeles</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;nameRuby[2]&quot;</span><span class="o">);</span>

<span class="c1">// 見出し情報の場合、従来通りのインデックスなしでも取得できる</span>
<span class="n">String</span> <span class="n">label</span> <span class="o">=</span> <span class="n">recrod</span><span class="o">.</span><span class="na">labeles</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;nameRuby&quot;</span><span class="o">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id41">
<h3>3.11.4. 見出しを正規表現、正規化して指定する場合<a class="headerlink" href="#id41" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>シートの構造は同じだが、ラベルのセルが微妙に異なる場合、ラベルセルを正規表現による指定が可能です。
また、空白や改行を除去してラベルセルを比較するように設定することも可能です。 <cite>[ver1.1+]</cite></p>
<ul class="simple">
<li>正規表現で指定する場合、アノテーションの属性の値を <code class="docutils literal notranslate"><span class="pre">/正規表現/</span></code> のように、スラッシュで囲み指定します。<ul>
<li>スラッシュで囲まない場合、通常の文字列として処理されます。</li>
<li>正規表現の指定機能を有効にするには、<a class="reference internal" href="configuration.html"><span class="doc">システム設定のプロパティ</span></a> <code class="docutils literal notranslate"><span class="pre">regexLabelText</span></code> の値を trueに設定します。</li>
</ul>
</li>
<li>ラベセルの値に改行が空白が入っている場合、それらを除去し、正規化してアノテーションの属性値と比較することが可能です。<ul>
<li>正規化とは、空白、改行、タブを除去することを指します。</li>
<li>ラベルを正規化する機能を有効にするには、システム設定のプロパティ <code class="docutils literal notranslate"><span class="pre">normalizeLabelText</span></code> の値を trueに設定します。</li>
</ul>
</li>
</ul>
<p>これらの指定が可能な属性は、<code class="docutils literal notranslate"><span class="pre">columnName</span></code> です。</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// システム設定</span>
<span class="n">XlsMapper</span> <span class="n">xlsMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XlsMapper</span><span class="o">();</span>
<span class="n">xlsMapper</span><span class="o">.</span><span class="na">getConfiguration</span><span class="o">()</span>
        <span class="o">.</span><span class="na">setRegexLabelText</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>        <span class="c1">// ラベルを正規表現で指定可能にする機能を有効にする。</span>
        <span class="o">.</span><span class="na">setNormalizeLabelText</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>   <span class="c1">// ラベルを正規化して比較する機能を有効にする。</span>

<span class="c1">// レコード用クラス</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="c1">// 正規表現による指定</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;/名前.+/&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="c1">// 正規表現による指定</span>
    <span class="nd">@XlsArrayColumns</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;/ふりがな.+/&quot;</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nameRuby</span><span class="o">;</span>


<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlsnestedrecords">
<span id="annotationxlsnestedrecords"></span><h2>3.12. <code class="docutils literal notranslate"><span class="pre">&#64;XlsNestedRecords</span></code><a class="headerlink" href="#xlsnestedrecords" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>アノテーション <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> もしくは <a class="reference internal" href="annotation_mapping_verticalrecords.html#annotationxlsverticalrecords"><span class="std std-ref">&#64;XlsVerticalRecords</span></a> のレコード用クラスにおいて、ツリー構造のように入れ子になっている表をマッピングする際に使用します。 <cite>[ver.1.4+]</cite></p>
<div class="section" id="id42">
<h3>3.12.1. 一対多の関係<a class="headerlink" href="#id42" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>一対多の関係を表現する際には、Collection(List/Set)または、配列で指定します。</p>
<ul class="simple">
<li>親子関係は、結合しているかで表現します。<ul>
<li>結合している個数が不一致の場合は、例外 <code class="docutils literal notranslate"><span class="pre">NestedRecordMergedSizeException</span></code> がスローされます。</li>
</ul>
</li>
<li>親に指定しているJavaBeanクラスは、子や孫には指定することができません。<ul>
<li>カラムの定義はレコードに記述されているため、親子に同じレコードのクラス定義があると、無限に再帰処理してしまうため、それを防ぐための制約になります。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">&#64;XlsHorizotanlRecords#terminalLabel</span></code> の終端の判定は、入れ子になったレコードごとに判定されます。</li>
<li>読み込みの際、アノテーション <a class="reference internal" href="annotation_mapping_ignorable.html#annotationxlsignorable"><span class="std std-ref">&#64;XlsIgnorable</span></a> で、空のレコードを読み飛ばした結果、レコード数が0件となった場合は、要素数0個リストや配列が設定されます。</li>
</ul>
<div class="figure align-center" id="id104">
<img alt="_images/NestedRecords_oneToMany.png" src="_images/NestedRecords_oneToMany.png" />
<p class="caption"><span class="caption-number">図 - 3.12.1 </span><span class="caption-text">NestedRecords(一対多の関係)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// シート用クラス</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;機能&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;機能一覧&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">CategoryRecord</span><span class="o">&gt;</span> <span class="n">categories</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// レコード用クラス（分類）</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CategoryRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;分類&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;説明（分類）&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">description</span><span class="o">;</span>

    <span class="c1">// ネストしたレコードのマッピング</span>
    <span class="nd">@XlsNestedRecords</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">FunctionRecord</span><span class="o">&gt;</span> <span class="n">functions</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// レコード用クラス（機能）</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FunctionRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;機能名&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;説明（機能）&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">description</span><span class="o">;</span>

    <span class="c1">// ネストしたレコードのマッピング</span>
    <span class="nd">@XlsNestedRecords</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">DetailRecord</span><span class="o">&gt;</span> <span class="n">details</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// レコード用クラス（詳細）</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DetailRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;項目&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;値&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">value</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id43">
<h3>3.12.2. 一対一の関係<a class="headerlink" href="#id43" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>一対一の関係をマッピングする際には、ネストしたクラスを直接指定します。</p>
<p>クラス定義などの制約は、基本的に一対多のときと同じです。</p>
<div class="figure align-center" id="id105">
<img alt="_images/NestedRecords_oneToOne.png" src="_images/NestedRecords_oneToOne.png" />
<p class="caption"><span class="caption-number">図 - 3.12.2 </span><span class="caption-text">NestedRecords(一対一の関係)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// シート用クラス</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;学期末テスト&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;テスト結果&quot;</span><span class="o">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">users</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// レコード用クラス（生徒情報）</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;No.&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">no</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;クラス&quot;</span><span class="o">,</span> <span class="n">merged</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">className</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;氏名&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="c1">// ネストしたレコードのマッピング</span>
    <span class="nd">@XlsNestedRecords</span>
    <span class="kd">private</span> <span class="n">ResultRecord</span> <span class="n">result</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// レコード用クラス（テスト結果）</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ResultRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;国語&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">kokugo</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;算数&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">sansu</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;合計&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">sum</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlsiteratetables">
<span id="annotationxlsiteratetables"></span><h2>3.13. <code class="docutils literal notranslate"><span class="pre">&#64;XlsIterateTables</span></code><a class="headerlink" href="#xlsiteratetables" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>同一の構造の表がシート内で繰り返し出現する場合に使用し、Collection(List、Set)または配列にマッピングします。
次のアノテーションを組み合わせて構成します。</p>
<ul class="simple">
<li>横方向の表をマッピングするアノテーション <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> 。</li>
<li>縦方向の表をマッピングするアノテーション <a class="reference internal" href="annotation_mapping_verticalrecords.html#annotationxlsverticalrecords"><span class="std std-ref">&#64;XlsVerticalRecords</span></a> <cite>[ver.2.0+]</cite> 。<ul>
<li>ただし、アノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsHorizontalRecords</span></code> と同時に使用することはできません。</li>
</ul>
</li>
<li>見出し付きの1つのセルをマッピングするアノテーション <a class="reference internal" href="annotation_mapping_labelledcell.html#annotationxlslabelledcell"><span class="std std-ref">&#64;XlsLabelledCell</span></a> 。</li>
<li>見出し付きの連続し隣接する複数のセルをマッピングするアノテーション <a class="reference internal" href="annotation_mapping_labelledarraycells.html#annotationxlslabelledarraycells"><span class="std std-ref">&#64;XlsLabelledArrayCells</span></a> <cite>[ver.2.0+]</cite>。</li>
</ul>
<div class="section" id="id44">
<h3>3.13.1. 基本的な使い方<a class="headerlink" href="#id44" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>属性 <code class="docutils literal notranslate"><span class="pre">tableLabel</span></code> で繰り返し部分の表の名称を指定します。</p>
<p>また、属性bottomは、<code class="docutils literal notranslate"><span class="pre">&#64;XlsIterateTables</span></code> 内で <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> を使用する場合に、
テーブルの開始位置が <code class="docutils literal notranslate"><span class="pre">&#64;XlsIterateTables</span></code> の表の名称セルからどれだけ離れているかを指定します。</p>
<div class="figure align-center" id="id106">
<img alt="_images/IterateTables.png" src="_images/IterateTables.png" />
<p class="caption"><span class="caption-number">図 - 3.13.1 </span><span class="caption-text">IterateTables</span></p>
</div>
<div class="literal-block-wrapper docutils container" id="id107">
<div class="code-block-caption"><span class="caption-number">コード - 3.13.1 </span><span class="caption-text">シート用クラスの定義</span><a class="headerlink" href="#id107" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;シート名&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsIterateTables</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;部門情報&quot;</span><span class="o">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">SampleTable</span><span class="o">&gt;</span> <span class="n">tables</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<p>繰り返し部分に対応するJavaBeanでは以下のように、アノテーション <a class="reference internal" href="annotation_mapping_labelledcell.html#annotationxlslabelledcell"><span class="std std-ref">&#64;XlsLabelledCell</span></a> <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> を使用することができます。</p>
<p>アノテーション <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> を使用する場合、属性tableLabel は設定する必要はありません。
<code class="docutils literal notranslate"><span class="pre">&#64;XlsIterateTables</span></code> の属性 tableLabelとbottomの値を引き継ぐため、指定しなくても問題ないためです。</p>
<div class="literal-block-wrapper docutils container" id="id108">
<div class="code-block-caption"><span class="caption-number">コード - 3.13.2 </span><span class="caption-text">テーブル用クラスの定義</span><a class="headerlink" href="#id108" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleTable</span> <span class="o">{</span>

    <span class="nd">@XlsLabelledCell</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;部門名&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">deptName</span><span class="o">;</span>

    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">terminal</span><span class="o">=</span><span class="n">RecordTerminal</span><span class="o">.</span><span class="na">Border</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">SampleRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<p>繰り返し部分に対応するJavaBeanで <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> を使用した場合、通常の場合と同じく <a class="reference internal" href="annotation_mapping_column.html#annotationxlscolumn"><span class="std std-ref">&#64;XlsColumn</span></a> や <a class="reference internal" href="annotation_mapping_mapcolumns.html#annotationxlsmapcolumns"><span class="std std-ref">&#64;XlsMapColumns</span></a> で列とのマッピングを行います。</p>
<div class="literal-block-wrapper docutils container" id="id109">
<div class="code-block-caption"><span class="caption-number">コード - 3.13.3 </span><span class="caption-text">レコード用クラスの定義</span><a class="headerlink" href="#id109" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<ul class="last simple">
<li>ver.2.0から、Collection型(List型、Set型)にも対応しています。</li>
<li>インタフェースの型を指定する場合、次の実装クラスのインスタンスが設定されます。<ul>
<li>List型の場合、 <code class="docutils literal notranslate"><span class="pre">java.util.ArrayList</span></code> クラス。</li>
<li>Set型の場合、 <code class="docutils literal notranslate"><span class="pre">java.util.LinkedHashSet</span></code> クラス。</li>
<li>Collection型の場合、 <code class="docutils literal notranslate"><span class="pre">java.util.ArrayList</span></code> クラス。</li>
</ul>
</li>
<li>実装クラスを指定した場合、そのインスタンスが設定されます。</li>
</ul>
</div>
</div>
<div class="section" id="id45">
<h3>3.13.2. 縦方向の表を組み合わせてマッピングする場合<a class="headerlink" href="#id45" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>縦方向の表をマッピングするアノテーション <a class="reference internal" href="annotation_mapping_verticalrecords.html#annotationxlsverticalrecords"><span class="std std-ref">&#64;XlsVerticalRecords</span></a> も使用することができます。</p>
<ul class="simple">
<li>ただし、横方向の表をマッピングするアノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsHorizontalRecords</span></code> と同時に使用することはできません。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">tableLabelAbove=true</span></code> が自動的に有効になり、表の見出しが上部にあることを前提に処理されます。</li>
</ul>
<div class="figure align-center" id="id110">
<img alt="_images/IterateTables_VerticalRecords.png" src="_images/IterateTables_VerticalRecords.png" />
<p class="caption"><span class="caption-number">図 - 3.13.2 </span><span class="caption-text">IterateTables(縦方向)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// シート用クラス</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;観測データ&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsIterateTables</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;/観測情報.+/&quot;</span><span class="o">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">DataTable</span><span class="o">&gt;</span> <span class="n">tables</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// テーブル用クラス</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DataTable</span> <span class="o">{</span>

    <span class="nd">@XlsLabelledCell</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;日付&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">LocalDate</span> <span class="n">date</span><span class="o">;</span>

    <span class="nd">@XlsVerticalRecords</span><span class="o">(</span><span class="n">terminal</span><span class="o">=</span><span class="n">RecordTerminal</span><span class="o">.</span><span class="na">Border</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">WeatherRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// レコード用クラス</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WeatherRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;時間&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">time</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;降水&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">precipitation</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id46">
<h3>3.13.3. 表の名称を正規表現、正規化して指定する場合<a class="headerlink" href="#id46" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>シートの構造は同じだが、ラベルのセルが微妙に異なる場合、ラベルセルを正規表現による指定が可能です。
また、空白や改行を除去してラベルセルを比較するように設定することも可能です。 <cite>[ver1.1+]</cite></p>
<ul class="simple">
<li>正規表現で指定する場合、アノテーションの属性の値を <code class="docutils literal notranslate"><span class="pre">/正規表現/</span></code> のように、スラッシュで囲み指定します。<ul>
<li>スラッシュで囲まない場合、通常の文字列として処理されます。</li>
<li>正規表現の指定機能を有効にするには、<a class="reference internal" href="configuration.html"><span class="doc">システム設定のプロパティ</span></a> <code class="docutils literal notranslate"><span class="pre">regexLabelText</span></code> の値を trueに設定します。</li>
</ul>
</li>
<li>ラベセルの値に改行が空白が入っている場合、それらを除去し正規化してアノテーションの属性値と比較することが可能です。<ul>
<li>正規化とは、空白、改行、タブを除去することを指します。</li>
<li>ラベルを正規化する機能を有効にするには、<a class="reference internal" href="configuration.html"><span class="doc">システム設定のプロパティ</span></a> <code class="docutils literal notranslate"><span class="pre">normalizeLabelText</span></code> の値を trueに設定します。</li>
</ul>
</li>
</ul>
<p>これらの指定が可能な属性は、<code class="docutils literal notranslate"><span class="pre">tableLabel</span></code> です。</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// システム設定</span>
<span class="n">XlsMapper</span> <span class="n">xlsMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XlsMapper</span><span class="o">();</span>
<span class="n">xlsMapper</span><span class="o">.</span><span class="na">getConfiguration</span><span class="o">()</span>
        <span class="o">.</span><span class="na">setRegexLabelText</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>        <span class="c1">// ラベルを正規表現で指定可能にする機能を有効にする。</span>
        <span class="o">.</span><span class="na">setNormalizeLabelText</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>   <span class="c1">// ラベルを正規化して比較する機能を有効にする。</span>

<span class="c1">// シート用クラス</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;シート名&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// 正規表現による指定</span>
    <span class="nd">@XlsIterateTables</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;/部門情報.+/&quot;</span><span class="o">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">2</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">SampleTable</span><span class="o">&gt;</span> <span class="n">tables</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlsorder">
<span id="annotationxlsorder"></span><h2>3.14. <code class="docutils literal notranslate"><span class="pre">&#64;XlsOrder</span></code><a class="headerlink" href="#xlsorder" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>書き込み時に、<code class="docutils literal notranslate"><span class="pre">&#64;XlsHoriontalRecords</span></code> を使用して行の挿入や削除を行う設定を行っている場合、
フィールドの処理順序によって、<code class="docutils literal notranslate"><span class="pre">Map&lt;String,</span> <span class="pre">Point&gt;</span> <span class="pre">positions</span></code> フィールドで座標がずれる場合があります。</p>
<p>このようなときに、<code class="docutils literal notranslate"><span class="pre">&#64;XlsOrder</span></code> の属性 <code class="docutils literal notranslate"><span class="pre">value</span></code> で書き込む処理順序を指定し一定に保つことができます。
属性 value はJavaの仕様により省略が可能です。</p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;XlsOrder</span></code> を付与しないフィールドは、付与しているフィールドよりも後から処理が実行されます。
属性valueが同じ値を設定されているときは、 フィールド名の昇順で優先度を決めて処理されます。</p>
<div class="figure align-center" id="id111">
<img alt="_images/Hint.png" src="_images/Hint.png" />
<p class="caption"><span class="caption-number">図 - 3.14.1 </span><span class="caption-text">Order</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="c1">// セルの位置情報</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Point</span><span class="o">&gt;</span> <span class="n">positions</span><span class="o">;</span>

    <span class="nd">@XlsOrder</span><span class="o">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="o">)</span>
    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;ユーザ一覧&quot;</span><span class="o">,</span> <span class="n">terminal</span><span class="o">=</span><span class="n">RecordTerminal</span><span class="o">.</span><span class="na">Border</span><span class="o">)</span>
    <span class="nd">@XlsRecordOption</span><span class="o">(</span><span class="n">overOperation</span><span class="o">=</span><span class="n">OverOperation</span><span class="o">.</span><span class="na">Insert</span><span class="o">,</span> <span class="n">remainedOperation</span><span class="o">=</span><span class="n">RemainedOperation</span><span class="o">.</span><span class="na">Delete</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>

    <span class="c1">// 属性valueは省略が可能</span>
    <span class="nd">@XlsOrder</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
    <span class="nd">@XlsLabelledCell</span><span class="o">(</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;更新日&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">updateTime</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>ソースコード上で定義したフィールドやメソッドの記述順は、実行時には保証されないため、<code class="docutils literal notranslate"><span class="pre">&#64;XlsOrder</span></code> で順番を指定し、処理順序を一定にすることができます。</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&#64;XlsOrder</span></code> を付与すると、書き込み時だけでなく読み込み時にも処理順序が一定になります。</p>
</div>
</div>
<div class="section" id="xlsignorable">
<span id="annotationxlsignorable"></span><h2>3.15. <code class="docutils literal notranslate"><span class="pre">&#64;XlsIgnorable</span></code><a class="headerlink" href="#xlsignorable" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>アノテーション <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> 、<a class="reference internal" href="annotation_mapping_verticalrecords.html#annotationxlsverticalrecords"><span class="std std-ref">&#64;XlsVerticalRecords</span></a> を使用して、読み込む際に、空のレコードを読み飛ばしたい場合、
レコードが空と判定するためのメソッドに付与します。</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">&#64;XlsIgnorable</span></code> を付与したメソッドは、publicかつ引数なしの戻り値がboolean型の書式にする必要があります。</li>
<li><a class="reference internal" href="annotation_mapping_verticalrecords.html#annotationxlsverticalrecords"><span class="std std-ref">&#64;XlsVerticalRecords</span></a> でも同様に使用できます。</li>
</ul>
<p>また、この機能は読み込み時のみに有効です。書き込み時は、空のレコードでもそのまま出力されます。</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// ルートのオブジェクト</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;シート名&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UnitUser</span> <span class="o">{</span>

    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;ユーザ一覧&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">users</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// レコードのオブジェクト</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;No.&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">no</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;住所&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">address</span><span class="o">;</span>

    <span class="c1">// レコードが空と判定するためのメソッド</span>
    <span class="nd">@XlsIgnorable</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>

      <span class="k">if</span><span class="o">(</span><span class="n">name</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span><span class="n">name</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
      <span class="o">}</span>

      <span class="k">if</span><span class="o">(</span><span class="n">address</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span><span class="n">address</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
      <span class="o">}</span>

      <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="isemptybuilder">
<h3>3.15.1. IsEmptyBuilderを使った記述の簡単化<a class="headerlink" href="#isemptybuilder" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">IsEmptyBuilder</span></code> (ver.0.5から追加)を利用することで、より簡潔に記述することも可能です。</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">IsEmptyBuilder#reflectionIsEmpty(...)</span></code> を利用して判定する場合、位置情報を保持するフィールド <code class="docutils literal notranslate"><span class="pre">Map&lt;String,</span> <span class="pre">Point&gt;</span> <span class="pre">positions</span></code> などは除外対象とする必要があります。</li>
<li>独自に判定する場合、<code class="docutils literal notranslate"><span class="pre">IsEmptyBuilder#append(...)</span></code> を利用します。</li>
<li>さらに、 <code class="docutils literal notranslate"><span class="pre">IsEmptyBuilder#compare(IsEmptyComparator)</span></code> を利用することで独自の判定をすることができます。その際に、Lambda式を利用すると簡潔に記載できます。</li>
</ul>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// ルートのオブジェクト</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;シート名&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UnitUser</span> <span class="o">{</span>

    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;ユーザ一覧&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">users</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// レコードのオブジェクト</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>

    <span class="c1">// マッピングしたセルの位置情報を保持する。</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Point</span><span class="o">&gt;</span> <span class="n">positions</span><span class="o">;</span>

    <span class="c1">// マッピングしたセルのラベル情報を保持する。</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">labels</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;No.&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">no</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;住所&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">address</span><span class="o">;</span>

    <span class="c1">// レコードが空と判定するためのメソッド</span>
    <span class="nd">@XlsIgnorable</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">IsEmptyBuilder</span><span class="o">.</span><span class="na">reflectionIsEmpty</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">&quot;positions&quot;</span><span class="o">,</span> <span class="s">&quot;labels&quot;</span><span class="o">);</span>

    <span class="o">}</span>

    <span class="c1">// 独自に判定する場合</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty2</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">IsEmptyBuilder</span><span class="o">()</span>
            <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">name</span><span class="o">)</span>
            <span class="o">.</span><span class="na">compare</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="n">StringUtils</span><span class="o">.</span><span class="na">isBlank</span><span class="o">(</span><span class="n">address</span><span class="o">))</span>
            <span class="o">.</span><span class="na">isEmpty</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlsarrayoption">
<span id="annotationxlsarrayoption"></span><h2>3.16. <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayOption</span></code><a class="headerlink" href="#xlsarrayoption" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>アノテーション <a class="reference internal" href="annotation_mapping_arraycells.html#annotationxlsarraycells"><span class="std std-ref">&#64;XlsArrayCells</span></a> 、 <a class="reference internal" href="annotation_mapping_labelledarraycells.html#annotationxlslabelledarraycells"><span class="std std-ref">&#64;XlsLabelledArrayCells</span></a> 、<a class="reference internal" href="annotation_mapping_arraycolumns.html#annotationxlsarraycolumns"><span class="std std-ref">&#64;XlsArrayColumns</span></a> において、書き込み時の配列・リストの操作を指定するためのアノテーションです。 <cite>[ver.2.0+]</cite></p>
<div class="section" id="overoperation">
<h3>3.16.1. 書き込み時に配列・リストのサイズが不足している場合(overOperation)<a class="headerlink" href="#overoperation" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>アノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayOption</span></code> を指定することで、書き込み時のセルの制御を指定することができます。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">overOperation</span></code> で、書き込み時にJavaオブジェクトの配列・リストのサイズに対して、属性 <code class="docutils literal notranslate"><span class="pre">size</span></code> の値が小さく、足りない場合の操作を指定します。<ul>
<li>デフォルト値である列挙型 <code class="docutils literal notranslate"><span class="pre">OverOperation#Break</span></code> の値のとき、隣接するセルへの書き込みを中断します。</li>
<li>列挙型 <code class="docutils literal notranslate"><span class="pre">OverOperation#Error</span></code> の値のとき、書き込み処理をする前に、例外 <code class="docutils literal notranslate"><span class="pre">AnnotationInvalidException</span></code> をスローします。</li>
</ul>
</li>
</ul>
<div class="figure align-center" id="id112">
<img alt="_images/ArrayOption_overOperation.png" src="_images/ArrayOption_overOperation.png" />
<p class="caption"><span class="caption-number">図 - 3.16.1 </span><span class="caption-text">ArrayOption(overOperation)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// 書き込むデータ</span>
<span class="n">String</span><span class="o">[]</span> <span class="n">data</span> <span class="o">=</span> <span class="n">String</span><span class="o">[]{</span><span class="s">&quot;や&quot;</span><span class="o">,</span> <span class="s">&quot;ま&quot;</span><span class="o">,</span> <span class="s">&quot;だ&quot;</span><span class="o">,</span> <span class="s">&quot;　&quot;</span><span class="o">,</span> <span class="s">&quot;た&quot;</span><span class="o">,</span> <span class="s">&quot;ろ&quot;</span><span class="o">,</span> <span class="s">&quot;う&quot;</span><span class="o">};</span>

<span class="c1">// マッピングの定義</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ふりがな&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="o">)</span>
    <span class="nd">@XlsArrayOption</span><span class="o">(</span><span class="n">overOperation</span><span class="o">=</span><span class="n">OverOperation</span><span class="o">.</span><span class="na">Error</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span><span class="o">[]</span> <span class="n">nameRuby</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="remainedoperation">
<h3>3.16.2. 書き込み時に配列・リストのサイズが余っている場合(remainedOperation)<a class="headerlink" href="#remainedoperation" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>アノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayOption</span></code> を指定することで、書き込み時のセルの制御を指定することができます。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">remainedOperation</span></code> で、書き込み時にJavaオブジェクトの配列・リストのサイズに対して、属性 <code class="docutils literal notranslate"><span class="pre">size</span></code> の値が大きく、余っている場合の操作を指定します。<ul>
<li>デフォルト値である列挙型 <code class="docutils literal notranslate"><span class="pre">RemainedOperation#None</span></code> の値のとき、隣接するセルへの書き込み、その後何もしません。</li>
<li>列挙型 <code class="docutils literal notranslate"><span class="pre">RemainedOperation#Clear</span></code> の値のとき、隣接するセルへの書き込み、その後、余っているセルの値をクリアします。</li>
</ul>
</li>
</ul>
<div class="figure align-center" id="id113">
<img alt="_images/ArrayOption_remainedOperation.png" src="_images/ArrayOption_remainedOperation.png" />
<p class="caption"><span class="caption-number">図 - 3.16.2 </span><span class="caption-text">ArrayOption(remainedOperation)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// 書き込むデータ</span>
<span class="n">String</span><span class="o">[]</span> <span class="n">data</span> <span class="o">=</span> <span class="n">String</span><span class="o">[]{</span><span class="s">&quot;あ&quot;</span><span class="o">,</span> <span class="s">&quot;べ&quot;</span><span class="o">,</span> <span class="s">&quot;　&quot;</span><span class="o">,</span> <span class="s">&quot;あ&quot;</span><span class="o">,</span> <span class="s">&quot;い&quot;</span><span class="o">};</span>

<span class="c1">// マッピングの定義</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleSheet</span> <span class="o">{</span>

    <span class="nd">@XlsLabelledArrayCells</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ふりがな&quot;</span><span class="o">,</span> <span class="n">type</span><span class="o">=</span><span class="n">LabelledCellType</span><span class="o">.</span><span class="na">Right</span><span class="o">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="o">)</span>
    <span class="nd">@XlsArrayOption</span><span class="o">(</span><span class="n">remainedOperation</span><span class="o">=</span><span class="n">RemainedOperation</span><span class="o">.</span><span class="na">Clear</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span><span class="o">[]</span> <span class="n">nameRuby</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlsrecordoption">
<span id="annotationxlsrecordoption"></span><h2>3.17. <code class="docutils literal notranslate"><span class="pre">&#64;XlsRecordOption</span></code><a class="headerlink" href="#xlsrecordoption" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>アノテーション <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> 、 <a class="reference internal" href="annotation_mapping_verticalrecords.html#annotationxlsverticalrecords"><span class="std std-ref">&#64;XlsVerticalRecords</span></a>  において、書き込み時のレコードの操作を指定するためのアノテーションです。 <cite>[ver.2.0+]</cite></p>
<div class="section" id="id47">
<h3>3.17.1. 書き込み時に配列・リストのサイズが不足している場合(overOperation)<a class="headerlink" href="#id47" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>アノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsRecordOption</span></code> を指定することで、書き込み時のレコードの制御を指定することができます。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">overOperation</span></code> で、書き込み時にJavaオブジェクトのレコード数に対して、シートのレコード数が足りない場合の操作を指定します。<ul>
<li>デフォルト値である列挙型 <code class="docutils literal notranslate"><span class="pre">OverOperation#Break</span></code> のとき、レコードの書き込みを中断します。</li>
<li>列挙型 <code class="docutils literal notranslate"><span class="pre">OverOperation#Copy</span></code> のとき、指定すると上部のセルの書式を下部にコピーして値を設定します。<ul>
<li><code class="docutils literal notranslate"><span class="pre">&#64;XlsVerticalRecords</span></code> のときは、左側のセルを右側にコピーして値を設定します。</li>
</ul>
</li>
<li>列挙型 <code class="docutils literal notranslate"><span class="pre">OverOperation#Insert</span></code> のとき、行を挿入してレコードを書き込みます。その際に、上部のセルの書式をコピーします。<ul>
<li><code class="docutils literal notranslate"><span class="pre">&#64;XlsVerticalRecords</span></code> のときは、サポートしていません。</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="figure align-center" id="id114">
<img alt="_images/RecordOption_overOperation.png" src="_images/RecordOption_overOperation.png" />
<p class="caption"><span class="caption-number">図 - 3.17.1 </span><span class="caption-text">RecordOption(overOperation)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// 書き込むデータ</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">data</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">UserRecord</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">&quot;山田　太郎&quot;</span><span class="o">));</span>
<span class="n">data</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">UserRecord</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s">&quot;山田　花子&quot;</span><span class="o">));</span>
<span class="n">data</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">UserRecord</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="s">&quot;鈴木　一郎&quot;</span><span class="o">));</span>

<span class="c1">// マッピングの定義</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SheetObject</span> <span class="o">{</span>

    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;ユーザ一覧&quot;</span><span class="o">)</span>
    <span class="nd">@XlsRecordOption</span><span class="o">(</span><span class="n">overOperation</span><span class="o">=</span><span class="n">OverOperation</span><span class="o">.</span><span class="na">Insert</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id48">
<h3>3.17.2. 書き込み時に配列・リストのサイズが余っている場合(remainedOperation)<a class="headerlink" href="#id48" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>アノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsRecordOption</span></code> を指定することで、書き込み時のセルの制御を指定することができます。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">remainedOperation</span></code> で、書き込み時にJavaオブジェクトのレコード数に対して、シートのレコード数が余っている場合の操作を指定します。<ul>
<li>デフォルト値である列挙型 <code class="docutils literal notranslate"><span class="pre">RemainedOperation#None</span></code> の値のとき、レコードを書き込み、その後何もしません。</li>
<li>列挙型 <code class="docutils literal notranslate"><span class="pre">RemainedOperation#Clear</span></code> の値のとき、レコードを書き込み、その後、余っているセルの値をクリアします。</li>
<li>列挙型 <code class="docutils literal notranslate"><span class="pre">RemainedOperation#Delete</span></code> の値のとき、レコードを書き込み、その後、余っている行を削除します。<ul>
<li><code class="docutils literal notranslate"><span class="pre">&#64;XlsVerticalRecords</span></code> のときは、サポートしていません。</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="figure align-center" id="id115">
<img alt="_images/RecordOption_remainedOperation.png" src="_images/RecordOption_remainedOperation.png" />
<p class="caption"><span class="caption-number">図 - 3.17.2 </span><span class="caption-text">RecordOption(remainedOperation)</span></p>
</div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// 書き込むデータ</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">data</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">UserRecord</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">&quot;山田　太郎&quot;</span><span class="o">));</span>
<span class="n">data</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">UserRecord</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s">&quot;山田　花子&quot;</span><span class="o">));</span>

<span class="c1">// マッピングの定義</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SheetObject</span> <span class="o">{</span>

    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;ユーザ一覧&quot;</span><span class="o">)</span>
    <span class="nd">@XlsRecordOption</span><span class="o">(</span><span class="n">remainedOperation</span><span class="o">=</span><span class="n">RemainedOperation</span><span class="o">.</span><span class="na">Clear</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserRecord</span><span class="o">&gt;</span> <span class="n">records</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlsrecordfinder">
<span id="annotationxlsrecordfinder"></span><h2>3.18. <code class="docutils literal notranslate"><span class="pre">&#64;XlsRecordFinder</span></code><a class="headerlink" href="#xlsrecordfinder" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>アノテーション <a class="reference internal" href="annotation_mapping_horizontalrecords.html#annotationxlshorizontalrecords"><span class="std std-ref">&#64;XlsHorizontalRecords</span></a> 、 <a class="reference internal" href="annotation_mapping_verticalrecords.html#annotationxlsverticalrecords"><span class="std std-ref">&#64;XlsVerticalRecords</span></a>  において、データレコードの開始位置が既存のアノテーションの属性だと表現できない場合に、任意の実装方法を指定するようにします。 <cite>[ver.2.0+]</cite></p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">value</span></code> で、レコードの開始位置を検索する <code class="docutils literal notranslate"><span class="pre">RecordFinder</span></code> の実装クラスを指定します。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">args</span></code> で、レコードの開始位置を検索する実装クラスに渡す引数を指定します。</li>
</ul>
<div class="figure align-center" id="id116">
<img alt="_images/RecordFinder.png" src="_images/RecordFinder.png" />
<p class="caption"><span class="caption-number">図 - 3.18.1 </span><span class="caption-text">RecordFinder</span></p>
</div>
<div class="literal-block-wrapper docutils container" id="id117">
<div class="code-block-caption"><span class="caption-number">コード - 3.18.1 </span><span class="caption-text">任意の位置のレコードをマッピングする場合</span><a class="headerlink" href="#id117" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// マッピングの定義</span>
<span class="nd">@XlsSheet</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Users&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SheetSheet</span> <span class="o">{</span>

    <span class="c1">// クラスAに対するマッピング定義</span>
    <span class="nd">@XlsOrder</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="c1">// マッピングの終了条件が、「クラスB」であるため、terminalLabelを指定します。汎用的に正規表現で指定します。</span>
    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;成績一覧&quot;</span><span class="o">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">terminal</span><span class="o">=</span><span class="n">RecordTerminal</span><span class="o">.</span><span class="na">Border</span><span class="o">,</span> <span class="n">terminateLabel</span><span class="o">=</span><span class="s">&quot;/クラス.+/&quot;</span><span class="o">)</span>
    <span class="c1">// クラスAの見出しを探すために、属性argsでクラス名を指定します。</span>
    <span class="nd">@XlsRecordFinder</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="n">ClassNameRecordFinder</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">=</span><span class="s">&quot;クラスA&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Record</span><span class="o">&gt;</span> <span class="n">classA</span><span class="o">;</span>

    <span class="c1">// クラスBに対するマッピング定義</span>
    <span class="nd">@XlsOrder</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
    <span class="c1">// マッピングの終了条件が、終端のセルに罫線があるのため、terminalを指定します。</span>
    <span class="nd">@XlsHorizontalRecords</span><span class="o">(</span><span class="n">tableLabel</span><span class="o">=</span><span class="s">&quot;成績一覧&quot;</span><span class="o">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">terminal</span><span class="o">=</span><span class="n">RecordTerminal</span><span class="o">.</span><span class="na">Border</span><span class="o">,</span> <span class="n">terminateLabel</span><span class="o">=</span><span class="s">&quot;/クラス.+/&quot;</span><span class="o">)</span>
    <span class="c1">// クラスAの見出しを探すために、属性argsでクラス名を指定します。</span>
    <span class="nd">@XlsRecordFinder</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="n">ClassNameRecordFinder</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">=</span><span class="s">&quot;クラスB&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Record</span><span class="o">&gt;</span> <span class="n">classB</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// クラス用の見出しのレコードを探すクラス</span>
<span class="kd">class</span> <span class="nc">ClassNameRecordFinder</span> <span class="kd">implements</span> <span class="n">RecordFinder</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">CellPosition</span> <span class="nf">find</span><span class="o">(</span><span class="n">ProcessCase</span> <span class="n">processCase</span><span class="o">,</span> <span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">,</span> <span class="n">Sheet</span> <span class="n">sheet</span><span class="o">,</span>
            <span class="n">CellPosition</span> <span class="n">initAddress</span><span class="o">,</span> <span class="n">Object</span> <span class="n">beanObj</span><span class="o">,</span> <span class="n">Configuration</span> <span class="n">config</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">// アノテーション @XlsRecordFinder の属性argsで指定された値を元にセルを検索します。</span>
        <span class="kd">final</span> <span class="n">String</span> <span class="n">className</span> <span class="o">=</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
        <span class="n">Cell</span> <span class="n">classNameCell</span> <span class="o">=</span> <span class="n">CellFinder</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">sheet</span><span class="o">,</span> <span class="n">className</span><span class="o">,</span> <span class="n">config</span><span class="o">)</span>
                <span class="o">.</span><span class="na">startPosition</span><span class="o">(</span><span class="n">initAddress</span><span class="o">)</span>
                <span class="o">.</span><span class="na">findWhenNotFoundException</span><span class="o">();</span>

        <span class="c1">// 見出し用のセルから1つ下がデータレコードの開始位置</span>
        <span class="k">return</span> <span class="n">CellPosition</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">classNameCell</span><span class="o">.</span><span class="na">getRowIndex</span><span class="o">()+</span><span class="mi">1</span><span class="o">,</span> <span class="n">initAddress</span><span class="o">.</span><span class="na">getColumn</span><span class="o">());</span>
    <span class="o">}</span>

<span class="o">}</span>

<span class="c1">// ユーザレコードの定義</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;No.&quot;</span><span class="o">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">no</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;氏名&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;算数&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">sansu</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;国語&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">kokugo</span><span class="o">;</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;合計&quot;</span><span class="o">)</span>
    <span class="nd">@XlsFormula</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">&quot;SUM(D{rowNumber}:E{rowNumber})&quot;</span><span class="o">,</span> <span class="n">primary</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">sum</span><span class="o">;</span>

    <span class="nd">@XlsIgnorable</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">IsEmptyBuilder</span><span class="o">.</span><span class="na">reflectionIsEmpty</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">&quot;positions&quot;</span><span class="o">,</span> <span class="s">&quot;labels&quot;</span><span class="o">,</span> <span class="s">&quot;no&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// getter、setterは省略</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="annotation_converter.html" class="btn btn-neutral float-right" title="4. セルの書式の指定方法" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="attention.html" class="btn btn-neutral" title="2. 注意事項" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2018, T.TSUCHIE.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0',
            LANGUAGE:'ja',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="_static/mytheme.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<!-- my theme custom extrahead beacon -->
<script type="text/javascript" src="_static/jquery.externallink.js" charset="UTF-8"></script>
<script type="text/javascript">
	jQuery(function () {
		// ナビゲーション用のアイコン
		$('div.wy-menu').externalLink({cssClass : 'externalink-img', iconUrl:'_static/external-link-12.png', startUrl:'../apidocs/'});
		
		// コンテンツ用
		$('div.wy-nav-content').externalLink({cssClass : 'externalink', iconUrl:'', startUrl:'../apidocs/'});
		
	});
</script>

<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-37313068-2', 'auto');
  ga('send', 'pageview');
  
</script>

 


</body>
</html>