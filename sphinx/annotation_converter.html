

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ja" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ja" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4. セルの書式の指定方法 &mdash; XlsMapper 2.0 ドキュメント</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/mycustom.css" type="text/css" />
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="next" title="5. セルの値の変換方法" href="annotation_valueconverter.html" />
    <link rel="prev" title="3. 表・セルのマッピング方法" href="annotation_mapping.html" />
 
<!-- my theme custom extrahead beacon -->

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> XlsMapper
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
<p class="caption"><span class="caption-text">関連リンク</span></p>
<ul>
	<li class="toctree-l1"><a class="reference internal" href="../project-info.html">プロジェクト情報</a></li>
	<li class="toctree-l1"><a class="reference internal" href="../apidocs/index.html">JavaDoc</a></li>
	<li class="toctree-l1"><a class="reference internal" href="../project-reports.html">プロジェクトレポート</a></li>
	<li class="toctree-l1"><a class="reference internal" href="https://github.com/mygreen/xlsmapper">GitHub</a></li>
</ul>


            
            
              
            
            
              <p class="caption"><span class="caption-text">目次</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="howtouse.html">1. 基本的な使い方</a><ul>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#id2">1.1. ダウンロード</a></li>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#dependencyenv">1.2. 前提条件</a></li>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#howtousesheetload">1.3. マッピングの基本</a><ul>
<li class="toctree-l3"><a class="reference internal" href="howtouse.html#id5">1.3.1. 読み込み方の基本</a></li>
<li class="toctree-l3"><a class="reference internal" href="howtouse.html#id6">1.3.2. 書き込み方の基本</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#id7">1.4. 読み込み方</a><ul>
<li class="toctree-l3"><a class="reference internal" href="howtouse.html#id8">1.4.1. 単一のシートを読み込む場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="howtouse.html#id9">1.4.2. 複数のシートを読み込む場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="howtouse.html#howtousesheetsave">1.5. 書き込み方</a><ul>
<li class="toctree-l3"><a class="reference internal" href="howtouse.html#id11">1.5.1. 単一のシートの書き込む場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="howtouse.html#id12">1.5.2. 複数のシートを書き込む場合</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="attention.html">2. 注意事項</a><ul>
<li class="toctree-l2"><a class="reference internal" href="attention.html#exceljava">2.1. ExcelとJava間で数値をマッピングする際の注意事項</a></li>
<li class="toctree-l2"><a class="reference internal" href="attention.html#id2">2.2. アノテーションの定義位置</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="annotation_mapping.html">3. 表・セルのマッピング方法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlssheet">3.1. <code class="docutils literal notranslate"><span class="pre">&#64;XlsSheet</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id2">3.1.1. シート名を正規表現で指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlssheetname">3.2. <code class="docutils literal notranslate"><span class="pre">&#64;XlsSheetName</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id3">3.2.1. メソッドにアノテーションを付与する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlscell">3.3. <code class="docutils literal notranslate"><span class="pre">&#64;XlsCell</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlslabelledcell">3.4. <code class="docutils literal notranslate"><span class="pre">&#64;XlsLabelledCell</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#range">3.4.1. ラベルセルから離れたセルを指定する方法（属性range）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#skip">3.4.2. ラベルセルから離れたセルを指定する方法（属性skip）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#labelmerged">3.4.3. ラベルセルが結合している場合（属性labelMerged）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id4">3.4.4. ラベルセルが重複するセルを指定する方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id5">3.4.5. ラベルセルを正規表現、正規化して指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlsarraycells">3.5. <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayCells</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id6">3.5.1. 縦方向に隣接したセルをマッピングする場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id7">3.5.2. 結合したセルをマッピングする場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id8">3.5.3. 書き込み時に配列・リストのサイズが不足、または余分である場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id9">3.5.4. 位置情報／見出し情報を取得する際の注意事項</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlslabelledarraycells">3.6. <code class="docutils literal notranslate"><span class="pre">&#64;XlsLabelledArrayCells</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id10">3.6.1. 縦方向に隣接したセルをマッピングする場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id11">3.6.2. ラベルセルから離れたセルを指定する方法（属性range）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id12">3.6.3. ラベルセルから離れたセルを指定する方法（属性skip）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id13">3.6.4. 重複するラベルを指定する場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id14">3.6.5. ラベルセルが結合している場合（属性labelMerged）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#elementmerged">3.6.6. 結合したセルをマッピングする場合（属性elementMerged）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id15">3.6.7. 書き込み時に配列・リストのサイズが不足、または余分である場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id16">3.6.8. 位置情報／見出し情報を取得する際の注意事項</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id17">3.6.9. ラベルセルを正規表現、正規化して指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlshorizontalrecords">3.7. <code class="docutils literal notranslate"><span class="pre">&#64;XlsHorizontalRecords</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id18">3.7.1. 表の開始位置の指定（表の名称がない場合）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id19">3.7.2. 表の名称から開始位置が離れた場所にある場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id20">3.7.3. 表の見出しが縦に結合されデータレコードの開始位置が離れた場所にある場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#terminal">3.7.4. 表の終端の指定（属性terminal）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id21">3.7.5. 空のレコードを読み飛ばす条件の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#terminatelabel">3.7.6. 表の終端の指定（属性terminateLabel）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#headerlimit">3.7.7. 表の見出しの走査の終了条件の指定(headerLimit)</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id22">3.7.8. 表の見出しに空白がある場合(range)</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id23">3.7.9. 書き込み時にレコードが不足、余分である場合の操作の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id24">3.7.10. 任意の位置からレコードが開始するかを指定する場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id25">3.7.11. 表の名称を正規表現、正規化して指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlsverticalrecords">3.8. <code class="docutils literal notranslate"><span class="pre">&#64;XlsVerticalRecords</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id26">3.8.1. 表の名称位置の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#right">3.8.2. 表の名称から開始位置が離れた場所にある場合(right)</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#bottom">3.8.3. 表の名称から開始位置が離れた場所にある場合(bottom)</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id27">3.8.4. 表の見出しが横に結合されデータレコードの開始位置が離れた場所にある場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id28">3.8.5. 書き込み時にレコードが不足、余分である場合の操作の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id29">3.8.6. 任意の位置からレコードが開始するかを指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlscolumn">3.9. <code class="docutils literal notranslate"><span class="pre">&#64;XlsColumn</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id30">3.9.1. データの列が結合されている場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#annotationxlscolumnheadermerged">3.9.2. 見出し行が結合されている場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id32">3.9.3. 見出しを正規表現、正規化して指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlsmapcolumns">3.10. <code class="docutils literal notranslate"><span class="pre">&#64;XlsMapColumns</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id33">3.10.1. 終了条件のセルを指定する場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id34">3.10.2. 型変換する場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id35">3.10.3. 位置情報／見出し情報を取得する際の注意事項</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id36">3.10.4. 見出しを正規表現、正規化して指定する場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id37">3.10.5. 書き込み前に動的にテンプレートファイルを書き換える</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlsarraycolumns">3.11. <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayColumns</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id38">3.11.1. 結合したセルをマッピングする場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id39">3.11.2. 書き込み時に配列・リストのサイズが不足、または余分である場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id40">3.11.3. 位置情報／見出し情報を取得する際の注意事項</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id41">3.11.4. 見出しを正規表現、正規化して指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlsnestedrecords">3.12. <code class="docutils literal notranslate"><span class="pre">&#64;XlsNestedRecords</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id42">3.12.1. 一対多の関係</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id43">3.12.2. 一対一の関係</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlsiteratetables">3.13. <code class="docutils literal notranslate"><span class="pre">&#64;XlsIterateTables</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id44">3.13.1. 基本的な使い方</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id45">3.13.2. 縦方向の表を組み合わせてマッピングする場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id46">3.13.3. 表の名称を正規表現、正規化して指定する場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlsorder">3.14. <code class="docutils literal notranslate"><span class="pre">&#64;XlsOrder</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlsignorable">3.15. <code class="docutils literal notranslate"><span class="pre">&#64;XlsIgnorable</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#isemptybuilder">3.15.1. IsEmptyBuilderを使った記述の簡単化</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlsarrayoption">3.16. <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayOption</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#overoperation">3.16.1. 書き込み時に配列・リストのサイズが不足している場合(overOperation)</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#remainedoperation">3.16.2. 書き込み時に配列・リストのサイズが余っている場合(remainedOperation)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlsrecordoption">3.17. <code class="docutils literal notranslate"><span class="pre">&#64;XlsRecordOption</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id47">3.17.1. 書き込み時に配列・リストのサイズが不足している場合(overOperation)</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_mapping.html#id48">3.17.2. 書き込み時に配列・リストのサイズが余っている場合(remainedOperation)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="annotation_mapping.html#xlsrecordfinder">3.18. <code class="docutils literal notranslate"><span class="pre">&#64;XlsRecordFinder</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. セルの書式の指定方法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#xlsbooleanconverter">4.1. <code class="docutils literal notranslate"><span class="pre">&#64;XlsBooleanConverter</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">4.1.1. 読み込み時の値の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">4.1.2. 書き込み時の値の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">4.1.3. 変換に失敗した際の処理</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlsnumberconverter">4.2. <code class="docutils literal notranslate"><span class="pre">&#64;XlsNumberConverter</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5">4.2.1. 読み込み時の書式の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">4.2.2. 書き込み時の書式の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">4.2.3. 有効桁数の指定</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlsdatetimeconverter">4.3. <code class="docutils literal notranslate"><span class="pre">&#64;XlsDateTimeConverter</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id9">4.3.1. 読み込み時の書式の指定</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">4.3.2. 書き込み時の書式の指定</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlsenumconverter">4.4. <code class="docutils literal notranslate"><span class="pre">&#64;XlsEnumConverter</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id12">4.4.1. 基本的な使い方</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id13">4.4.2. 別名でマッピングする場合</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlsarrayconverter">4.5. <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayConverter</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id14">4.5.1. 基本的な使い方</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id15">4.5.2. 空の要素を無視する場合</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">4.5.3. 要素の値を変換するクラスを指定する</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xlscelloption">4.6. <code class="docutils literal notranslate"><span class="pre">&#64;XlsCellOption</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#id17">4.7. 独自のクラスタイプの対応方法</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cellconverter">4.7.1. CellConverterの実装クラスの作成</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cellconverterfactory">4.7.2. CellConverterFactoryの実装クラスの作成</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id18">4.7.3. 作成したCellConverterの使用方法</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#xlsconverter">4.7.3.1. <code class="docutils literal notranslate"><span class="pre">&#64;XlsConverter</span></code> を使用する方法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cellconverterregistry">4.7.3.2. CellConverterRegistry を使用する方法</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="annotation_valueconverter.html">5. セルの値の変換方法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="annotation_valueconverter.html#xlstrim">5.1. <code class="docutils literal notranslate"><span class="pre">&#64;XlsTrim</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="annotation_valueconverter.html#xlsdefaultvalue">5.2. <code class="docutils literal notranslate"><span class="pre">&#64;XlsDefaultValue</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="annotation_formula.html">6. 数式の指定方法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="annotation_formula.html#xlsformula">6.1. <code class="docutils literal notranslate"><span class="pre">&#64;XlsFormula</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="annotation_formula.html#value">6.1.1. 数式を直接指定する場合（属性value）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_formula.html#methodname">6.1.2. 数式を組み立てるメソッドを指定する場合（属性methodName）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_formula.html#primary">6.1.3. 数式を優先する場合（属性primary）</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_formula.html#id2">6.1.4. 式言語処理のカスタマイズ</a></li>
<li class="toctree-l3"><a class="reference internal" href="annotation_formula.html#id3">6.1.5. 数式を設定する際のポイント</a><ul>
<li class="toctree-l4"><a class="reference internal" href="annotation_formula.html#id4">6.1.5.1. 処理順序を一定にすることによる数式中の座標のずれを防ぐ</a></li>
<li class="toctree-l4"><a class="reference internal" href="annotation_formula.html#el">6.1.5.2. EL式中でプロパティを参照する場合</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="annotation_formula.html#id5">6.1.6. 複雑な表を作成する</a><ul>
<li class="toctree-l4"><a class="reference internal" href="annotation_formula.html#javabean">6.1.6.1. JavaBeanの定義</a></li>
<li class="toctree-l4"><a class="reference internal" href="annotation_formula.html#id6">6.1.6.2. データの作成とファイルの出力</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="annotation_lifecycle.html">7. ライフサイクルイベントの管理</a><ul>
<li class="toctree-l2"><a class="reference internal" href="annotation_lifecycle.html#javabean">7.1. JavaBeanクラスに実装する場合</a></li>
<li class="toctree-l2"><a class="reference internal" href="annotation_lifecycle.html#annotationxlslistener">7.2. リスナークラスに実装する場合</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sheetinfo.html">8. シート情報の取得</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sheetinfo.html#id2">8.1. シート上の位置情報の取得</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sheetinfo.html#id3">8.1.1. 書き込み時の位置情報取得の注意点</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sheetinfo.html#id4">8.2. シート上の見出しの取得</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="xmlmapping.html">9. XMLによるマッピング方法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="xmlmapping.html#id1">9.1. アノテーションをXMLで上書きする場合</a></li>
<li class="toctree-l2"><a class="reference internal" href="xmlmapping.html#xml-build">9.2. XMLを動的に組み立てる場合</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="validation.html">10. 値の検証方法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="validation.html#id2">10.1. 検証の基本</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html#id3">10.2. 独自の入力値検証</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html#id4">10.3. フィールド（プロパティ）の入力値検証</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html#id5">10.4. メッセージファイルの定義</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html#id6">10.5. メッセージファイルの読み込み方法の変更</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html#bean-validation">10.6. Bean Validationを使用した入力値検証</a><ul>
<li class="toctree-l3"><a class="reference internal" href="validation.html#id7">10.6.1. Bean Validationのカスタマイズ</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fieldprocessor.html">11. 独自の表・セルのマッピング方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="spring.html">12. SpringFrameworkとの連携</a><ul>
<li class="toctree-l2"><a class="reference internal" href="spring.html#id1">12.1. ライブラリの追加</a></li>
<li class="toctree-l2"><a class="reference internal" href="spring.html#xml">12.2. XMLによるコンテナの設定</a></li>
<li class="toctree-l2"><a class="reference internal" href="spring.html#javaconfig">12.3. JavaConfigによるコンテナの設定</a></li>
<li class="toctree-l2"><a class="reference internal" href="spring.html#springbean">12.4. SpringBeanとしての定義</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">13. システム設定</a></li>
<li class="toctree-l1"><a class="reference internal" href="diff_xlsbeans.html">14. XLSBeansとの違い</a><ul>
<li class="toctree-l2"><a class="reference internal" href="diff_xlsbeans.html#id1">14.1. 改善機能</a></li>
<li class="toctree-l2"><a class="reference internal" href="diff_xlsbeans.html#id2">14.2. 追加機能</a></li>
<li class="toctree-l2"><a class="reference internal" href="diff_xlsbeans.html#id3">14.3. 削除機能</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="migration.html">15. マイグレーション</a><ul>
<li class="toctree-l2"><a class="reference internal" href="migration.html#to-ver-2-0">15.1. To ver.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="migration.html#id2">15.1.1. 前提環境の変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration.html#id3">15.1.2. クラス名などの変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration.html#id4">15.1.3. アノテーションの定義の変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="migration.html#id5">15.1.4. その他の変更</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="migration.html#to-ver-1-1">15.2. To ver.1.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration.html#to-ver-1-2">15.3. To ver.1.2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release.html">16. リリースノート</a><ul>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-2-0-2018-06-30">16.1. ver.2.0 - 2018-06-30</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-6-2017-01-02">16.2. ver.1.6 - 2017-01-02</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-5-2-2016-10-30">16.3. ver.1.5.2 - 2016-10-30</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-5-1-2016-10-30">16.4. ver.1.5.1 - 2016-10-30</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-5-0-2016-08-30">16.5. ver.1.5.0 - 2016-08-30</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-4-4-2016-07-02">16.6. ver.1.4.4 - 2016-07-02</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-4-3-2016-05-28">16.7. ver.1.4.3 - 2016-05-28</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-4-2-2016-05-07">16.8. ver.1.4.2 - 2016-05-07</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-4-1-2016-04-29">16.9. ver.1.4.1 - 2016-04-29</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-4-2016-03-21">16.10. ver.1.4 - 2016-03-21</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-3-2016-03-13">16.11. ver.1.3 - 2016-03-13</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-2-1-2016-03-12">16.12. ver.1.2.1 - 2016-03-12</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-2-2016-03-12">16.13. ver.1.2 - 2016-03-12</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-1-2016-03-08">16.14. ver.1.1 - 2016-03-08</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-0a-2015-09-23">16.15. ver.1.0a - 2015-09-23</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-1-0-2015-07-19">16.16. ver.1.0 - 2015-07-19</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-5-2015-06-29">16.17. ver.0.5 - 2015-06-29</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-4-2015-04-05">16.18. ver.0.4 - 2015-04-05</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-3-2015-01-11">16.19. ver.0.3 - 2015-01-11</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-2-3-2015-01-01">16.20. ver.0.2.3 - 2015-01-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-2-2-2014-12-01">16.21. ver.0.2.2 - 2014-12-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-2-1-2014-11-25">16.22. ver.0.2.1 - 2014-11-25</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-2-2014-11-24">16.23. ver.0.2 - 2014-11-24</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#ver-0-1-2014-10-30">16.24. ver.0.1 - 2014-10-30</a></li>
</ul>
</li>
</ul>

            
          
<!-- my theme custom extramenu beacon -->
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">XlsMapper</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>4. セルの書式の指定方法</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/annotation_converter.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>4. セルの書式の指定方法<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>セルの書式を指定してマッピングする方法を説明します。</p>
<ul class="simple">
<li>読み込み時は、Excelの型とJavaの型が一致する場合、そのままマッピングします。<ul>
<li>型が一致しない場合、Excelのセルの値を文字列として取得し、その値をパースしてJavaの型に変換します。</li>
<li>文字列をパースする書式などの指定は、型ごとの専用のアノテーションを付与します。</li>
<li>各型の変換用アノテーションを付与しない場合は、アノテーションの初期値の設定を元に変換されます。</li>
</ul>
</li>
<li>書き込み時は、Javaの型に合ったExcelのセルの型で処理します。<ul>
<li>テンプレートファイルのセルの型とJavaの型が一致すれば、そのまま書き込みます。
一致しない場合は、付与されたアノテーションに従って書式などを設定します。</li>
<li>各型の変換用アノテーションを付与しない場合は、アノテーションの初期値の設定を元に変換されます。</li>
</ul>
</li>
<li>本ライブラリで対応していないクラスタイプの場合は、変換処理を実装すれば対応できます。<ul>
<li>詳細は、 <a class="reference internal" href="annotation_converter_custom.html"><span class="doc">独自のクラスタイプの対応方法</span></a> を参照してください。</li>
</ul>
</li>
</ul>
<table border="1" class="colwidths-given docutils" id="id19">
<caption><span class="caption-number">表 - 4.1 </span><span class="caption-text">ExcelとJavaのマッピング可能な型</span><a class="headerlink" href="#id19" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Excelの型</th>
<th class="head">Javaの型</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">ブール</div>
<div class="line">（TRUE/FALSE）</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">boolean/Boolean</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>文字列</td>
<td><div class="first last line-block">
<div class="line">String</div>
<div class="line">全ての型（ブール/数値/日時/Collection・配列/URL）</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">数値</div>
<div class="line">（数値/通貨/会計</div>
<div class="line-block">
<div class="line">/パーセンテージ/分数/指数）</div>
</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">byte/short/int/long/float/double/これらのラッパークラス</div>
<div class="line">/java.math.BigDecimal/java.math.BigInteger</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">日時</div>
<div class="line">（日付/時刻）</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">java.util.Date/java.util.Calendar</div>
<div class="line">/java.sql.Date/Time/Timestamp</div>
<div class="line">/java.time.LocalDateTime/LocalDate/LocalTime</div>
</div>
</td>
</tr>
<tr class="row-even"><td>文字列</td>
<td><div class="first last line-block">
<div class="line">配列</div>
<div class="line">/Collection(java.util.List/java.util.Set)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">ハイパーリンクを設定したセル</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">java.net.URI</div>
<div class="line">/com.gh.mygreen.xlsmapper.cellconvert.CellLink(本ライブラリの独自の型)</div>
</div>
</td>
</tr>
</tbody>
</table>
<table border="1" class="colwidths-given docutils" id="id20">
<caption><span class="caption-number">表 - 4.2 </span><span class="caption-text">書式を指定するアノテーション</span><a class="headerlink" href="#id20" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">アノテーション</th>
<th class="head">概要</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="annotation_converter_boolean.html#annotationxlsbooleanconverter"><span class="std std-ref">&#64;XlsBooleanConverter</span></a></td>
<td>ブール型に対する書式を指定します。</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="annotation_converter_number.html#annotationxlsnumberconverter"><span class="std std-ref">&#64;XlsNumberConverter</span></a></td>
<td>数値型に対する書式を指定します。</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="annotation_converter_datetime.html#annotationxlsdatetimeconverter"><span class="std std-ref">&#64;XlsDateTimeConverter</span></a></td>
<td>日時型に対する書式を指定します。</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="annotation_converter_enum.html#annotationxlsenumconverter"><span class="std std-ref">&#64;XlsEnumConverter</span></a></td>
<td>列挙型に対する書式を指定します。</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="annotation_converter_array.html#annotationxlsarrayconverter"><span class="std std-ref">&#64;XlsArrayConverter</span></a></td>
<td>Collection型や配列型に対する書式を指定します。</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="annotation_converter_celloption.html#annotationxlscelloption"><span class="std std-ref">&#64;XlsCellOption</span></a></td>
<td>書き込み時のセルの配置位置やインデントなどの書式を指定します。</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">書式指定用のアノテーションは、セルをマッピングするアノテーション <a class="reference internal" href="annotation_mapping_cell.html#annotationxlscell"><span class="std std-ref">&#64;XlsCell</span></a> 、 <a class="reference internal" href="annotation_mapping_labelledcell.html#annotationxlslabelledcell"><span class="std std-ref">&#64;XlsLabelledCell</span></a>、 <a class="reference internal" href="annotation_mapping_arraycells.html#annotationxlsarraycells"><span class="std std-ref">&#64;XlsArrayCells</span></a>、 <a class="reference internal" href="annotation_mapping_labelledarraycells.html#annotationxlslabelledarraycells"><span class="std std-ref">&#64;XlsLabelledArrayCells</span></a>、 <a class="reference internal" href="annotation_mapping_column.html#annotationxlscolumn"><span class="std std-ref">&#64;XlsColumn</span></a>、 <a class="reference internal" href="annotation_mapping_mapcolumns.html#annotationxlsmapcolumns"><span class="std std-ref">&#64;XlsMapColumns</span></a>、 <a class="reference internal" href="annotation_mapping_arraycolumns.html#annotationxlsarraycolumns"><span class="std std-ref">&#64;XlsArrayColumns</span></a>  を付与しているプロパティに対して有効になります。</p>
</div>
<div class="section" id="xlsbooleanconverter">
<span id="annotationxlsbooleanconverter"></span><h2>4.1. <code class="docutils literal notranslate"><span class="pre">&#64;XlsBooleanConverter</span></code><a class="headerlink" href="#xlsbooleanconverter" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Excelのセルの種類が「ブール型」以外の場合に、Javaの「boolean/Boolean」にマッピング規則を定義します。</p>
<p>単純に「true、false」以外に、「○、×」とのマッピングも可能となります。</p>
<div class="section" id="id2">
<h3>4.1.1. 読み込み時の値の指定<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>属性 <code class="docutils literal notranslate"><span class="pre">loadForTrue</span></code> 、 <code class="docutils literal notranslate"><span class="pre">loadForFalse</span></code> で読み込み時のtrueまたはfalseと判断するの候補の値を指定します。</p>
<ul class="simple">
<li>属性loadForTrueとloadForFalseの値に重複がある場合、loadForTrueの定義が優先されまます。</li>
<li>属性laodForTrueを指定しない場合、デフォルトで「&quot;true&quot;, &quot;1&quot;, &quot;yes&quot;, &quot;on&quot;, &quot;y&quot;, &quot;t&quot;」が設定されます。</li>
<li>属性loadForFalseを指定しない場合、デフォルトで「&quot;false&quot;, &quot;0&quot;, &quot;no&quot;, &quot;off&quot;, &quot;f&quot;, &quot;n&quot;」が設定されます。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">ignoreCase</span></code> の値をtrueにすると、読み込み時に大文字、小文字の区別なく候補の値と比較します。</li>
</ul>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="c1">// boolean型の読み込み時のtrueとfalseの値の変換規則を指定します。</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ステータス&quot;</span><span class="o">)</span>
    <span class="nd">@XlsBooleanConverter</span><span class="o">(</span>
            <span class="n">loadForTrue</span><span class="o">={</span><span class="s">&quot;○&quot;</span><span class="o">,</span> <span class="s">&quot;有効&quot;</span><span class="o">,</span> <span class="s">&quot;レ&quot;</span><span class="o">},</span>
            <span class="n">loadForFalse</span><span class="o">={</span><span class="s">&quot;×&quot;</span><span class="o">,</span> <span class="s">&quot;無効&quot;</span><span class="o">,</span> <span class="s">&quot;-&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">})</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">availaled</span><span class="o">;</span>

    <span class="c1">// 読み込み時の大文字・小文字の区別を行わない</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;チェック&quot;</span><span class="o">)</span>
    <span class="nd">@XlsBooleanConverter</span><span class="o">(</span>
          <span class="n">loadForTrue</span><span class="o">={</span><span class="s">&quot;OK&quot;</span><span class="o">},</span>
          <span class="n">loadForFalse</span><span class="o">={</span><span class="s">&quot;NO&quot;</span><span class="o">},</span>
          <span class="n">ignoreCase</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Boolean</span> <span class="n">checked</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id3">
<h3>4.1.2. 書き込み時の値の指定<a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>属性 <code class="docutils literal notranslate"><span class="pre">saveAsTrue</span></code> と <code class="docutils literal notranslate"><span class="pre">saveAsFalse</span></code> で書き込み時のtrueまたはfalse値に該当する文字を指定します。</p>
<ul class="simple">
<li>属性saveAsTrueを指定しない場合は、デフォルトで&quot;true&quot;が設定され、セルのタイプもブール型になります。</li>
<li>属性saveAsFalseを指定しない場合は、デフォルトで&quot;false&quot;が設定され、セルのタイプもブール型になります。</li>
<li>読み込みと書き込みの両方を行う場合、属性loadForTrueとloadForFalseの値に属性saveAsTrueとsaveAsFalseの値を含める必要があります。</li>
</ul>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="c1">// boolean型の書き込み時のtrueとfalseの値の変換規則を指定します。</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ステータス&quot;</span><span class="o">)</span>
    <span class="nd">@XlsBooleanConverter</span><span class="o">(</span>
            <span class="n">loadForTrue</span><span class="o">={</span><span class="s">&quot;○&quot;</span><span class="o">,</span> <span class="s">&quot;有効&quot;</span><span class="o">,</span> <span class="s">&quot;レ&quot;</span><span class="o">},</span> <span class="c1">// 読み書きの両方を行う場合、書き込む値を含める必要がある。</span>
            <span class="n">loadForFalse</span><span class="o">={</span><span class="s">&quot;×&quot;</span><span class="o">,</span> <span class="s">&quot;無効&quot;</span><span class="o">,</span> <span class="s">&quot;-&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">},</span>
            <span class="n">saveAsTrue</span><span class="o">=</span><span class="s">&quot;○&quot;</span><span class="o">,</span>
            <span class="n">saveAsFalse</span><span class="o">=</span><span class="s">&quot;-&quot;</span><span class="o">)</span>
    <span class="o">)</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">availaled</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id4">
<h3>4.1.3. 変換に失敗した際の処理<a class="headerlink" href="#id4" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>読み込み時にtrueまたはfalseに変換できない場合、例外TypeBindExceptionが発生します。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">failToFalse</span></code> をtrueに設定することで、変換できない場合に強制的に値をfalseとして読み込み、例外を発生しなくできます。</li>
</ul>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="c1">// 読み込み時に変換できない場合に、強制的に値をfalseとして読み込みます。</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ステータス&quot;</span><span class="o">)</span>
    <span class="nd">@XlsBooleanConverter</span><span class="o">(</span>
            <span class="n">loadForTrue</span><span class="o">={</span><span class="s">&quot;○&quot;</span><span class="o">,</span> <span class="s">&quot;有効&quot;</span><span class="o">,</span> <span class="s">&quot;レ&quot;</span><span class="o">},</span>
            <span class="n">loadForFalse</span><span class="o">={</span><span class="s">&quot;×&quot;</span><span class="o">,</span> <span class="s">&quot;無効&quot;</span><span class="o">,</span> <span class="s">&quot;-&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">},</span>
            <span class="n">failToFalse</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">availaled</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlsnumberconverter">
<span id="annotationxlsnumberconverter"></span><h2>4.2. <code class="docutils literal notranslate"><span class="pre">&#64;XlsNumberConverter</span></code><a class="headerlink" href="#xlsnumberconverter" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>数値型に対する変換規則を指定する際に利用するアノテーションです。</p>
<p>対応するJavaの型は次の通り。</p>
<ul class="simple">
<li>byte/short/int/long/float/doubleのプリミティブ型とそのラッパークラス。</li>
<li><code class="docutils literal notranslate"><span class="pre">java.math.BigDecimal</span></code> / <code class="docutils literal notranslate"><span class="pre">java.math.BigInteger</span></code> 。</li>
</ul>
<div class="section" id="id5">
<h3>4.2.1. 読み込み時の書式の指定<a class="headerlink" href="#id5" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>読み込み時にセルの種類が数値（通貨、会計、パーセンテージ、分数、指数）ではない場合、
文字列として値を取得し、その値を属性 <code class="docutils literal notranslate"><span class="pre">javaPattern</span></code> で指定した書式に従いパースし、Javaの数値型に変換します。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">javaPattern</span></code> で読み込み時の書式を指定します。 <cite>[ver1.1+]</cite><ul>
<li>Javaのクラス <code class="docutils literal notranslate"><span class="pre">java.text.DecimalFormat</span></code> で解釈可能な書式を設定します。</li>
<li>ver1.0以前は、属性patternを使っていましたが、廃止になりました。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">locale</span></code> でロケールを指定します。<ul>
<li>言語コードのみを指定する場合、'ja'の2桁で指定します。</li>
<li>言語コードと国コードを指定する場合、'ja _JP'のようにアンダーバーで区切り指定します。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">currency</span></code> で通貨コード（ISO-4217コード）を指定します。<ul>
<li>Javaのクラス <code class="docutils literal notranslate"><span class="pre">java.util.Currency</span></code> で解釈可能なコードを指定します。</li>
</ul>
</li>
<li>書式に合わない値をパースした場合、例外 <code class="docutils literal notranslate"><span class="pre">TypeBindException</span></code> が発生します。</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id21">
<div class="code-block-caption"><span class="caption-number">コード - 4.2.1 </span><span class="caption-text">読み込み時の指定方法</span><a class="headerlink" href="#id21" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;給与&quot;</span><span class="o">)</span>
    <span class="nd">@XlsNumberConverter</span><span class="o">(</span><span class="n">javaPattern</span><span class="o">=</span><span class="s">&quot;\u00A4\u00A4 #,##0.0000&quot;</span><span class="o">,</span> <span class="n">locale</span><span class="o">=</span><span class="s">&quot;ja_JP&quot;</span><span class="o">,</span> <span class="n">currency</span><span class="o">=</span><span class="s">&quot;USD&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">salary</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="id6">
<h3>4.2.2. 書き込み時の書式の指定<a class="headerlink" href="#id6" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>書き込み時の書式は、基本的にテンプレートファイルに設定してある値を使用します。
また、アノテーションでも直接指定することができます。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">excelPattern</span></code> で書き込み時の書式を指定します。 <cite>[ver1.1+]</cite><ul>
<li>Excelの書式を指定する場合は、 <a class="reference external" href="http://mygreen.github.io/excel-cellformatter/sphinx/format_basic.html">ユーザ定義</a> の形式で指定する必要があります。</li>
</ul>
</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id22">
<div class="code-block-caption"><span class="caption-number">コード - 4.2.2 </span><span class="caption-text">書き込み時の指定方法</span><a class="headerlink" href="#id22" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;給与&quot;</span><span class="o">)</span>
    <span class="nd">@XlsNumberConverter</span><span class="o">(</span><span class="n">javaPattern</span><span class="o">=</span><span class="s">&quot;[$-411]\&quot;￥\&quot;#,##0.0000&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">salary</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>テンプレートファイルのセルの書式を「標準」に設定している場合に書き込むと、
書式が「標準」設定の全てのセルの書式が書き換わってしまいます。</p>
<p class="last">そのため、日付や数値などの書式が必要な場合は、テンプレートファイルで予め書式を設定しておくか、
アノテーションの属性excelPatternで書式を指定しておいてください。</p>
</div>
</div>
<div class="section" id="id8">
<h3>4.2.3. 有効桁数の指定<a class="headerlink" href="#id8" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Excel内部とJavaの数値は、表現可能な有効桁数が異なります。</p>
<p>そのため、特に読み込み時などExcelの仕様に合わせてJavaのクラスに指定することが可能です。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">precision</span></code> で有効桁数を指定します。 <cite>[ver0.5+]</cite><ul>
<li>0以下の値を設定すると、桁数の指定を省略したことになり、無制限になります。</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>Excelでは有効桁数が15桁であるため、Javaのlong型など15桁を超える表現が可能な数値を書き込んだ場合、数値が丸められるため注意してください。</p>
<ul class="last simple">
<li>例えば、long型の19桁の数値 <code class="docutils literal notranslate"><span class="pre">1234567890123456789</span></code> を書き込んだ場合、16桁以降の値が丸められ <code class="docutils literal notranslate"><span class="pre">1234567890123450000</span></code> として書き込まれます。</li>
<li>Excelの仕様については、<a class="reference external" href="https://support.office.com/ja-jp/article/Excel-%E3%81%AE%E4%BB%95%E6%A7%98%E3%81%A8%E5%88%B6%E9%99%90-1672b34d-7043-467e-8e27-269d656771c3?ui=ja-JP&amp;rs=ja-JP&amp;ad=JP">Excel の仕様と制限</a> を参照してください。</li>
</ul>
</div>
</div>
</div>
<div class="section" id="xlsdatetimeconverter">
<span id="annotationxlsdatetimeconverter"></span><h2>4.3. <code class="docutils literal notranslate"><span class="pre">&#64;XlsDateTimeConverter</span></code><a class="headerlink" href="#xlsdatetimeconverter" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>日時型に対する変換規則を指定する際に利用するアノテーションです。</p>
<p>対応するJavaのクラスタイプと、アノテーションを付与していないときに適用されるの標準の書式は以下の通りです。</p>
<table border="1" class="colwidths-given docutils" id="id23">
<caption><span class="caption-number">表 - 4.3.1 </span><span class="caption-text">対応する日時のクラスタイプと標準の書式</span><a class="headerlink" href="#id23" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">クラスタイプ</th>
<th class="head">標準の書式</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">java.util.Date</span></code></td>
<td><em>yyyy-MM-dd HH:mm:ss</em></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">java.util.Calendar</span></code></td>
<td><em>yyyy-MM-dd HH:mm:ss</em></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">java.sql.Date</span></code></td>
<td><em>yyyy-MM-dd</em></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">java.sql.Time</span></code></td>
<td><em>HH:mm:ss</em></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">java.sql.Timestamp</span></code></td>
<td><em>yyyy-MM-dd HH:mm:ss.SSS</em></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">java.time.LocalDateTime</span></code></td>
<td><em>uuuu-MM-dd HH:mm:ss</em></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">java.time.LocalDate</span></code></td>
<td><em>uuuu-MM-dd</em></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">java.time.LocalTime</span></code></td>
<td><em>HH:mm:ss</em></td>
</tr>
</tbody>
</table>
<div class="section" id="id9">
<h3>4.3.1. 読み込み時の書式の指定<a class="headerlink" href="#id9" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>読み込み時にセルの種類が日付、時刻ではない場合、文字列として値を取得し、
その値を属性 <code class="docutils literal notranslate"><span class="pre">javaPattern</span></code> で指定した書式に従いパースし、Javaの日時型に変換します。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">javaPattern</span></code> で書式を指定します。 <cite>[ver1.1+]</cite><ul>
<li>java.util.Date/java.util.Calendar/java.sql.XXXX系のクラスの場合、 <a class="reference external" href="https://docs.oracle.com/javase/jp/8/docs/api/java/text/SimpleDateFormat.html">java.text.SimpleDateFormat</a> で解釈可能な書式を設定します。</li>
<li>java.time.XXX系のクラスの場合、 <a class="reference external" href="https://docs.oracle.com/javase/jp/8/docs/api/java/time/format/DateTimeFormatter.html">java.time.format.DateTimeFormatter</a> で解釈可能な書式を設定します。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">locale</span></code> でロケールを指定します。<ul>
<li>言語コードのみを指定する場合、'ja'の2桁で指定します。</li>
<li>言語コードと国コードを指定する場合、'ja _JP'のようにアンダーバーで区切り指定します。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">lenient</span></code> で、日付/時刻の解析を厳密に行わないか指定します。<ul>
<li>trueの厳密に解析を行いません。falseの場合厳密に解析を行います。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">timezone</span></code> でタイムゾーンを指定します。<ul>
<li>Asia/Tokyo, GMT, GMT+09:00などの値を指定します。</li>
<li>ただし、オフセットを持たないクラスタイプ「LocalDateTime, LocalDate, LocalTime」の時は、指定しても意味がありません。</li>
</ul>
</li>
<li>書式に合わない値をパースした場合、例外 <code class="docutils literal notranslate"><span class="pre">TypeBindException</span></code> が発生します。</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id24">
<div class="code-block-caption"><span class="caption-number">コード - 4.3.1 </span><span class="caption-text">読み込み時の書式の指定</span><a class="headerlink" href="#id24" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;有効期限&quot;</span><span class="o">)</span>
    <span class="nd">@XlsDateTimeConverter</span><span class="o">(</span><span class="n">javaPattern</span><span class="o">=</span><span class="s">&quot;yyyy年MM月dd日 HH時mm分ss秒&quot;</span><span class="o">,</span> <span class="n">locale</span><span class="o">=</span><span class="s">&quot;ja_JP&quot;</span><span class="o">,</span>
            <span class="n">lenient</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">expired</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>読み込み時のセルの値が属性javaPatternで指定した書式に一致していなくても、セルのタイプが日付または時刻の場合は、例外の発生なく読み込むことができます。
セルの表示形式の分類が文字列の場合は、アノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsDateTimeConverter(javaPattern=&quot;&lt;書式&gt;&quot;)</span></code> で指定した書式に従い処理されます。</p>
<p class="last">ただし、型変換用のアノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsDateTimeConverter</span></code> を付与しない場合は、Javaの型ごとに上記の書式が標準で適用されます。<cite>[ver0.5+]</cite></p>
</div>
</div>
<div class="section" id="id10">
<h3>4.3.2. 書き込み時の書式の指定<a class="headerlink" href="#id10" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>書き込み時の書式は、基本的にテンプレートファイルに設定してある値を使用します。
また、アノテーションでも直接指定することができます。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">excelPattern</span></code> で書き込み時の書式を指定します。 <cite>[ver1.1+]</cite><ul>
<li>Excelの書式を指定する場合は、 <a class="reference external" href="http://mygreen.github.io/excel-cellformatter/sphinx/format_basic.html">ユーザ定義</a> の形式で指定する必要があります。</li>
</ul>
</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id25">
<div class="code-block-caption"><span class="caption-number">コード - 4.3.2 </span><span class="caption-text">書き込み時の書式の指定</span><a class="headerlink" href="#id25" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;有効期限&quot;</span><span class="o">)</span>
    <span class="nd">@XlsDateTimeConverter</span><span class="o">(</span><span class="n">excelPattern</span><span class="o">=</span><span class="s">&quot;[$-411]yyyy\&quot;年\&quot;mm\&quot;月\&quot;dd\&quot;日\&quot; hh\&quot;時\&quot;mm\&quot;分\&quot;ss\&quot;秒\&quot;&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">expired</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>テンプレートファイルのセルの書式を「標準」に設定している場合に書き込むと、
書式が「標準」設定の全てのセルの書式が書き換わってしまいます。</p>
<p class="last">そのため、日付や数値などの書式が必要な場合は、テンプレートファイルで予め書式を設定しておくか、
アノテーションの属性excelPatternで書式を指定しておいてください。</p>
</div>
</div>
</div>
<div class="section" id="xlsenumconverter">
<span id="annotationxlsenumconverter"></span><h2>4.4. <code class="docutils literal notranslate"><span class="pre">&#64;XlsEnumConverter</span></code><a class="headerlink" href="#xlsenumconverter" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>列挙型の変換規則の設定を行います。</p>
<div class="section" id="id12">
<h3>4.4.1. 基本的な使い方<a class="headerlink" href="#id12" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>セルの値と列挙型の要素の値をマッピングさせます。</p>
<p>要素の値とは、 <code class="docutils literal notranslate"><span class="pre">Enum#name()</span></code> の値です。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">ignoreCase</span></code> の値をtrueにすると、読み込み時に大文字/小文字の区別なく変換します。</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id26">
<div class="code-block-caption"><span class="caption-number">コード - 4.4.1 </span><span class="caption-text">列挙型の変換規則の指定方法</span><a class="headerlink" href="#id26" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="c1">// 列挙型のマッピング</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;権限&quot;</span><span class="o">)</span>
    <span class="nd">@XlsEnumConverter</span><span class="o">(</span><span class="n">ignoreCase</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">RoleType</span> <span class="n">role</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// 列挙型の定義</span>
<span class="kd">public</span> <span class="kd">enum</span> <span class="n">RoleType</span> <span class="o">{</span>
    <span class="n">Normal</span><span class="o">,</span> <span class="n">Admin</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="id13">
<h3>4.4.2. 別名でマッピングする場合<a class="headerlink" href="#id13" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>別名でマッピングする場合、属性 <code class="docutils literal notranslate"><span class="pre">aliasMethod</span></code> で列挙型の要素の別名を取得するメソッド名を指定します。</p>
<div class="literal-block-wrapper docutils container" id="id27">
<div class="code-block-caption"><span class="caption-number">コード - 4.4.2 </span><span class="caption-text">列挙型を別名でマッピングする方法</span><a class="headerlink" href="#id27" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="c1">// 別名による列挙型のマッピング</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;権限&quot;</span><span class="o">)</span>
    <span class="nd">@XlsEnumConverter</span><span class="o">(</span><span class="n">aliasMethod</span><span class="o">=</span><span class="s">&quot;localeName&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">RoleType</span> <span class="n">role</span><span class="o">;</span>

<span class="o">}</span>

<span class="c1">// 列挙型の定義</span>
<span class="kd">public</span> <span class="kd">enum</span> <span class="n">RoleType</span> <span class="o">{</span>
    <span class="n">Normal</span><span class="o">(</span><span class="s">&quot;一般権限&quot;</span><span class="o">),</span> <span class="n">Admin</span><span class="o">(</span><span class="s">&quot;管理者権限&quot;</span><span class="o">);</span>

    <span class="c1">// 別名の設定</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">localeName</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nf">RoleType</span><span class="o">(</span><span class="n">String</span> <span class="n">localeName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">localeName</span> <span class="o">=</span> <span class="n">localeName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// 別名の取得用メソッド</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">localeName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">localeName</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>
<div class="section" id="xlsarrayconverter">
<span id="annotationxlsarrayconverter"></span><h2>4.5. <code class="docutils literal notranslate"><span class="pre">&#64;XlsArrayConverter</span></code><a class="headerlink" href="#xlsarrayconverter" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>配列またはCollection型（List, Set）の変換規則の設定を行います。</p>
<div class="section" id="id14">
<h3>4.5.1. 基本的な使い方<a class="headerlink" href="#id14" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Collection型のインタフェースを指定している場合、読み込み時のインスタンスは次のクラスが指定されます。</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">java.util.List</span></code> の場合、<code class="docutils literal notranslate"><span class="pre">java.util.ArrayList</span></code> がインスタンスのクラスとなります。</li>
<li><code class="docutils literal notranslate"><span class="pre">java.util.Set</span></code> の場合、<code class="docutils literal notranslate"><span class="pre">java.util.LinkedHashSet</span></code> がインスタンスのクラスとなります。</li>
</ul>
<p>配列、またはCollection型の要素で指定可能なクラス型は、次の通りです。
任意のクラス型に対応する場合は、属性 <code class="docutils literal notranslate"><span class="pre">elementConverter</span></code> で変換処理クラスを指定してください。</p>
<ul class="simple">
<li>String型</li>
<li>プリミティブ型「boolean/char/byte/short/int/long/float/double」と、そのラッパークラス。</li>
<li><code class="docutils literal notranslate"><span class="pre">java.math.BigDecimal</span></code> / <code class="docutils literal notranslate"><span class="pre">java.math.BigInteger</span></code></li>
</ul>
<p>文字列のセルに対して、任意の区切り文字を指定し、配列やListに対してマッピングします。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">separator</span></code> で区切り文字を指定します。<ul>
<li>区切り文字の初期値は、半角カンマ(,)です。</li>
</ul>
</li>
<li>トリム用アノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsTrim</span></code> を付与し、トリム処理を有効にしている設定の場合、区切った項目にもトリム処理が適用されます。 <cite>[ver0.5+]</cite></li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">ignoreEmptyElement</span></code> の値をtrueに設定していると、トリム処理によって項目が空文字となった場合、その項目は無視されます。</li>
</ul>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="c1">// 区切り文字の指定</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;リスト&quot;</span><span class="o">)</span>
    <span class="nd">@XlsArrayConverter</span><span class="o">(</span><span class="n">separator</span><span class="o">=</span><span class="s">&quot;\n&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>

    <span class="c1">// 要素のトリム処理を指定する</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;配列&quot;</span><span class="o">)</span>
    <span class="nd">@XlsTrim</span>    <span class="c1">// 区切った配列の要素にもトリムが適用されます。</span>
    <span class="nd">@XlsArrayConverter</span><span class="o">(</span><span class="n">separator</span><span class="o">=</span><span class="s">&quot;,&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">array</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id15">
<h3>4.5.2. 空の要素を無視する場合<a class="headerlink" href="#id15" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>属性 <code class="docutils literal notranslate"><span class="pre">ignoreEmptyElement</span></code> で、区切った項目の値が空文字の場合、無視するか指定します。</p>
<p>例えば、区切り文字&quot;,&quot;のとき、セルの値が <code class="docutils literal notranslate"><span class="pre">&quot;a,,b&quot;</span></code> の場合、trueを設定すると <code class="docutils literal notranslate"><span class="pre">[&quot;a&quot;,</span> <span class="pre">&quot;b&quot;]</span></code> として読み込みます。</p>
<p>書き込み時も同様に、値が空またはnullの項目を無視します。</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="c1">// 空の要素を無視する場合</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;集合&quot;</span><span class="o">)</span>
    <span class="nd">@XlsArrayConverter</span><span class="o">(</span><span class="n">ignoreEmptyElement</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">set</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id16">
<h3>4.5.3. 要素の値を変換するクラスを指定する<a class="headerlink" href="#id16" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>属性 <code class="docutils literal notranslate"><span class="pre">elementConverter</span></code> で要素の値を変換するクラスを指定することができます。 <cite>[ver1.1+]</cite></p>
<p>変換するクラスは、インタフェース <code class="docutils literal notranslate"><span class="pre">com.gh.mygreen.xlsmapper.cellconvert.ElementConverter</span></code> を実装している必要があります。
標準では、<code class="docutils literal notranslate"><span class="pre">com.gh.mygreen.xlsmapper.cellconvert.DefaultElementConverter</span></code> が使用され、基本的な型のみサポートしています。</p>
<p>インスタンスは、システム設定「beanFactory」経由で作成されるため、<a class="reference internal" href="spring.html"><span class="doc">SpringFrameworkのコンテナからインスタンスを取得</span></a> することもできます。</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// 変換用クラス</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomElementConverter</span> <span class="kd">implements</span> <span class="n">ElementConverter</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">User</span> <span class="nf">convertToObject</span><span class="o">(</span><span class="kd">final</span> <span class="n">String</span> <span class="n">str</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Class</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">targetClass</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ConversionException</span> <span class="o">{</span>
        <span class="c1">//TODO: 文字列 =&gt; オブジェクトに変換する処理</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">convertToString</span><span class="o">(</span><span class="kd">final</span> <span class="n">User</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//TODO: オブジェクト =&gt; 文字列に変換する処理</span>
    <span class="o">}</span>

<span class="o">}</span>

<span class="c1">// レコード用クラス</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="c1">// 任意のクラス型の要素の値を変換するElementConverterを指定します。</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;リスト&quot;</span><span class="o">)</span>
    <span class="nd">@XlsArrayConverter</span><span class="o">(</span><span class="n">elementConverter</span><span class="o">=</span><span class="n">CustomElementConverter</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="xlscelloption">
<span id="annotationxlscelloption"></span><h2>4.6. <code class="docutils literal notranslate"><span class="pre">&#64;XlsCellOption</span></code><a class="headerlink" href="#xlscelloption" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>書き込み時のセルの配置位置やインデントなどの書式を指定します。</p>
<p>書き込み時は、テンプレート側のシートでセルの位置などを指定しておけば、それらの設定が引き継がれます。</p>
<p>ただし、アノテーションを付与することで、テンプレート側のシートと異なる設定に変更することもできます。</p>
<ul class="simple">
<li>属性 <code class="docutils literal notranslate"><span class="pre">wrapText</span></code> の値がtrueの場合、強制的にセルの内の文字表示の設定「折り返して全体を表示する」が有効になります。<ul>
<li>falseの場合、テンプレートとなるセルの設定を引き継ぎます。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">shrinkToFit</span></code> の値がtrueの場合、強制的にセル内の文字表示の設定「縮小して全体を表示する」が有効になります。<ul>
<li>falseの場合、テンプレートとなるセルの設定を引き継ぎます。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">indent</span></code> でインデントを指定することができます。<ul>
<li>インデントが指定可能な横位置(左詰め/右詰め/均等割り付け)のときのみ有効になります。</li>
<li>-1 以下の時は、現在の設定を引き継ぎます。</li>
</ul>
</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">horizontalAlign</span></code> でセルの横位置を指定することができます。</li>
<li>属性 <code class="docutils literal notranslate"><span class="pre">verticalAlign</span></code> でセルの縦位置を指定することができます。</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id28">
<div class="code-block-caption"><span class="caption-number">コード - 4.6.1 </span><span class="caption-text">セルの配置の指定</span><a class="headerlink" href="#id28" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

    <span class="c1">// 「縮小して全体を表示する」が有効になる。</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;ID&quot;</span><span class="o">)</span>
    <span class="nd">@XlsCellOption</span><span class="o">(</span><span class="n">wrapText</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="c1">//「折り返して全体を表示する」が有効になる。</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;名前&quot;</span><span class="o">)</span>
    <span class="nd">@XlsCellOption</span><span class="o">(</span><span class="n">shrinkToFit</span><span class="o">=</span><span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="c1">// セルの横位置、縦位置の指定</span>
    <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;備考&quot;</span><span class="o">)</span>
    <span class="nd">@XlsCellOption</span><span class="o">(</span><span class="n">horizontalAlign</span><span class="o">=</span><span class="n">HorizontalAlign</span><span class="o">.</span><span class="na">Center</span><span class="o">,</span> <span class="n">verticalAlign</span><span class="o">=</span><span class="n">VerticalAlign</span><span class="o">.</span><span class="na">Top</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">comment</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">Excelの仕様上、設定「折り返して全体を表示する」と「縮小して全体を表示する」は、二者択一であるため、両方の設定を有効にすることはできません。
もし、属性wrapTextとshrinkToFitの値をtrueに設定した場合、shrinkToFitの設定が優先され、「縮小して全体を表示する」が有効になります。</p>
</div>
</div>
<div class="section" id="id17">
<h2>4.7. 独自のクラスタイプの対応方法<a class="headerlink" href="#id17" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Excelのセルの値を任意のJavaのクラス型にマッピングする方法を説明します。</p>
<ol class="arabic simple">
<li>CellConverterの実装クラスの作成</li>
<li>CellConverterを作成するためのファクトリクラスの作成</li>
<li>アノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsConverter</span></code> による指定</li>
</ol>
<div class="section" id="cellconverter">
<h3>4.7.1. CellConverterの実装クラスの作成<a class="headerlink" href="#cellconverter" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Excelのセルの値をJavaの任意のクラスにマッピングするには、CellConveterを実装します。</p>
<p>次のように、タイトルとリストが組み合わさったテキストをCustomTypeクラスにマッピングするとします。</p>
<div class="literal-block-wrapper docutils container" id="id29">
<div class="code-block-caption"><span class="caption-number">コード - 4.7.1 </span><span class="caption-text">マッピング対象の値</span><a class="headerlink" href="#id29" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>タイトル
<span class="k">-</span> リスト1
<span class="k">-</span> リスト2
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id30">
<div class="code-block-caption"><span class="caption-number">コード - 4.7.2 </span><span class="caption-text">マッピングするJavaクラス</span><a class="headerlink" href="#id30" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomType</span> <span class="o">{</span>

     <span class="cm">/** タイトル */</span>
     <span class="kd">private</span> <span class="n">String</span> <span class="n">title</span><span class="o">;</span>

     <span class="cm">/** リスト */</span>
     <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">items</span><span class="o">;</span>

     <span class="cm">/**</span>
<span class="cm">      * リストの要素を追加する</span>
<span class="cm">      * @param リストの要素</span>
<span class="cm">      */</span>
     <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addItem</span><span class="o">(</span><span class="n">String</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
         <span class="k">if</span><span class="o">(</span><span class="n">items</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
             <span class="k">this</span><span class="o">.</span><span class="na">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
         <span class="o">}</span>
         <span class="k">this</span><span class="o">.</span><span class="na">items</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
     <span class="o">}</span>

     <span class="c1">// setter, getterは省略</span>

 <span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<ul class="simple">
<li>インタフェース <code class="docutils literal notranslate"><span class="pre">com.gh.mygreen.xlsmapper.cellconvert.CellConverter</span></code> を実装します。<ul>
<li>実際には、ユーティリティメソッドがそろっている、<code class="docutils literal notranslate"><span class="pre">com.gh.mygreen.xlsmapper.cellconverter.BaseCellConverter</span></code> を継承して実装します。</li>
<li>読み込み時、書き込み時のそれぞれのメソッドを実装します。<ul>
<li>文字列に対するマッピングの場合は、<code class="docutils literal notranslate"><span class="pre">TextFormatter</span></code> の <code class="docutils literal notranslate"><span class="pre">parse/format</span></code> メソッドに委譲します。</li>
<li><code class="docutils literal notranslate"><span class="pre">TextFormatter</span></code> の実装は、後の <code class="docutils literal notranslate"><span class="pre">CellConverterFactory</span></code> の作成にて実装します。</li>
</ul>
</li>
<li>実装のサンプルは、パッケージ <code class="docutils literal notranslate"><span class="pre">com.gh.mygreen.xlsmapper.cellconvert.impl</span></code> 以下に格納されているクラスを参照してください。</li>
</ul>
</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id31">
<div class="code-block-caption"><span class="caption-number">コード - 4.7.3 </span><span class="caption-text">CellConverterの実装</span><a class="headerlink" href="#id31" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomCellConverter</span> <span class="kd">extends</span> <span class="n">BaseCellConverter</span><span class="o">&lt;</span><span class="n">CustomType</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">CustomCellConverter</span><span class="o">(</span><span class="n">FieldAccessor</span> <span class="n">field</span><span class="o">,</span> <span class="n">Configuration</span> <span class="n">config</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">field</span><span class="o">,</span> <span class="n">config</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * セルをJavaのオブジェクト型に変換します。</span>
<span class="cm">     * @param evaluatedCell 数式を評価済みのセル</span>
<span class="cm">     * @param formattedValue フォーマット済みのセルの値。トリミングなど適用済み。</span>
<span class="cm">     * @return 変換した値を返す。</span>
<span class="cm">     * @throws TypeBindException 変換に失敗した場合</span>
<span class="cm">     */</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">CustomType</span> <span class="nf">parseCell</span><span class="o">(</span><span class="n">Cell</span> <span class="n">evaluatedCell</span><span class="o">,</span> <span class="n">String</span> <span class="n">formattedValue</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">TypeBindException</span> <span class="o">{</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="c1">// 文字列を変換するときには、TextFormatter#parseに委譲します。</span>
            <span class="k">return</span> <span class="n">getTextFormatter</span><span class="o">().</span><span class="na">parse</span><span class="o">(</span><span class="n">formattedValue</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">TextParseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="n">newTypeBindExceptionOnParse</span><span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="n">evaluatedCell</span><span class="o">,</span> <span class="n">formattedValue</span><span class="o">);</span>
        <span class="o">}</span>

    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * 書き込み時のセルに値と書式を設定します。</span>
<span class="cm">     * @param cell 設定対象のセル</span>
<span class="cm">     * @param cellValue 設定対象の値。</span>
<span class="cm">     * @throws TypeBindException 変換に失敗した場合</span>
<span class="cm">     */</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">setupCell</span><span class="o">(</span><span class="n">Cell</span> <span class="n">cell</span><span class="o">,</span> <span class="n">Optional</span><span class="o">&lt;</span><span class="n">CustomType</span><span class="o">&gt;</span> <span class="n">cellValue</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">TypeBindException</span> <span class="o">{</span>

        <span class="k">if</span><span class="o">(</span><span class="n">cellValue</span><span class="o">.</span><span class="na">isPresent</span><span class="o">())</span> <span class="o">{</span>
            <span class="c1">// 文字列を変換するときには、TextFormatter#formatに委譲します。</span>
            <span class="n">String</span> <span class="n">text</span> <span class="o">=</span> <span class="n">getTextFormatter</span><span class="o">().</span><span class="na">format</span><span class="o">(</span><span class="n">cellValue</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
            <span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">text</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">cell</span><span class="o">.</span><span class="na">setCellType</span><span class="o">(</span><span class="n">CellType</span><span class="o">.</span><span class="na">BLANK</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="cellconverterfactory">
<h3>4.7.2. CellConverterFactoryの実装クラスの作成<a class="headerlink" href="#cellconverterfactory" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>インタフェース <code class="docutils literal notranslate"><span class="pre">com.gh.mygreen.xlsmapper.cellconverter.CellConverterFactory</span></code> を実装する。<ul>
<li>実際には、サポートメソッドが揃っている <code class="docutils literal notranslate"><span class="pre">com.gh.mygreen.xlsmapper.cellconverter.CellConverterFactorySupport</span></code> を継承し作成します。</li>
<li>実装のサンプルは、パッケージ <code class="docutils literal notranslate"><span class="pre">com.gh.mygreen.xlsmapper.cellconvert.impl</span></code> 以下に格納されているクラスを参照してください。</li>
</ul>
</li>
<li>文字列に対する処理として、 <code class="docutils literal notranslate"><span class="pre">TexFormatter</span></code> を実装します。<ul>
<li><code class="docutils literal notranslate"><span class="pre">TextFromatter#parse</span></code> は、初期値を <code class="docutils literal notranslate"><span class="pre">&#64;XlsDefaltValue(&quot;&lt;初期値&gt;&quot;)</span></code> で与えられているときに、文字列をオブジェクトに変換する際に使用します。</li>
<li><code class="docutils literal notranslate"><span class="pre">TextFormatter#format</span></code> は、Validationのエラーメッセージ中で値をフォーマットするときに、オブジェクトを文字列に変換する際に使用します。</li>
</ul>
</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id32">
<div class="code-block-caption"><span class="caption-number">コード - 4.7.4 </span><span class="caption-text">CellConverterFactoryの実装</span><a class="headerlink" href="#id32" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * フィールドに対するセル変換クラスを作成する。</span>
<span class="cm"> * @param accessor フィールド情報</span>
<span class="cm"> * @param config システム設定</span>
<span class="cm"> * @return セルの変換クラス。</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomCellConverterFactory</span> <span class="kd">extends</span> <span class="n">CellConverterFactorySupport</span><span class="o">&lt;</span><span class="n">CustomType</span><span class="o">&gt;</span>
            <span class="kd">implements</span> <span class="n">CellConverterFactory</span><span class="o">&lt;</span><span class="n">CustomType</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">CustomCellConverter</span> <span class="nf">create</span><span class="o">(</span><span class="n">FieldAccessor</span> <span class="n">accessor</span><span class="o">,</span> <span class="n">Configuration</span> <span class="n">config</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">final</span> <span class="n">CustomCellConverter</span> <span class="n">cellConverter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CustomCellConverter</span><span class="o">(</span><span class="n">accessor</span><span class="o">,</span> <span class="n">config</span><span class="o">);</span>

        <span class="c1">// トリムなどの共通の処理を設定する</span>
        <span class="n">setupCellConverter</span><span class="o">(</span><span class="n">cellConverter</span><span class="o">,</span> <span class="n">accessor</span><span class="o">,</span> <span class="n">config</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">cellConverter</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">setupCustom</span><span class="o">(</span><span class="n">AbstractCellConverter</span><span class="o">&lt;</span><span class="n">CustomType</span><span class="o">&gt;</span> <span class="n">cellConverter</span><span class="o">,</span> <span class="n">FieldAccessor</span> <span class="n">field</span><span class="o">,</span> <span class="n">Configuration</span> <span class="n">config</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// 必要があれば実装する。</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * {@link TextFormatter}のインスタンスを作成する。</span>
<span class="cm">     * @param field フィールド情報</span>
<span class="cm">     * @param config システム情報</span>
<span class="cm">     * @return {@link TextFormatter}のインスタンス</span>
<span class="cm">     */</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">TextFormatter</span><span class="o">&lt;</span><span class="n">CustomType</span><span class="o">&gt;</span> <span class="nf">createTextFormatter</span><span class="o">(</span><span class="n">FieldAccessor</span> <span class="n">field</span><span class="o">,</span> <span class="n">Configuration</span> <span class="n">config</span><span class="o">)</span> <span class="o">{</span>

        <span class="k">return</span> <span class="k">new</span> <span class="n">TextFormatter</span><span class="o">&lt;</span><span class="n">CustomType</span><span class="o">&gt;()</span> <span class="o">{</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="n">CustomType</span> <span class="nf">parse</span><span class="o">(</span><span class="n">String</span> <span class="n">text</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">TextParseException</span> <span class="o">{</span>

                <span class="k">if</span><span class="o">(</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">text</span><span class="o">))</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
                <span class="o">}</span>

                <span class="c1">// 改行で分割する</span>
                <span class="n">String</span><span class="o">[]</span> <span class="n">split</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&quot;\r\n|\n&quot;</span><span class="o">);</span>

                <span class="k">if</span><span class="o">(</span><span class="n">split</span><span class="o">.</span><span class="na">length</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
                    <span class="c1">// 1行以下しかない場合は、例外とする</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="n">TextParseException</span><span class="o">(</span><span class="n">text</span><span class="o">,</span> <span class="n">CustomType</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
                <span class="o">}</span>

                <span class="n">CustomType</span> <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CustomType</span><span class="o">();</span>
                <span class="n">data</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="n">split</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>

                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">split</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                    <span class="n">String</span> <span class="n">item</span> <span class="o">=</span> <span class="n">split</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
                    <span class="k">if</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">&quot;- &quot;</span><span class="o">))</span> <span class="o">{</span>
                        <span class="c1">// リストの記号を削除する</span>
                        <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
                    <span class="o">}</span>
                    <span class="n">data</span><span class="o">.</span><span class="na">addItem</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
                <span class="o">}</span>

                <span class="k">return</span> <span class="n">data</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="n">String</span> <span class="nf">format</span><span class="o">(</span><span class="n">CustomType</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span><span class="o">(</span><span class="n">value</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
                <span class="o">}</span>

                <span class="n">StringBuilder</span> <span class="n">text</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
                <span class="n">text</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">getTitle</span><span class="o">())</span>
                    <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;\n&quot;</span><span class="o">);</span>

                <span class="c1">// 改行で繋げる</span>
                <span class="n">text</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">getItems</span><span class="o">().</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">joining</span><span class="o">(</span><span class="s">&quot;\n&quot;</span><span class="o">)));</span>
                <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
            <span class="o">}</span>

        <span class="o">};</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="id18">
<h3>4.7.3. 作成したCellConverterの使用方法<a class="headerlink" href="#id18" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>作成したCellConverterを使用するには、2つの方法があります。</p>
<div class="section" id="xlsconverter">
<span id="annotationxlsconverter"></span><h4>4.7.3.1. <code class="docutils literal notranslate"><span class="pre">&#64;XlsConverter</span></code> を使用する方法<a class="headerlink" href="#xlsconverter" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>作成した CellConverterFactoryの実装クラスをアノテーション <code class="docutils literal notranslate"><span class="pre">&#64;XlsConverter</span></code> に指定します。</p>
<div class="literal-block-wrapper docutils container" id="id33">
<div class="code-block-caption"><span class="caption-number">コード - 4.7.5 </span><span class="caption-text">XlsConverterアノテーションによる指定</span><a class="headerlink" href="#id33" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleRecord</span> <span class="o">{</span>

     <span class="c1">// 独自のCellConverterFactoryの指定</span>
     <span class="nd">@XlsConverter</span><span class="o">(</span><span class="n">CustomCellConverterFactory</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
     <span class="nd">@XlsColumn</span><span class="o">(</span><span class="n">columnName</span><span class="o">=</span><span class="s">&quot;TODOリスト&quot;</span><span class="o">)</span>
     <span class="kd">private</span> <span class="n">CustomType</span> <span class="n">value</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="cellconverterregistry">
<h4>4.7.3.2. CellConverterRegistry を使用する方法<a class="headerlink" href="#cellconverterregistry" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>作成した CellConverterFactoryの実装クラスのインスタンスを <code class="docutils literal notranslate"><span class="pre">XlsMapperConfg#getConverterRegistry()</span></code> に登録します。</p>
<div class="literal-block-wrapper docutils container" id="id34">
<div class="code-block-caption"><span class="caption-number">コード - 4.7.6 </span><span class="caption-text">CellConverterRegistryへの登録</span><a class="headerlink" href="#id34" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// 独自のCellConverterFactoryの登録</span>
<span class="n">XlsMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XlsMapper</span><span class="o">();</span>
<span class="n">CellConverterRegistry</span> <span class="n">cellConverterRegistry</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getConiguration</span><span class="o">().</span><span class="na">getConverterRegistry</span><span class="o">();</span>
<span class="n">cellConverterRegistry</span><span class="o">.</span><span class="na">registerConverter</span><span class="o">(</span><span class="n">CustomType</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="k">new</span> <span class="n">CustomCellConverterFactory</span><span class="o">());</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="annotation_valueconverter.html" class="btn btn-neutral float-right" title="5. セルの値の変換方法" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="annotation_mapping.html" class="btn btn-neutral" title="3. 表・セルのマッピング方法" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2018, T.TSUCHIE.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0',
            LANGUAGE:'ja',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="_static/mytheme.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<!-- my theme custom extrahead beacon -->
<script type="text/javascript" src="_static/jquery.externallink.js" charset="UTF-8"></script>
<script type="text/javascript">
	jQuery(function () {
		// ナビゲーション用のアイコン
		$('div.wy-menu').externalLink({cssClass : 'externalink-img', iconUrl:'_static/external-link-12.png', startUrl:'../apidocs/'});
		
		// コンテンツ用
		$('div.wy-nav-content').externalLink({cssClass : 'externalink', iconUrl:'', startUrl:'../apidocs/'});
		
	});
</script>

<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-37313068-2', 'auto');
  ga('send', 'pageview');
  
</script>

 


</body>
</html>